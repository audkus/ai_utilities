[tox]
envlist = py311,py312,coverage,provider-check
skipsdist = True

[testenv]
deps = pytest
       pytest-cov
       pytest-mock
       pytest-json-report
       pytest-timeout
       pytest-randomly
       -e .[dev]
commands = pytest {posargs}

[testenv:coverage]
deps = pytest
       pytest-cov
       pytest-mock
       pytest-json-report
       pytest-timeout
       pytest-randomly
       -e .[dev]
commands = python -m coverage run -m pytest {posargs}
           python -m coverage report
           python -m coverage xml -o coverage_reports/coverage.xml
           python -m coverage html -d coverage_reports/html

[testenv:provider-check]
deps = pytest
       python-dotenv
       requests
       -e .[dev]
commands = python scripts/provider_change_detector.py
           python scripts/provider_change_detector.py --run-tests
           python scripts/provider_change_detector.py --generate-report
