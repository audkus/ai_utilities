<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="70" skipped="78" tests="2483" time="338.799" timestamp="2026-01-18T20:48:46.633865+01:00" hostname="MacBookPro"><testcase classname="tests.integration.test_real_apis.TestRealAPIIntegration" name="test_openai_real_api_call" time="0.000"><properties><property name="test_order" value="0" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_real_apis.py:37: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_real_apis.TestRealAPIIntegration" name="test_openai_json_mode_real" time="0.000"><properties><property name="test_order" value="1" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_real_apis.py:61: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_real_apis.TestRealAPIIntegration" name="test_openai_compatible_real_api" time="0.000"><properties><property name="test_order" value="2" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_real_apis.py:87: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_real_apis.TestRealAPIIntegration" name="test_provider_factory_real_openai" time="0.000"><properties><property name="test_order" value="3" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_real_apis.py:113: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_real_apis.TestRealAPIIntegration" name="test_provider_factory_real_compatible" time="0.000"><properties><property name="test_order" value="4" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_real_apis.py:136: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_real_apis.TestRealAPIIntegration" name="test_error_handling_without_api_key" time="0.000"><properties><property name="test_order" value="5" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_real_apis.py:160: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_real_apis.TestRealAPIIntegration" name="test_error_handling_without_base_url" time="0.000"><properties><property name="test_order" value="6" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_real_apis.py:174: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestThreadSafeUsageTracker" name="test_initialization" time="0.000"><properties><property name="test_order" value="7" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:49: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestThreadSafeUsageTracker" name="test_record_usage_single_thread" time="0.000"><properties><property name="test_order" value="8" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:79: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestThreadSafeUsageTracker" name="test_concurrent_usage_recording" time="0.000"><properties><property name="test_order" value="9" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:93: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestThreadSafeUsageTracker" name="test_concurrent_read_write" time="0.000"><properties><property name="test_order" value="10" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:124: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestThreadSafeUsageTracker" name="test_different_scopes_isolation" time="0.000"><properties><property name="test_order" value="11" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:169: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestThreadSafeUsageTracker" name="test_custom_client_id_sharing" time="0.000"><properties><property name="test_order" value="12" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:207: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestThreadSafeUsageTracker" name="test_reset_stats" time="0.000"><properties><property name="test_order" value="13" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:237: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestThreadSafeUsageTracker" name="test_aggregated_stats" time="0.000"><properties><property name="test_order" value="14" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:258: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestThreadSafeUsageTracker" name="test_file_corruption_handling" time="0.000"><properties><property name="test_order" value="15" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:283: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestThreadSafeUsageTracker" name="test_memory_caching" time="0.000"><properties><property name="test_order" value="16" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:295: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestCreateUsageTracker" name="test_create_tracker_with_string_scope" time="0.000"><properties><property name="test_order" value="17" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:321: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestCreateUsageTracker" name="test_create_tracker_with_enum_scope" time="0.000"><properties><property name="test_order" value="18" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:333: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestCreateUsageTracker" name="test_create_tracker_defaults" time="0.000"><properties><property name="test_order" value="19" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:343: need --run-integration option to run</skipped></testcase><testcase classname="tests.integration.test_usage_tracking.TestConcurrentStressTest" name="test_high_concurrency_stress" time="0.000"><properties><property name="test_order" value="20" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/integration/test_usage_tracking.py:369: need --run-integration option to run</skipped></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_backend_initialization" time="0.021"><properties><property name="test_order" value="21" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_extension_not_available" time="0.011"><properties><property name="test_order" value="22" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_required_extension_fails" time="0.009"><properties><property name="test_order" value="23" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_upsert_and_get_chunk" time="0.012"><properties><property name="test_order" value="24" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_get_nonexistent_chunk" time="0.009"><properties><property name="test_order" value="25" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_update_chunk" time="0.009"><properties><property name="test_order" value="26" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_source_operations" time="0.009"><properties><property name="test_order" value="27" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_delete_source" time="0.008"><properties><property name="test_order" value="28" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_similarity_search" time="0.008"><properties><property name="test_order" value="29" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_similarity_search_with_threshold" time="0.006"><properties><property name="test_order" value="30" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_search_empty_database" time="0.008"><properties><property name="test_order" value="31" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_stats" time="0.007"><properties><property name="test_order" value="32" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_existing_sources" time="0.007"><properties><property name="test_order" value="33" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_source_hash_tracking" time="0.006"><properties><property name="test_order" value="34" /></properties></testcase><testcase classname="tests.knowledge.test_backend.TestSqliteVectorBackend" name="test_close_connection" time="0.013"><properties><property name="test_order" value="35" /></properties></testcase><testcase classname="tests.knowledge.test_chunking.TestTextChunker" name="test_chunker_initialization" time="0.003"><properties><property name="test_order" value="36" /></properties></testcase><testcase classname="tests.knowledge.test_chunking.TestTextChunker" name="test_chunker_validation_errors" time="0.003"><properties><property name="test_order" value="37" /></properties></testcase><testcase classname="tests.knowledge.test_chunking.TestTextChunker" name="test_basic_chunking" time="0.003"><properties><property name="test_order" value="38" /></properties></testcase><testcase classname="tests.knowledge.test_chunking.TestTextChunker" name="test_empty_text" time="0.003"><properties><property name="test_order" value="39" /></properties></testcase><testcase classname="tests.knowledge.test_chunking.TestTextChunker" name="test_short_text" time="0.003"><properties><property name="test_order" value="40" /></properties></testcase><testcase classname="tests.knowledge.test_chunking.TestTextChunker" name="test_text_too_small" time="0.003"><properties><property name="test_order" value="41" /></properties></testcase><testcase classname="tests.knowledge.test_chunking.TestTextChunker" name="test_paragraph_chunking" time="0.003"><properties><property name="test_order" value="42" /></properties></testcase><testcase classname="tests.knowledge.test_chunking.TestTextChunker" name="test_sentence_chunking" time="0.003"><properties><property name="test_order" value="43" /></properties></testcase><testcase classname="tests.knowledge.test_chunking.TestTextChunker" name="test_overlap_chunking" time="0.003"><properties><property name="test_order" value="44" /></properties></testcase><testcase classname="tests.knowledge.test_chunking.TestTextChunker" name="test_chunk_positions" time="0.003"><properties><property name="test_order" value="45" /></properties></testcase><testcase classname="tests.knowledge.test_chunking.TestTextChunker" name="test_chunk_metadata" time="0.003"><properties><property name="test_order" value="46" /></properties></testcase><testcase classname="tests.knowledge.test_chunking.TestTextChunker" name="test_unicode_text" time="0.003"><properties><property name="test_order" value="47" /></properties></testcase><testcase classname="tests.knowledge.test_chunking.TestTextChunker" name="test_start_chunk_index" time="0.003"><properties><property name="test_order" value="48" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_indexer_initialization" time="0.009"><properties><property name="test_order" value="49" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_index_single_file" time="0.032"><properties><property name="test_order" value="50" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_index_multiple_files" time="0.090"><properties><property name="test_order" value="51" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_index_directory" time="0.051"><properties><property name="test_order" value="52" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_index_empty_directory" time="0.014"><properties><property name="test_order" value="53" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_index_nonexistent_directory" time="0.010"><properties><property name="test_order" value="54" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_index_not_a_directory" time="0.007"><properties><property name="test_order" value="55" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_index_unsupported_file" time="0.008"><properties><property name="test_order" value="56" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_index_empty_file" time="0.021"><properties><property name="test_order" value="57" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_index_too_small_file" time="0.025"><properties><property name="test_order" value="58" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_force_reindex" time="0.055"><properties><property name="test_order" value="59" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_reindex_changed_files" time="0.087"><properties><property name="test_order" value="60" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_remove_source" time="0.045"><properties><property name="test_order" value="61" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_get_index_stats" time="0.063"><properties><property name="test_order" value="62" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_embedding_generation_error" time="0.034"><properties><property name="test_order" value="63" /></properties></testcase><testcase classname="tests.knowledge.test_indexer.TestKnowledgeIndexer" name="test_chunking_error_handling" time="0.034"><properties><property name="test_order" value="64" /></properties></testcase><testcase classname="tests.knowledge.test_models.TestSource" name="test_source_creation" time="0.003"><properties><property name="test_order" value="65" /></properties></testcase><testcase classname="tests.knowledge.test_models.TestSource" name="test_source_from_path" time="0.023"><properties><property name="test_order" value="66" /></properties></testcase><testcase classname="tests.knowledge.test_models.TestSource" name="test_source_nonexistent_file" time="0.004"><properties><property name="test_order" value="67" /></properties></testcase><testcase classname="tests.knowledge.test_models.TestSource" name="test_file_extensions" time="0.003"><properties><property name="test_order" value="68" /></properties></testcase><testcase classname="tests.knowledge.test_models.TestChunk" name="test_chunk_creation" time="0.003"><properties><property name="test_order" value="69" /></properties></testcase><testcase classname="tests.knowledge.test_models.TestChunk" name="test_chunk_with_embedding" time="0.003"><properties><property name="test_order" value="70" /></properties></testcase><testcase classname="tests.knowledge.test_models.TestChunk" name="test_chunk_metadata" time="0.003"><properties><property name="test_order" value="71" /></properties></testcase><testcase classname="tests.knowledge.test_models.TestSearchHit" name="test_search_hit_creation" time="0.004"><properties><property name="test_order" value="72" /></properties></testcase><testcase classname="tests.knowledge.test_models.TestSearchHit" name="test_similarity_classification" time="0.003"><properties><property name="test_order" value="73" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_search_initialization" time="0.010"><properties><property name="test_order" value="74" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_basic_search" time="0.020"><properties><property name="test_order" value="75" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_search_with_threshold" time="0.010"><properties><property name="test_order" value="76" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_search_empty_query" time="0.013"><properties><property name="test_order" value="77" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_search_top_k_limiting" time="0.008"><properties><property name="test_order" value="78" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_search_metadata_inclusion" time="0.007"><properties><property name="test_order" value="79" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_search_with_context" time="0.007"><properties><property name="test_order" value="80" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_find_similar_chunks" time="0.008"><properties><property name="test_order" value="81" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_find_similar_nonexistent_chunk" time="0.006"><properties><property name="test_order" value="82" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_find_similar_chunk_no_embedding" time="0.007"><properties><property name="test_order" value="83" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_get_search_stats" time="0.007"><properties><property name="test_order" value="84" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_embedding_generation_error" time="0.006"><properties><property name="test_order" value="85" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_search_result_properties" time="0.007"><properties><property name="test_order" value="86" /></properties></testcase><testcase classname="tests.knowledge.test_search.TestKnowledgeSearch" name="test_search_source_path" time="0.008"><properties><property name="test_order" value="87" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_supported_extensions" time="0.003"><properties><property name="test_order" value="88" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_load_source_valid_file" time="0.020"><properties><property name="test_order" value="89" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_load_source_nonexistent_file" time="0.003"><properties><property name="test_order" value="90" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_load_source_directory" time="0.004"><properties><property name="test_order" value="91" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_load_source_unsupported_type" time="0.003"><properties><property name="test_order" value="92" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_load_source_too_large" time="0.003"><properties><property name="test_order" value="93" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_extract_text_plain" time="0.020"><properties><property name="test_order" value="94" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_extract_text_markdown" time="0.021"><properties><property name="test_order" value="95" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_extract_text_python" time="0.023"><properties><property name="test_order" value="96" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_extract_text_log" time="0.023"><properties><property name="test_order" value="97" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_extract_text_yaml" time="0.020"><properties><property name="test_order" value="98" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_extract_text_json" time="0.026"><properties><property name="test_order" value="99" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_extract_text_encoding_fallback" time="0.022"><properties><property name="test_order" value="100" /></properties></testcase><testcase classname="tests.knowledge.test_sources.TestFileSourceLoader" name="test_extract_empty_file" time="0.019"><properties><property name="test_order" value="101" /></properties></testcase><testcase classname="tests.test___main__.TestMainModule" name="test_main_execution" time="0.003"><properties><property name="test_order" value="102" /></properties></testcase><testcase classname="tests.test___main__.TestMainModule" name="test_main_imports" time="0.003"><properties><property name="test_order" value="103" /></properties></testcase><testcase classname="tests.test___main__.TestMainModule" name="test_main_function_call" time="0.002"><properties><property name="test_order" value="104" /></properties></testcase><testcase classname="tests.test___main__.TestMainModule" name="test_module_structure" time="0.003"><properties><property name="test_order" value="105" /></properties></testcase><testcase classname="tests.test___main__.TestMainModule" name="test_main_function_import" time="0.003"><properties><property name="test_order" value="106" /></properties></testcase><testcase classname="tests.test_advanced_caching.TestAdvancedCaching" name="test_cache_with_different_temperature_settings" time="4.028"><properties><property name="test_order" value="107" /></properties></testcase><testcase classname="tests.test_advanced_caching.TestAdvancedCaching" name="test_cache_namespace_isolation" time="4.031"><properties><property name="test_order" value="108" /></properties></testcase><testcase classname="tests.test_advanced_caching.TestAdvancedCaching" name="test_cache_basic_functionality_with_ttl" time="2.022"><properties><property name="test_order" value="109" /></properties></testcase><testcase classname="tests.test_advanced_caching.TestAdvancedCaching" name="test_cache_with_parameter_variations" time="3.027"><properties><property name="test_order" value="110" /></properties></testcase><testcase classname="tests.test_advanced_caching.TestAdvancedCaching" name="test_cache_basic_functionality" time="2.023"><properties><property name="test_order" value="111" /></properties></testcase><testcase classname="tests.test_advanced_caching.TestAdvancedCaching" name="test_cache_disabled_fallback" time="3.026"><properties><property name="test_order" value="112" /></properties></testcase><testcase classname="tests.test_advanced_caching.TestAdvancedCaching" name="test_sqlite_cache_persistence" time="2.046"><properties><property name="test_order" value="113" /></properties></testcase><testcase classname="tests.test_advanced_caching.TestAdvancedCaching" name="test_cache_key_generation_stability" time="5.027"><properties><property name="test_order" value="114" /></properties></testcase><testcase classname="tests.test_advanced_caching.TestAdvancedCaching" name="test_cache_with_null_backend" time="3.022"><properties><property name="test_order" value="115" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_initialization_without_api_key" time="0.004"><properties><property name="test_order" value="116" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_initialization_with_api_key" time="0.005"><properties><property name="test_order" value="117" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_load_config_basic" time="0.003"><properties><property name="test_order" value="118" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_load_config_with_data" time="0.005"><properties><property name="test_order" value="119" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_load_config_invalid_data" time="0.006"><properties><property name="test_order" value="120" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_load_from_file_nonexistent" time="0.004"><properties><property name="test_order" value="121" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_load_from_file_valid" time="0.005"><properties><property name="test_order" value="122" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_save_config" time="0.040"><properties><property name="test_order" value="123" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_get_model_config" time="0.004"><properties><property name="test_order" value="124" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_load_config_with_dynamic_limits" time="0.004"><properties><property name="test_order" value="125" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_load_config_with_dynamic_limits_failure" time="0.004"><properties><property name="test_order" value="126" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_update_rate_limits" time="0.006"><properties><property name="test_order" value="127" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_update_rate_limits_no_fetcher" time="0.004"><properties><property name="test_order" value="128" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_should_update_rate_limits" time="0.004"><properties><property name="test_order" value="129" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_should_update_rate_limits_no_fetcher" time="0.004"><properties><property name="test_order" value="130" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_update_rate_limits_if_needed" time="0.005"><properties><property name="test_order" value="131" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_get_rate_limit_status" time="0.004"><properties><property name="test_order" value="132" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_get_rate_limit_status_with_fetcher" time="0.004"><properties><property name="test_order" value="133" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_clear_rate_limit_cache" time="0.003"><properties><property name="test_order" value="134" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManager" name="test_clear_rate_limit_cache_with_fetcher" time="0.005"><properties><property name="test_order" value="135" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManagerIntegration" name="test_end_to_end_configuration_workflow" time="0.008"><properties><property name="test_order" value="136" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManagerIntegration" name="test_config_file_roundtrip" time="0.007"><properties><property name="test_order" value="137" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManagerIntegration" name="test_environment_variable_integration" time="0.004"><properties><property name="test_order" value="138" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManagerIntegration" name="test_dynamic_limits_integration" time="0.005"><properties><property name="test_order" value="139" /></properties></testcase><testcase classname="tests.test_ai_config_manager.TestAIConfigManagerIntegration" name="test_error_handling_workflow" time="0.006"><properties><property name="test_order" value="140" /></properties></testcase><testcase classname="tests.test_ask_typed.TestAskJson" name="test_ask_json_with_valid_json" time="1.052"><properties><property name="test_order" value="141" /></properties></testcase><testcase classname="tests.test_ask_typed.TestAskJson" name="test_ask_json_with_json_in_code_fences" time="1.051"><properties><property name="test_order" value="142" /></properties></testcase><testcase classname="tests.test_ask_typed.TestAskJson" name="test_ask_json_with_surrounding_text" time="1.049"><properties><property name="test_order" value="143" /></properties></testcase><testcase classname="tests.test_ask_typed.TestAskJson" name="test_ask_json_with_array_response" time="1.052"><properties><property name="test_order" value="144" /></properties></testcase><testcase classname="tests.test_ask_typed.TestAskJson" name="test_ask_json_repair_success" time="1.049"><properties><property name="test_order" value="145" /></properties></testcase><testcase classname="tests.test_ask_typed.TestAskJson" name="test_ask_json_repair_failure" time="1.052"><properties><property name="test_order" value="146" /></properties></testcase><testcase classname="tests.test_ask_typed.TestAskJson" name="test_ask_json_no_repairs" time="1.049"><properties><property name="test_order" value="147" /></properties></testcase><testcase classname="tests.test_ask_typed.TestAskTyped" name="test_ask_typed_success" time="1.051"><properties><property name="test_order" value="148" /></properties></testcase><testcase classname="tests.test_ask_typed.TestAskTyped" name="test_ask_typed_with_optional_field_missing" time="1.044"><properties><property name="test_order" value="149" /></properties></testcase><testcase classname="tests.test_ask_typed.TestAskTyped" name="test_ask_typed_validation_error" time="1.053"><properties><property name="test_order" value="150" /></properties></testcase><testcase classname="tests.test_ask_typed.TestAskTyped" name="test_ask_typed_missing_required_field" time="1.051"><properties><property name="test_order" value="151" /></properties></testcase><testcase classname="tests.test_ask_typed.TestAskTyped" name="test_ask_typed_with_repair_success" time="1.050"><properties><property name="test_order" value="152" /></properties></testcase><testcase classname="tests.test_ask_typed.TestAskTyped" name="test_ask_typed_with_kwargs" time="1.050"><properties><property name="test_order" value="153" /></properties></testcase><testcase classname="tests.test_ask_typed.TestComplexModels" name="test_nested_model_validation" time="1.052"><properties><property name="test_order" value="154" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncOpenAIProvider" name="test_async_provider_ask" time="0.009"><properties><property name="test_order" value="155" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncOpenAIProvider" name="test_async_provider_ask_json" time="0.007"><properties><property name="test_order" value="156" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncOpenAIProvider" name="test_async_provider_ask_many" time="0.007"><properties><property name="test_order" value="157" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncOpenAIProvider" name="test_async_provider_upload_file" time="0.007"><properties><property name="test_order" value="158" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncOpenAIProvider" name="test_async_provider_download_file" time="0.007"><properties><property name="test_order" value="159" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncOpenAIProvider" name="test_async_provider_generate_image" time="0.007"><properties><property name="test_order" value="160" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_client_initialization" time="0.008"><properties><property name="test_order" value="161" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_client_initialization_defaults" time="0.006"><properties><property name="test_order" value="162" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_success" time="0.009"><properties><property name="test_order" value="163" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_json_format" time="0.008"><properties><property name="test_order" value="164" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_with_exception" time="0.008"><properties><property name="test_order" value="165" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_many_empty_list" time="0.008"><properties><property name="test_order" value="166" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_many_success" time="0.008"><properties><property name="test_order" value="167" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_many_with_errors" time="0.009"><properties><property name="test_order" value="168" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_many_fail_fast" time="0.008"><properties><property name="test_order" value="169" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_many_with_progress_callback" time="0.008"><properties><property name="test_order" value="170" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_many_progress_callback_error" time="0.009"><properties><property name="test_order" value="171" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_many_concurrency_control" time="0.041"><properties><property name="test_order" value="172" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_many_with_retry_empty" time="0.008"><properties><property name="test_order" value="173" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_many_with_retry_success" time="0.009"><properties><property name="test_order" value="174" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_many_with_retry_retryable_errors" time="0.009"><properties><property name="test_order" value="175" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_many_with_retry_non_retryable_errors" time="0.009"><properties><property name="test_order" value="176" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_ask_many_with_retry_max_retries_exceeded" time="0.009"><properties><property name="test_order" value="177" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_upload_file_success" time="0.009"><properties><property name="test_order" value="178" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_upload_file_nonexistent_path" time="0.039"><properties><property name="test_order" value="179" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_upload_file_directory_path" time="0.009"><properties><property name="test_order" value="180" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_upload_file_provider_capability_error" time="0.009"><properties><property name="test_order" value="181" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_upload_file_file_transfer_error" time="0.008"><properties><property name="test_order" value="182" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_upload_file_wrapped_exception" time="0.009"><properties><property name="test_order" value="183" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_download_file_success_bytes" time="0.008"><properties><property name="test_order" value="184" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_download_file_success_to_path" time="0.012"><properties><property name="test_order" value="185" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_download_file_empty_id" time="0.008"><properties><property name="test_order" value="186" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_download_file_provider_capability_error" time="0.008"><properties><property name="test_order" value="187" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_download_file_wrapped_exception" time="0.008"><properties><property name="test_order" value="188" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_generate_image_success" time="0.008"><properties><property name="test_order" value="189" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_generate_image_with_options" time="0.008"><properties><property name="test_order" value="190" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_generate_image_empty_prompt" time="0.008"><properties><property name="test_order" value="191" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_generate_image_invalid_n" time="0.008"><properties><property name="test_order" value="192" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_generate_image_provider_capability_error" time="0.008"><properties><property name="test_order" value="193" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_generate_image_wrapped_exception" time="0.008"><properties><property name="test_order" value="194" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_path_conversion_in_upload_file" time="0.009"><properties><property name="test_order" value="195" /></properties></testcase><testcase classname="tests.test_async_client.TestAsyncAiClient" name="test_path_conversion_in_download_file" time="0.009"><properties><property name="test_order" value="196" /></properties></testcase><testcase classname="tests.test_async_client.TestEdgeCases" name="test_concurrent_requests_isolation" time="0.030"><properties><property name="test_order" value="197" /></properties></testcase><testcase classname="tests.test_async_client.TestEdgeCases" name="test_large_number_of_prompts" time="0.010"><properties><property name="test_order" value="198" /></properties></testcase><testcase classname="tests.test_async_client.TestEdgeCases" name="test_exception_during_task_creation" time="0.007"><properties><property name="test_order" value="199" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientBasics" name="test_async_client_creation_default" time="0.006"><properties><property name="test_order" value="200" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientBasics" name="test_async_client_creation_with_settings" time="0.006"><properties><property name="test_order" value="201" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientBasics" name="test_async_client_with_custom_provider" time="0.005"><properties><property name="test_order" value="202" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientBasics" name="test_async_client_show_progress_option" time="0.006"><properties><property name="test_order" value="203" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAsk" name="test_async_ask_single_prompt" time="0.007"><properties><property name="test_order" value="204" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAsk" name="test_async_ask_with_parameters" time="0.007"><properties><property name="test_order" value="205" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAsk" name="test_async_ask_json_format" time="0.007"><properties><property name="test_order" value="206" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAsk" name="test_async_ask_error_handling" time="0.008"><properties><property name="test_order" value="207" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAsk" name="test_async_ask_deterministic_responses" time="0.008"><properties><property name="test_order" value="208" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAsk" name="test_async_ask_concurrent_calls" time="0.007"><properties><property name="test_order" value="209" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAsk" name="test_async_ask_with_delay" time="0.019"><properties><property name="test_order" value="210" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAskMany" name="test_async_ask_many_basic" time="0.008"><properties><property name="test_order" value="211" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAskMany" name="test_async_ask_many_with_parameters" time="0.007"><properties><property name="test_order" value="212" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAskMany" name="test_async_ask_many_json_format" time="0.007"><properties><property name="test_order" value="213" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAskMany" name="test_async_ask_many_concurrency_control" time="0.260"><properties><property name="test_order" value="214" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAskMany" name="test_async_ask_many_fail_fast" time="0.011"><properties><property name="test_order" value="215" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAskMany" name="test_async_ask_many_progress_callback" time="0.007"><properties><property name="test_order" value="216" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAskMany" name="test_async_ask_many_progress_callback_error" time="0.008"><properties><property name="test_order" value="217" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAskMany" name="test_async_ask_many_empty_prompts" time="0.006"><properties><property name="test_order" value="218" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientAskMany" name="test_async_ask_many_error_handling" time="0.008"><properties><property name="test_order" value="219" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientIntegration" name="test_async_client_with_sync_provider_pattern" time="0.007"><properties><property name="test_order" value="220" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientIntegration" name="test_async_client_mixed_operations" time="0.008"><properties><property name="test_order" value="221" /></properties></testcase><testcase classname="tests.test_async_client_comprehensive.TestAsyncAiClientIntegration" name="test_async_client_reuse" time="0.012"><properties><property name="test_order" value="222" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncPerformance" name="test_async_vs_sync_performance" time="5.108"><properties><property name="test_order" value="223" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncPerformance" name="test_concurrent_request_scaling" time="0.515"><properties><property name="test_order" value="224" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncPerformance" name="test_async_memory_efficiency" time="0.032"><properties><property name="test_order" value="225" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncPerformance" name="test_async_under_load" time="0.142"><properties><property name="test_order" value="226" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncConcurrency" name="test_semaphore_concurrency_limiting" time="0.130"><properties><property name="test_order" value="227" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncConcurrency" name="test_ask_many_concurrency_isolation" time="0.191"><properties><property name="test_order" value="228" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncConcurrency" name="test_mixed_concurrent_operations" time="0.136"><properties><property name="test_order" value="229" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncConcurrency" name="test_concurrent_error_isolation" time="0.009"><properties><property name="test_order" value="230" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncErrorHandling" name="test_async_provider_error_propagation" time="0.040"><properties><property name="test_order" value="231" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncErrorHandling" name="test_async_ask_many_partial_failures" time="0.007"><properties><property name="test_order" value="232" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncErrorHandling" name="test_async_cancellation_handling" time="0.108"><properties><property name="test_order" value="233" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncErrorHandling" name="test_async_timeout_behavior" time="0.113"><properties><property name="test_order" value="234" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncErrorHandling" name="test_async_retry_with_failures" time="0.008"><properties><property name="test_order" value="235" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncAdvancedPatterns" name="test_async_streaming_simulation" time="0.012"><properties><property name="test_order" value="236" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncAdvancedPatterns" name="test_async_batch_processing_with_callback" time="0.007"><properties><property name="test_order" value="237" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncAdvancedPatterns" name="test_async_dynamic_concurrency" time="0.257"><properties><property name="test_order" value="238" /></properties></testcase><testcase classname="tests.test_async_performance.TestAsyncAdvancedPatterns" name="test_async_resource_cleanup" time="0.009"><properties><property name="test_order" value="239" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioClientIntegration" name="test_audio_processor_initialization" time="0.005"><properties><property name="test_order" value="240" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioClientIntegration" name="test_audio_processor_default_initialization" time="0.003"><properties><property name="test_order" value="241" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioClientIntegration" name="test_client_transcribe_audio_integration" time="0.007"><properties><property name="test_order" value="242" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioClientIntegration" name="test_client_generate_audio_integration" time="0.007"><properties><property name="test_order" value="243" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioClientIntegration" name="test_client_get_audio_voices_integration" time="0.007"><properties><property name="test_order" value="244" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioClientIntegration" name="test_client_validate_audio_file_integration" time="0.005"><properties><property name="test_order" value="245" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioProcessorFunctionality" name="test_get_supported_models" time="0.004"><properties><property name="test_order" value="246" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioProcessorFunctionality" name="test_get_supported_models_by_operation" time="0.003"><properties><property name="test_order" value="247" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioProcessorFunctionality" name="test_get_supported_models_invalid_operation" time="0.003"><properties><property name="test_order" value="248" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioProcessingImports" name="test_main_package_imports" time="0.003"><properties><property name="test_order" value="249" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioProcessingImports" name="test_audio_format_enum" time="0.003"><properties><property name="test_order" value="250" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioErrorHandling" name="test_audio_processing_error" time="0.003"><properties><property name="test_order" value="251" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioErrorHandling" name="test_client_audio_error_handling" time="0.006"><properties><property name="test_order" value="252" /></properties></testcase><testcase classname="tests.test_audio_integration.TestAudioProcessingRealAPI" name="test_real_transcription" time="0.000"><properties><property name="test_order" value="253" /></properties><skipped type="pytest.skip" message="Requires real API key and audio file">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_audio_integration.py:274: Requires real API key and audio file</skipped></testcase><testcase classname="tests.test_audio_integration.TestAudioProcessingRealAPI" name="test_real_audio_generation" time="0.000"><properties><property name="test_order" value="254" /></properties><skipped type="pytest.skip" message="Requires real API key">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_audio_integration.py:302: Requires real API key</skipped></testcase><testcase classname="tests.test_audio_integration.TestAudioProcessingRealAPI" name="test_real_transcribe_and_generate" time="0.000"><properties><property name="test_order" value="255" /></properties><skipped type="pytest.skip" message="Requires real API key and audio file">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_audio_integration.py:323: Requires real API key and audio file</skipped></testcase><testcase classname="tests.test_audio_models.TestAudioFormat" name="test_audio_format_values" time="0.003"><properties><property name="test_order" value="256" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioFormat" name="test_audio_format_creation" time="0.003"><properties><property name="test_order" value="257" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioFormat" name="test_audio_format_invalid" time="0.003"><properties><property name="test_order" value="258" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioFile" name="test_audio_file_creation" time="0.004"><properties><property name="test_order" value="259" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioFile" name="test_audio_file_invalid_path" time="0.004"><properties><property name="test_order" value="260" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioFile" name="test_audio_file_invalid_size" time="0.004"><properties><property name="test_order" value="261" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioFile" name="test_audio_file_properties" time="0.003"><properties><property name="test_order" value="262" /></properties></testcase><testcase classname="tests.test_audio_models.TestTranscriptionRequest" name="test_transcription_request_creation" time="0.004"><properties><property name="test_order" value="263" /></properties></testcase><testcase classname="tests.test_audio_models.TestTranscriptionRequest" name="test_transcription_request_temperature_validation" time="0.005"><properties><property name="test_order" value="264" /></properties></testcase><testcase classname="tests.test_audio_models.TestTranscriptionRequest" name="test_transcription_request_response_format_validation" time="0.004"><properties><property name="test_order" value="265" /></properties></testcase><testcase classname="tests.test_audio_models.TestTranscriptionSegment" name="test_transcription_segment_creation" time="0.003"><properties><property name="test_order" value="266" /></properties></testcase><testcase classname="tests.test_audio_models.TestTranscriptionSegment" name="test_transcription_segment_end_time_validation" time="0.003"><properties><property name="test_order" value="267" /></properties></testcase><testcase classname="tests.test_audio_models.TestTranscriptionResult" name="test_transcription_result_creation" time="0.003"><properties><property name="test_order" value="268" /></properties></testcase><testcase classname="tests.test_audio_models.TestTranscriptionResult" name="test_transcription_result_properties" time="0.003"><properties><property name="test_order" value="269" /></properties></testcase><testcase classname="tests.test_audio_models.TestTranscriptionResult" name="test_transcription_result_with_segments" time="0.003"><properties><property name="test_order" value="270" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioGenerationRequest" name="test_audio_generation_request_creation" time="0.003"><properties><property name="test_order" value="271" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioGenerationRequest" name="test_audio_generation_request_speed_validation" time="0.003"><properties><property name="test_order" value="272" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioGenerationRequest" name="test_audio_generation_request_text_validation" time="0.003"><properties><property name="test_order" value="273" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioGenerationResult" name="test_audio_generation_result_creation" time="0.002"><properties><property name="test_order" value="274" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioGenerationResult" name="test_audio_generation_result_properties" time="0.003"><properties><property name="test_order" value="275" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioGenerationResult" name="test_audio_generation_result_save_to_file" time="0.005"><properties><property name="test_order" value="276" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioAnalysisResult" name="test_audio_analysis_result_creation" time="0.003"><properties><property name="test_order" value="277" /></properties></testcase><testcase classname="tests.test_audio_models.TestAudioAnalysisResult" name="test_audio_analysis_result_properties" time="0.003"><properties><property name="test_order" value="278" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_init_with_client" time="0.003"><properties><property name="test_order" value="279" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_init_without_client" time="0.003"><properties><property name="test_order" value="280" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_transcribe_audio_with_path" time="0.004"><properties><property name="test_order" value="281" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_transcribe_audio_with_audiofile_object" time="0.004"><properties><property name="test_order" value="282" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_transcribe_audio_large_file_error" time="0.028"><properties><property name="test_order" value="283" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_transcribe_audio_provider_error" time="0.006"><properties><property name="test_order" value="284" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_transcribe_with_provider_success" time="0.006"><properties><property name="test_order" value="285" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_transcribe_with_provider_verbose_response" time="0.007"><properties><property name="test_order" value="286" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_transcribe_with_provider_no_client_support" time="0.006"><properties><property name="test_order" value="287" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_transcribe_with_provider_exception" time="0.006"><properties><property name="test_order" value="288" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_parse_transcription_response_simple" time="0.004"><properties><property name="test_order" value="289" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_parse_transcription_response_verbose" time="0.005"><properties><property name="test_order" value="290" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_generate_audio_success" time="0.003"><properties><property name="test_order" value="291" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_generate_audio_provider_error" time="0.003"><properties><property name="test_order" value="292" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_generate_with_provider_success" time="0.004"><properties><property name="test_order" value="293" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_generate_with_provider_no_client_support" time="0.004"><properties><property name="test_order" value="294" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_generate_with_provider_exception" time="0.003"><properties><property name="test_order" value="295" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_transcribe_and_generate_success" time="0.004"><properties><property name="test_order" value="296" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_transcribe_and_generate_with_translation_prompt" time="0.005"><properties><property name="test_order" value="297" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_get_supported_voices_success" time="0.003"><properties><property name="test_order" value="298" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_get_supported_voices_fallback" time="0.003"><properties><property name="test_order" value="299" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_get_supported_models_all" time="0.003"><properties><property name="test_order" value="300" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_get_supported_models_transcription" time="0.038"><properties><property name="test_order" value="301" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_get_supported_models_generation" time="0.003"><properties><property name="test_order" value="302" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_get_supported_models_invalid_operation" time="0.003"><properties><property name="test_order" value="303" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_validate_audio_for_transcription_success" time="0.004"><properties><property name="test_order" value="304" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_validate_audio_for_transcription_with_path" time="0.005"><properties><property name="test_order" value="305" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_validate_audio_large_file_warning" time="0.025"><properties><property name="test_order" value="306" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_validate_audio_long_duration_warning" time="0.010"><properties><property name="test_order" value="307" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_validate_audio_high_sample_rate_warning" time="0.013"><properties><property name="test_order" value="308" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_validate_audio_exception_handling" time="0.004"><properties><property name="test_order" value="309" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_transcribe_audio_all_parameters" time="0.004"><properties><property name="test_order" value="310" /></properties></testcase><testcase classname="tests.test_audio_processor.TestAudioProcessor" name="test_generate_audio_all_parameters" time="0.003"><properties><property name="test_order" value="311" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioValidation" name="test_validate_audio_file_valid" time="0.005"><properties><property name="test_order" value="312" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioValidation" name="test_validate_audio_file_nonexistent" time="0.003"><properties><property name="test_order" value="313" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioValidation" name="test_validate_audio_file_invalid_extension" time="0.004"><properties><property name="test_order" value="314" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioValidation" name="test_get_audio_format_from_extension" time="0.004"><properties><property name="test_order" value="315" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioValidation" name="test_get_audio_format_invalid_extension" time="0.008"><properties><property name="test_order" value="316" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioValidation" name="test_get_audio_format_from_mime_type" time="0.004"><properties><property name="test_order" value="317" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioFileLoading" name="test_load_audio_file_basic" time="0.004"><properties><property name="test_order" value="318" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioFileLoading" name="test_load_audio_file_with_mutagen" time="0.004"><properties><property name="test_order" value="319" /></properties><skipped type="pytest.skip" message="mutagen package not available">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_audio_utils.py:116: mutagen package not available</skipped></testcase><testcase classname="tests.test_audio_utils.TestAudioFileLoading" name="test_load_wav_file_with_wave_module" time="0.006"><properties><property name="test_order" value="320" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioInfo" name="test_get_audio_info_valid_file" time="0.005"><properties><property name="test_order" value="321" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioInfo" name="test_get_audio_info_invalid_file" time="0.004"><properties><property name="test_order" value="322" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioFileOperations" name="test_save_audio_file" time="0.005"><properties><property name="test_order" value="323" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioFileOperations" name="test_save_audio_file_creates_directories" time="0.006"><properties><property name="test_order" value="324" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioFileOperations" name="test_save_audio_file_error" time="0.004"><properties><property name="test_order" value="325" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioConversion" name="test_convert_audio_format_no_pydub" time="0.004"><properties><property name="test_order" value="326" /></properties></testcase><testcase classname="tests.test_audio_utils.TestAudioConversion" name="test_convert_audio_format_with_pydub" time="0.004"><properties><property name="test_order" value="327" /></properties><skipped type="pytest.skip" message="pydub package not available">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_audio_utils.py:234: pydub package not available</skipped></testcase><testcase classname="tests.test_audio_utils.TestAudioAnalysis" name="test_analyze_wav_file" time="0.006"><properties><property name="test_order" value="328" /></properties></testcase><testcase classname="tests.test_audio_utils.TestErrorHandling" name="test_audio_processing_error" time="0.003"><properties><property name="test_order" value="329" /></properties></testcase><testcase classname="tests.test_audio_utils.TestErrorHandling" name="test_load_invalid_file" time="0.005"><properties><property name="test_order" value="330" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheBehavior" name="test_cache_key_generation" time="0.005"><properties><property name="test_order" value="331" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheBehavior" name="test_cache_key_different_inputs" time="0.005"><properties><property name="test_order" value="332" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheBehavior" name="test_should_use_cache_logic" time="0.005"><properties><property name="test_order" value="333" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheBehavior" name="test_caching_with_ask_single_prompt" time="3.022"><properties><property name="test_order" value="334" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheBehavior" name="test_caching_with_ask_many_prompts" time="2.018"><properties><property name="test_order" value="335" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheBehavior" name="test_cache_ttl_expiration_in_client" time="4.130"><properties><property name="test_order" value="336" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheBehavior" name="test_cache_with_different_parameters" time="3.023"><properties><property name="test_order" value="337" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheBehavior" name="test_cache_with_json_format" time="3.023"><properties><property name="test_order" value="338" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheBehavior" name="test_cache_disabled_high_temperature" time="4.029"><properties><property name="test_order" value="339" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheBehavior" name="test_cache_invalidation_with_clear" time="6.036"><properties><property name="test_order" value="340" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestSqliteCacheBehavior" name="test_sqlite_cache_persistence_across_clients" time="2.036"><properties><property name="test_order" value="341" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestSqliteCacheBehavior" name="test_sqlite_cache_namespace_isolation" time="3.042"><properties><property name="test_order" value="342" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestSqliteCacheBehavior" name="test_sqlite_cache_max_entries_eviction" time="5.038"><properties><property name="test_order" value="343" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheErrorHandling" name="test_cache_with_non_serializable_data" time="0.012"><properties><property name="test_order" value="344" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheErrorHandling" name="test_cache_with_corrupted_database" time="0.008"><properties><property name="test_order" value="345" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheErrorHandling" name="test_memory_cache_with_large_data" time="0.006"><properties><property name="test_order" value="346" /></properties></testcase><testcase classname="tests.test_cache_behavior.TestCacheErrorHandling" name="test_cache_concurrent_access" time="1.017"><properties><property name="test_order" value="347" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheBackends" name="test_null_cache_behavior" time="0.003"><properties><property name="test_order" value="348" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheBackends" name="test_memory_cache_basic_operations" time="0.003"><properties><property name="test_order" value="349" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheBackends" name="test_memory_cache_ttl_expiration" time="2.216"><properties><property name="test_order" value="350" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheBackends" name="test_memory_cache_no_ttl" time="0.107"><properties><property name="test_order" value="351" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheBackends" name="test_memory_cache_size_and_clear" time="0.003"><properties><property name="test_order" value="352" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheBackends" name="test_memory_cache_thread_safety" time="0.003"><properties><property name="test_order" value="353" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheBackends" name="test_sqlite_cache_basic_operations" time="0.045"><properties><property name="test_order" value="354" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheBackends" name="test_sqlite_cache_ttl_expiration" time="1.139"><properties><property name="test_order" value="355" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheBackends" name="test_sqlite_cache_namespace_isolation" time="0.053"><properties><property name="test_order" value="356" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheBackends" name="test_sqlite_cache_persistence" time="0.018"><properties><property name="test_order" value="357" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheUtilities" name="test_stable_hash_consistency" time="0.004"><properties><property name="test_order" value="358" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheUtilities" name="test_stable_hash_order_independence" time="0.003"><properties><property name="test_order" value="359" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheUtilities" name="test_stable_hash_different_data" time="0.004"><properties><property name="test_order" value="360" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheUtilities" name="test_stable_hash_complex_types" time="0.003"><properties><property name="test_order" value="361" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheUtilities" name="test_normalize_prompt" time="0.003"><properties><property name="test_order" value="362" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheConfiguration" name="test_cache_configuration_defaults" time="0.005"><properties><property name="test_order" value="363" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheConfiguration" name="test_cache_configuration_override" time="0.005"><properties><property name="test_order" value="364" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheConfiguration" name="test_cache_configuration_sqlite" time="0.006"><properties><property name="test_order" value="365" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheIntegration" name="test_client_cache_disabled_by_default" time="0.006"><properties><property name="test_order" value="366" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheIntegration" name="test_client_memory_cache_enabled" time="0.006"><properties><property name="test_order" value="367" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheIntegration" name="test_client_sqlite_cache_isolated_in_pytest" time="0.005"><properties><property name="test_order" value="368" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheIntegration" name="test_client_sqlite_cache_with_explicit_path" time="0.013"><properties><property name="test_order" value="369" /></properties></testcase><testcase classname="tests.test_cache_comprehensive.TestCacheIntegration" name="test_explicit_cache_override" time="0.006"><properties><property name="test_order" value="370" /></properties></testcase><testcase classname="tests.test_cli.TestCreateParser" name="test_parser_creation" time="0.003"><properties><property name="test_order" value="371" /></properties></testcase><testcase classname="tests.test_cli.TestCreateParser" name="test_parser_has_setup_subcommand" time="0.003"><properties><property name="test_order" value="372" /></properties></testcase><testcase classname="tests.test_cli.TestCreateParser" name="test_setup_command_with_all_arguments" time="0.003"><properties><property name="test_order" value="373" /></properties></testcase><testcase classname="tests.test_cli.TestCreateParser" name="test_setup_mode_choices" time="0.004"><properties><property name="test_order" value="374" /></properties></testcase><testcase classname="tests.test_cli.TestCreateParser" name="test_setup_mode_invalid_choice" time="0.004"><properties><property name="test_order" value="375" /></properties></testcase><testcase classname="tests.test_cli.TestCreateParser" name="test_parser_help" time="0.004"><properties><property name="test_order" value="376" /></properties></testcase><testcase classname="tests.test_cli.TestMainFunction" name="test_main_default_to_setup" time="0.004"><properties><property name="test_order" value="377" /></properties></testcase><testcase classname="tests.test_cli.TestMainFunction" name="test_main_with_setup_command" time="0.004"><properties><property name="test_order" value="378" /></properties></testcase><testcase classname="tests.test_cli.TestMainFunction" name="test_main_with_enhanced_mode" time="0.003"><properties><property name="test_order" value="379" /></properties></testcase><testcase classname="tests.test_cli.TestMainFunction" name="test_main_with_all_options" time="0.003"><properties><property name="test_order" value="380" /></properties></testcase><testcase classname="tests.test_cli.TestMainFunction" name="test_main_dry_run_output" time="0.040"><properties><property name="test_order" value="381" /></properties></testcase><testcase classname="tests.test_cli.TestMainFunction" name="test_main_api_key_masking" time="0.004"><properties><property name="test_order" value="382" /></properties></testcase><testcase classname="tests.test_cli.TestMainFunction" name="test_main_short_api_key_masking" time="0.003"><properties><property name="test_order" value="383" /></properties></testcase><testcase classname="tests.test_cli.TestMainFunction" name="test_main_keyboard_interrupt" time="0.004"><properties><property name="test_order" value="384" /></properties></testcase><testcase classname="tests.test_cli.TestMainFunction" name="test_main_general_exception" time="0.003"><properties><property name="test_order" value="385" /></properties></testcase><testcase classname="tests.test_cli.TestMainFunction" name="test_main_unknown_command" time="0.003"><properties><property name="test_order" value="386" /></properties></testcase><testcase classname="tests.test_cli.TestMainFunction" name="test_main_none_command" time="0.004"><properties><property name="test_order" value="387" /></properties></testcase><testcase classname="tests.test_cli.TestIntegration" name="test_complete_setup_workflow" time="0.004"><properties><property name="test_order" value="388" /></properties></testcase><testcase classname="tests.test_cli.TestIntegration" name="test_argv_parameter_handling" time="0.004"><properties><property name="test_order" value="389" /></properties></testcase><testcase classname="tests.test_cli.TestIntegration" name="test_empty_argv_defaults_to_setup" time="0.004"><properties><property name="test_order" value="390" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIArgumentParsing" name="test_create_parser_basic" time="0.003"><properties><property name="test_order" value="391" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIArgumentParsing" name="test_parse_setup_command_default" time="0.003"><properties><property name="test_order" value="392" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIArgumentParsing" name="test_parse_setup_command_with_options" time="0.003"><properties><property name="test_order" value="393" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIArgumentParsing" name="test_parse_invalid_mode" time="0.004"><properties><property name="test_order" value="394" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIArgumentParsing" name="test_parse_no_command_defaults_to_setup" time="0.003"><properties><property name="test_order" value="395" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIArgumentParsing" name="test_help_output_contains_expected_content" time="0.003"><properties><property name="test_order" value="396" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIMainFunction" name="test_main_setup_success" time="0.003"><properties><property name="test_order" value="397" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIMainFunction" name="test_main_setup_with_custom_dotenv_path" time="0.004"><properties><property name="test_order" value="398" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIMainFunction" name="test_main_setup_keyboard_interrupt" time="0.003"><properties><property name="test_order" value="399" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIMainFunction" name="test_main_setup_general_exception" time="0.003"><properties><property name="test_order" value="400" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIMainFunction" name="test_main_invalid_command" time="0.004"><properties><property name="test_order" value="401" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIMainFunction" name="test_main_no_args_defaults_to_setup" time="0.004"><properties><property name="test_order" value="402" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIMainFunction" name="test_main_mode_string_to_enum_conversion" time="0.005"><properties><property name="test_order" value="403" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIIntegration" name="test_cli_subprocess_integration" time="0.851"><properties><property name="test_order" value="404" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIIntegration" name="test_cli_setup_subprocess_help" time="0.698"><properties><property name="test_order" value="405" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIIntegration" name="test_cli_setup_dry_run_via_subprocess" time="0.684"><properties><property name="test_order" value="406" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIIntegration" name="test_cli_with_missing_environment" time="0.663"><properties><property name="test_order" value="407" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIErrorHandling" name="test_cli_invalid_mode_via_subprocess" time="0.694"><properties><property name="test_order" value="408" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIErrorHandling" name="test_cli_file_permission_error" time="0.004"><properties><property name="test_order" value="409" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIErrorHandling" name="test_cli_unicode_handling" time="0.004"><properties><property name="test_order" value="410" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIErrorHandling" name="test_cli_very_long_api_key" time="0.004"><properties><property name="test_order" value="411" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIConfigurationOptions" name="test_cli_all_mode_options" time="0.005"><properties><property name="test_order" value="412" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIConfigurationOptions" name="test_cli_custom_dotenv_paths" time="0.005"><properties><property name="test_order" value="413" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIConfigurationOptions" name="test_cli_dry_run_prevents_file_writes" time="0.004"><properties><property name="test_order" value="414" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIConfigurationOptions" name="test_cli_non_interactive_mode" time="0.003"><properties><property name="test_order" value="415" /></properties></testcase><testcase classname="tests.test_cli_comprehensive.TestCLIConfigurationOptions" name="test_cli_combined_options" time="0.004"><properties><property name="test_order" value="416" /></properties></testcase><testcase classname="tests.test_client" name="test_no_side_effects_on_import" time="0.003"><properties><property name="test_order" value="417" /></properties></testcase><testcase classname="tests.test_client" name="test_ai_client_creation" time="0.006"><properties><property name="test_order" value="418" /></properties></testcase><testcase classname="tests.test_client" name="test_ai_client_with_fake_provider" time="2.056"><properties><property name="test_order" value="419" /></properties></testcase><testcase classname="tests.test_client" name="test_json_extraction" time="1.052"><properties><property name="test_order" value="420" /></properties></testcase><testcase classname="tests.test_client" name="test_batch_ordering" time="1.049"><properties><property name="test_order" value="421" /></properties></testcase><testcase classname="tests.test_client" name="test_parameter_override" time="1.015"><properties><property name="test_order" value="422" /></properties></testcase><testcase classname="tests.test_client" name="test_create_client_convenience" time="0.006"><properties><property name="test_order" value="423" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientCacheMethods" name="test_should_use_cache_enabled" time="0.003"><properties><property name="test_order" value="424" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientCacheMethods" name="test_should_use_cache_disabled" time="0.003"><properties><property name="test_order" value="425" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientCacheMethods" name="test_should_use_cache_high_temperature" time="0.004"><properties><property name="test_order" value="426" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientCacheMethods" name="test_should_use_cache_default_temperature" time="0.003"><properties><property name="test_order" value="427" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientCacheMethods" name="test_build_cache_key" time="0.003"><properties><property name="test_order" value="428" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientAskMany" name="test_ask_many_basic" time="1.012"><properties><property name="test_order" value="429" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientAskMany" name="test_ask_many_with_error" time="1.012"><properties><property name="test_order" value="430" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientAskMany" name="test_ask_many_fail_fast" time="1.013"><properties><property name="test_order" value="431" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientAskMany" name="test_ask_many_invalid_concurrency" time="0.005"><properties><property name="test_order" value="432" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientJsonMethods" name="test_ask_json_success" time="1.014"><properties><property name="test_order" value="433" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientJsonMethods" name="test_ask_json_with_repair" time="1.012"><properties><property name="test_order" value="434" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientJsonMethods" name="test_ask_json_exhausted_repairs" time="1.013"><properties><property name="test_order" value="435" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientJsonMethods" name="test_ask_typed_success" time="0.006"><properties><property name="test_order" value="436" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientJsonMethods" name="test_ask_typed_validation_error" time="0.004"><properties><property name="test_order" value="437" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientFileOperations" name="test_upload_file_success" time="0.004"><properties><property name="test_order" value="438" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientFileOperations" name="test_upload_file_string_path" time="0.004"><properties><property name="test_order" value="439" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientFileOperations" name="test_upload_file_not_exists" time="0.003"><properties><property name="test_order" value="440" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientFileOperations" name="test_upload_file_not_file" time="0.003"><properties><property name="test_order" value="441" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientFileOperations" name="test_upload_file_provider_capability_error" time="0.042"><properties><property name="test_order" value="442" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientFileOperations" name="test_upload_file_general_error" time="0.003"><properties><property name="test_order" value="443" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientFileOperations" name="test_download_file_success_bytes" time="0.003"><properties><property name="test_order" value="444" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientFileOperations" name="test_download_file_success_to_path" time="0.006"><properties><property name="test_order" value="445" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientFileOperations" name="test_download_file_string_path" time="0.005"><properties><property name="test_order" value="446" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientFileOperations" name="test_download_file_empty_id" time="0.003"><properties><property name="test_order" value="447" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientFileOperations" name="test_download_file_provider_capability_error" time="0.004"><properties><property name="test_order" value="448" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientFileOperations" name="test_download_file_general_error" time="0.003"><properties><property name="test_order" value="449" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientImageGeneration" name="test_generate_image_success" time="0.003"><properties><property name="test_order" value="450" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientImageGeneration" name="test_generate_image_empty_prompt" time="0.004"><properties><property name="test_order" value="451" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientImageGeneration" name="test_generate_image_invalid_n" time="0.003"><properties><property name="test_order" value="452" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientImageGeneration" name="test_generate_image_provider_capability_error" time="0.003"><properties><property name="test_order" value="453" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientImageGeneration" name="test_generate_image_general_error" time="0.003"><properties><property name="test_order" value="454" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientAudioMethods" name="test_transcribe_audio_success" time="0.004"><properties><property name="test_order" value="455" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientAudioMethods" name="test_transcribe_audio_error" time="0.003"><properties><property name="test_order" value="456" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientAudioMethods" name="test_generate_audio_success" time="0.004"><properties><property name="test_order" value="457" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientAudioMethods" name="test_generate_audio_invalid_format" time="0.004"><properties><property name="test_order" value="458" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientAudioMethods" name="test_generate_audio_error" time="0.004"><properties><property name="test_order" value="459" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientAudioMethods" name="test_get_audio_voices_success" time="0.003"><properties><property name="test_order" value="460" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientAudioMethods" name="test_get_audio_voices_error" time="0.004"><properties><property name="test_order" value="461" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientAudioMethods" name="test_validate_audio_file_success" time="0.003"><properties><property name="test_order" value="462" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientAudioMethods" name="test_validate_audio_file_error" time="0.003"><properties><property name="test_order" value="463" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientKnowledgeMethods" name="test_ensure_knowledge_enabled_success" time="0.004"><properties><property name="test_order" value="464" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientKnowledgeMethods" name="test_ensure_knowledge_enabled_disabled" time="0.003"><properties><property name="test_order" value="465" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientKnowledgeMethods" name="test_get_knowledge_config" time="0.003"><properties><property name="test_order" value="466" /></properties><skipped type="pytest.skip" message="KnowledgeConfig class not implemented">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_client_additional_coverage.py:590: KnowledgeConfig class not implemented</skipped></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientKnowledgeMethods" name="test_index_knowledge_disabled" time="0.003"><properties><property name="test_order" value="467" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientKnowledgeMethods" name="test_search_knowledge_disabled" time="0.004"><properties><property name="test_order" value="468" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientKnowledgeMethods" name="test_ask_with_knowledge_disabled" time="0.003"><properties><property name="test_order" value="469" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientKnowledgeMethods" name="test_process_knowledge_results_empty" time="0.003"><properties><property name="test_order" value="470" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientKnowledgeMethods" name="test_deduplicate_chunks_empty" time="0.003"><properties><property name="test_order" value="471" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientKnowledgeMethods" name="test_longest_common_substring" time="0.003"><properties><property name="test_order" value="472" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientEmbeddings" name="test_get_embeddings_no_api_key" time="0.003"><properties><property name="test_order" value="473" /></properties></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientEmbeddings" name="test_get_embeddings_success" time="0.055"><properties><property name="test_order" value="474" /></properties><failure message="assert [] == [[0.1, 0.2, 0.3]]&#10;  &#10;  Right contains one more item: #x1B[0m[#x1B[94m0.1#x1B[39;49;00m, #x1B[94m0.2#x1B[39;49;00m, #x1B[94m0.3#x1B[39;49;00m]#x1B[90m#x1B[39;49;00m&#10;  Use -v to get more diff">self = &lt;tests.test_client_additional_coverage.TestAiClientEmbeddings object at 0x10c58cf10&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4524019664'&gt;

    @patch('openai.OpenAI')
    def test_get_embeddings_success(self, mock_openai):
        """Test successful embeddings generation."""
        mock_client = Mock()
        mock_response = Mock()
        mock_data = Mock()
        mock_data.embedding = [0.1, 0.2, 0.3]
        mock_response.data = [mock_data]
        mock_client.embeddings.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        result = self.client.get_embeddings(["test text"])
    
&gt;       assert result == [[0.1, 0.2, 0.3]]
E       assert [] == [[0.1, 0.2, 0.3]]
E         
E         Right contains one more item: #x1B[0m[#x1B[94m0.1#x1B[39;49;00m, #x1B[94m0.2#x1B[39;49;00m, #x1B[94m0.3#x1B[39;49;00m]#x1B[90m#x1B[39;49;00m
E         Use -v to get more diff

tests/test_client_additional_coverage.py:679: AssertionError</failure></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientEmbeddings" name="test_get_embeddings_with_dimensions" time="0.004"><properties><property name="test_order" value="475" /></properties><failure message="assert [] == [[0.1, 0.2, 0.3]]&#10;  &#10;  Right contains one more item: #x1B[0m[#x1B[94m0.1#x1B[39;49;00m, #x1B[94m0.2#x1B[39;49;00m, #x1B[94m0.3#x1B[39;49;00m]#x1B[90m#x1B[39;49;00m&#10;  Use -v to get more diff">self = &lt;tests.test_client_additional_coverage.TestAiClientEmbeddings object at 0x10c590280&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4523788128'&gt;

    @patch('openai.OpenAI')
    def test_get_embeddings_with_dimensions(self, mock_openai):
        """Test embeddings generation with dimensions."""
        mock_client = Mock()
        mock_response = Mock()
        mock_data = Mock()
        mock_data.embedding = [0.1, 0.2, 0.3]
        mock_response.data = [mock_data]
        mock_client.embeddings.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        result = self.client.get_embeddings(["test text"], dimensions=512)
    
&gt;       assert result == [[0.1, 0.2, 0.3]]
E       assert [] == [[0.1, 0.2, 0.3]]
E         
E         Right contains one more item: #x1B[0m[#x1B[94m0.1#x1B[39;49;00m, #x1B[94m0.2#x1B[39;49;00m, #x1B[94m0.3#x1B[39;49;00m]#x1B[90m#x1B[39;49;00m
E         Use -v to get more diff

tests/test_client_additional_coverage.py:698: AssertionError</failure></testcase><testcase classname="tests.test_client_additional_coverage.TestAiClientEmbeddings" name="test_get_embeddings_with_custom_model" time="0.005"><properties><property name="test_order" value="476" /></properties><failure message="assert [] == [[0.1, 0.2, 0.3]]&#10;  &#10;  Right contains one more item: #x1B[0m[#x1B[94m0.1#x1B[39;49;00m, #x1B[94m0.2#x1B[39;49;00m, #x1B[94m0.3#x1B[39;49;00m]#x1B[90m#x1B[39;49;00m&#10;  Use -v to get more diff">self = &lt;tests.test_client_additional_coverage.TestAiClientEmbeddings object at 0x10c5905b0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4525192768'&gt;

    @patch('openai.OpenAI')
    def test_get_embeddings_with_custom_model(self, mock_openai):
        """Test embeddings generation with custom model."""
        mock_client = Mock()
        mock_response = Mock()
        mock_data = Mock()
        mock_data.embedding = [0.1, 0.2, 0.3]
        mock_response.data = [mock_data]
        mock_client.embeddings.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        result = self.client.get_embeddings(["test text"], model="custom-model")
    
&gt;       assert result == [[0.1, 0.2, 0.3]]
E       assert [] == [[0.1, 0.2, 0.3]]
E         
E         Right contains one more item: #x1B[0m[#x1B[94m0.1#x1B[39;49;00m, #x1B[94m0.2#x1B[39;49;00m, #x1B[94m0.3#x1B[39;49;00m]#x1B[90m#x1B[39;49;00m
E         Use -v to get more diff

tests/test_client_additional_coverage.py:718: AssertionError</failure></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientBasics" name="test_no_side_effects_on_import" time="0.003"><properties><property name="test_order" value="477" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientBasics" name="test_ai_client_creation_with_settings" time="0.005"><properties><property name="test_order" value="478" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientBasics" name="test_ai_client_creation_with_provider" time="0.044"><properties><property name="test_order" value="479" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientBasics" name="test_create_client_convenience" time="0.005"><properties><property name="test_order" value="480" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientAsk" name="test_ask_single_prompt" time="1.014"><properties><property name="test_order" value="481" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientAsk" name="test_ask_with_json_format" time="1.051"><properties><property name="test_order" value="482" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientAsk" name="test_ask_with_overrides" time="3.025"><properties><property name="test_order" value="483" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientAsk" name="test_ask_many_prompts" time="1.014"><properties><property name="test_order" value="484" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientAsk" name="test_ask_many_with_json_format" time="1.015"><properties><property name="test_order" value="485" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientAsk" name="test_ask_many_with_overrides" time="1.015"><properties><property name="test_order" value="486" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientAsk" name="test_ask_result_objects" time="2.017"><properties><property name="test_order" value="487" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientErrorHandling" name="test_provider_error_wrapping" time="1.013"><properties><property name="test_order" value="488" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientErrorHandling" name="test_provider_error_on_specific_call" time="2.021"><properties><property name="test_order" value="489" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientErrorHandling" name="test_error_in_batch_requests" time="2.021"><properties><property name="test_order" value="490" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientErrorHandling" name="test_error_with_overrides" time="1.014"><properties><property name="test_order" value="491" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientParameterHandling" name="test_parameter_passthrough" time="1.014"><properties><property name="test_order" value="492" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientParameterHandling" name="test_parameter_passthrough_batch" time="1.015"><properties><property name="test_order" value="493" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientParameterHandling" name="test_response_format_parameter" time="2.021"><properties><property name="test_order" value="494" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientEdgeCases" name="test_empty_prompt" time="1.014"><properties><property name="test_order" value="495" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientEdgeCases" name="test_very_long_prompt" time="1.014"><properties><property name="test_order" value="496" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientEdgeCases" name="test_special_characters_in_prompt" time="1.015"><properties><property name="test_order" value="497" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientEdgeCases" name="test_unicode_in_prompt" time="1.016"><properties><property name="test_order" value="498" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientEdgeCases" name="test_empty_batch_list" time="1.014"><properties><property name="test_order" value="499" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientEdgeCases" name="test_single_item_batch" time="1.014"><properties><property name="test_order" value="500" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientDeterministicBehavior" name="test_deterministic_responses" time="2.021"><properties><property name="test_order" value="501" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientDeterministicBehavior" name="test_deterministic_batch_order" time="2.019"><properties><property name="test_order" value="502" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientDeterministicBehavior" name="test_provider_call_count_tracking" time="2.018"><properties><property name="test_order" value="503" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientIntegration" name="test_client_with_custom_responses" time="3.024"><properties><property name="test_order" value="504" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientIntegration" name="test_client_with_delay" time="1.015"><properties><property name="test_order" value="505" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientConfiguration" name="test_client_without_settings_or_provider" time="0.086"><properties><property name="test_order" value="506" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientConfiguration" name="test_client_with_minimal_settings" time="0.005"><properties><property name="test_order" value="507" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_sanitize_namespace_function" time="0.003"><properties><property name="test_order" value="508" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_client_with_custom_cache" time="0.005"><properties><property name="test_order" value="509" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_client_usage_tracking_initialization" time="0.005"><properties><property name="test_order" value="510" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_ask_with_parameter_overrides" time="1.013"><properties><property name="test_order" value="511" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_ask_with_conversation_history" time="1.016"><properties><property name="test_order" value="512" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_ask_with_files" time="1.016"><properties><property name="test_order" value="513" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_upload_file_functionality" time="0.007"><properties><property name="test_order" value="514" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_ask_json_success" time="1.014"><properties><property name="test_order" value="515" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_ask_json_invalid_json" time="1.016"><properties><property name="test_order" value="516" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_ask_json_with_repair" time="1.013"><properties><property name="test_order" value="517" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_ask_with_caching_enabled" time="2.020"><properties><property name="test_order" value="518" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_model_dump_excludes_api_key" time="1.018"><properties><property name="test_order" value="519" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_progress_indicator_initialization" time="0.007"><properties><property name="test_order" value="520" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_error_handling_provider_error" time="1.011"><properties><property name="test_order" value="521" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_dynamic_settings_update" time="0.005"><properties><property name="test_order" value="522" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_client_with_different_providers" time="0.005"><properties><property name="test_order" value="523" /></properties></testcase><testcase classname="tests.test_client_comprehensive.TestAiClientPhase7Enhanced" name="test_client_configuration_isolation" time="0.007"><properties><property name="test_order" value="524" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientIntegrationWorkflows" name="test_complete_ask_workflow_with_caching" time="0.003"><properties><property name="test_order" value="525" /></properties><skipped type="pytest.skip" message="Cache integration test has complex mocking requirements">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_client_comprehensive_integration.py:31: Cache integration test has complex mocking requirements</skipped></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientIntegrationWorkflows" name="test_ask_many_with_concurrency_and_fail_fast" time="1.012"><properties><property name="test_order" value="526" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientIntegrationWorkflows" name="test_json_workflow_with_repair_mechanism" time="1.011"><properties><property name="test_order" value="527" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientIntegrationWorkflows" name="test_typed_response_workflow" time="0.005"><properties><property name="test_order" value="528" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientIntegrationWorkflows" name="test_usage_tracking_integration" time="0.003"><properties><property name="test_order" value="529" /></properties><skipped type="pytest.skip" message="Usage tracking integration test has complex requirements">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_client_comprehensive_integration.py:111: Usage tracking integration test has complex requirements</skipped></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientFileOperationsIntegration" name="test_complete_file_upload_download_workflow" time="0.010"><properties><property name="test_order" value="530" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientFileOperationsIntegration" name="test_file_operations_error_handling" time="0.004"><properties><property name="test_order" value="531" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientImageGenerationIntegration" name="test_image_generation_workflow" time="0.003"><properties><property name="test_order" value="532" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientImageGenerationIntegration" name="test_image_generation_validation" time="0.003"><properties><property name="test_order" value="533" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientAudioProcessingIntegration" name="test_audio_transcription_workflow" time="0.003"><properties><property name="test_order" value="534" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientAudioProcessingIntegration" name="test_audio_generation_workflow" time="0.004"><properties><property name="test_order" value="535" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientAudioProcessingIntegration" name="test_audio_voices_and_validation" time="0.003"><properties><property name="test_order" value="536" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientKnowledgeBaseIntegration" name="test_knowledge_base_workflow" time="0.002"><properties><property name="test_order" value="537" /></properties><skipped type="pytest.skip" message="KnowledgeConfig class not implemented">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_client_comprehensive_integration.py:346: KnowledgeConfig class not implemented</skipped></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientKnowledgeBaseIntegration" name="test_knowledge_base_disabled_handling" time="0.003"><properties><property name="test_order" value="538" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientEmbeddingsIntegration" name="test_embeddings_workflow" time="0.004"><properties><property name="test_order" value="539" /></properties><failure message="assert [] == [[0.1, 0.2, 0.3, 0.4, 0.5]]&#10;  &#10;  Right contains one more item: #x1B[0m[#x1B[94m0.1#x1B[39;49;00m, #x1B[94m0.2#x1B[39;49;00m, #x1B[94m0.3#x1B[39;49;00m, #x1B[94m0.4#x1B[39;49;00m, #x1B[94m0.5#x1B[39;49;00m]#x1B[90m#x1B[39;49;00m&#10;  Use -v to get more diff">self = &lt;tests.test_client_comprehensive_integration.TestClientEmbeddingsIntegration object at 0x10c5f2760&gt;

    def test_embeddings_workflow(self):
        """Test complete embeddings workflow."""
        mock_settings = Mock()
        mock_settings.cache_enabled = False
        mock_settings.api_key = "test-api-key"
        mock_settings.embedding_model = "text-embedding-3-small"
        mock_settings.model_dump.return_value = {}
    
        with patch('ai_utilities.providers.provider_factory.create_provider') as mock_create_provider, \
             patch('openai.OpenAI') as mock_openai:
    
            mock_provider = Mock()
            mock_create_provider.return_value = mock_provider
    
            # Setup OpenAI mock
            mock_client = Mock()
            mock_response = Mock()
            mock_data = Mock()
            mock_data.embedding = [0.1, 0.2, 0.3, 0.4, 0.5]
            mock_response.data = [mock_data]
            mock_client.embeddings.create.return_value = mock_response
            mock_openai.return_value = mock_client
    
            client = AiClient(settings=mock_settings)
    
            # Test basic embeddings
            result = client.get_embeddings(["test text"])
&gt;           assert result == [[0.1, 0.2, 0.3, 0.4, 0.5]]
E           assert [] == [[0.1, 0.2, 0.3, 0.4, 0.5]]
E             
E             Right contains one more item: #x1B[0m[#x1B[94m0.1#x1B[39;49;00m, #x1B[94m0.2#x1B[39;49;00m, #x1B[94m0.3#x1B[39;49;00m, #x1B[94m0.4#x1B[39;49;00m, #x1B[94m0.5#x1B[39;49;00m]#x1B[90m#x1B[39;49;00m
E             Use -v to get more diff

tests/test_client_comprehensive_integration.py:405: AssertionError</failure></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientEmbeddingsIntegration" name="test_embeddings_error_handling" time="0.003"><properties><property name="test_order" value="540" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientConfigurationIntegration" name="test_client_configuration_from_dotenv" time="0.003"><properties><property name="test_order" value="541" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientConfigurationIntegration" name="test_client_reconfiguration_workflow" time="0.003"><properties><property name="test_order" value="542" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientConfigurationIntegration" name="test_create_client_convenience_function" time="0.004"><properties><property name="test_order" value="543" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientErrorHandlingIntegration" name="test_provider_error_propagation" time="3.016"><properties><property name="test_order" value="544" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientErrorHandlingIntegration" name="test_cache_error_handling" time="1.013"><properties><property name="test_order" value="545" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientErrorHandlingIntegration" name="test_usage_tracking_error_handling" time="1.016"><properties><property name="test_order" value="546" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientPerformanceIntegration" name="test_concurrent_operations" time="1.012"><properties><property name="test_order" value="547" /></properties></testcase><testcase classname="tests.test_client_comprehensive_integration.TestClientPerformanceIntegration" name="test_memory_efficiency" time="1.013"><properties><property name="test_order" value="548" /></properties></testcase><testcase classname="tests.test_client_core.TestSanitizeNamespace" name="test_sanitize_namespace_basic" time="0.003"><properties><property name="test_order" value="549" /></properties></testcase><testcase classname="tests.test_client_core.TestSanitizeNamespace" name="test_sanitize_namespace_special_characters" time="0.004"><properties><property name="test_order" value="550" /></properties></testcase><testcase classname="tests.test_client_core.TestSanitizeNamespace" name="test_sanitize_namespace_consecutive_underscores" time="0.003"><properties><property name="test_order" value="551" /></properties></testcase><testcase classname="tests.test_client_core.TestSanitizeNamespace" name="test_sanitize_namespace_safe_characters" time="0.003"><properties><property name="test_order" value="552" /></properties></testcase><testcase classname="tests.test_client_core.TestSanitizeNamespace" name="test_sanitize_namespace_edge_cases" time="0.003"><properties><property name="test_order" value="553" /></properties></testcase><testcase classname="tests.test_client_core.TestSanitizeNamespace" name="test_sanitize_namespace_unicode" time="0.004"><properties><property name="test_order" value="554" /></properties></testcase><testcase classname="tests.test_client_core.TestDefaultNamespace" name="test_default_namespace_basic" time="0.041"><properties><property name="test_order" value="555" /></properties></testcase><testcase classname="tests.test_client_core.TestDefaultNamespace" name="test_default_namespace_with_custom_path" time="0.003"><properties><property name="test_order" value="556" /></properties></testcase><testcase classname="tests.test_client_core.TestDefaultNamespace" name="test_default_namespace_sanitization" time="0.003"><properties><property name="test_order" value="557" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_client_initialization_with_settings" time="0.006"><properties><property name="test_order" value="558" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_client_initialization_with_provider" time="0.043"><properties><property name="test_order" value="559" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_client_initialization_default_settings" time="0.006"><properties><property name="test_order" value="560" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_ask_method" time="1.052"><properties><property name="test_order" value="561" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_ask_method_with_json_format" time="1.055"><properties><property name="test_order" value="562" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_ask_method_with_kwargs" time="1.053"><properties><property name="test_order" value="563" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_ask_many_method" time="1.052"><properties><property name="test_order" value="564" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_ask_many_method_with_json_format" time="1.050"><properties><property name="test_order" value="565" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_ask_many_method_with_kwargs" time="1.053"><properties><property name="test_order" value="566" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_ask_method_error_handling" time="1.050"><properties><property name="test_order" value="567" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_ask_many_method_error_handling" time="1.050"><properties><property name="test_order" value="568" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_client_with_usage_tracking" time="0.046"><properties><property name="test_order" value="569" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_client_without_usage_tracking" time="0.048"><properties><property name="test_order" value="570" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_client_with_cache" time="0.044"><properties><property name="test_order" value="571" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_client_without_cache" time="0.044"><properties><property name="test_order" value="572" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_client_file_operations_not_supported" time="0.044"><properties><property name="test_order" value="573" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClient" name="test_client_image_generation_not_supported" time="0.045"><properties><property name="test_order" value="574" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClientIntegration" name="test_client_end_to_end_workflow" time="2.017"><properties><property name="test_order" value="575" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClientIntegration" name="test_client_with_different_return_formats" time="1.053"><properties><property name="test_order" value="576" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClientIntegration" name="test_client_error_propagation" time="1.051"><properties><property name="test_order" value="577" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClientIntegration" name="test_client_parameter_validation" time="0.016"><properties><property name="test_order" value="578" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClientIntegration" name="test_client_provider_fallback" time="0.005"><properties><property name="test_order" value="579" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClientAdvancedFeatures" name="test_client_with_progress_indicator" time="0.046"><properties><property name="test_order" value="580" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClientAdvancedFeatures" name="test_client_with_custom_timeout" time="0.006"><properties><property name="test_order" value="581" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClientAdvancedFeatures" name="test_client_with_retry_logic" time="1.051"><properties><property name="test_order" value="582" /></properties></testcase><testcase classname="tests.test_client_core.TestAiClientAdvancedFeatures" name="test_client_state_isolation" time="2.092"><properties><property name="test_order" value="583" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientUtilitiesCoverage" name="test_sanitize_namespace_all_special_chars" time="0.004"><properties><property name="test_order" value="584" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientUtilitiesCoverage" name="test_sanitize_namespace_mixed_content" time="0.004"><properties><property name="test_order" value="585" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientUtilitiesCoverage" name="test_sanitize_namespace_unicode_combining" time="0.003"><properties><property name="test_order" value="586" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientUtilitiesCoverage" name="test_sanitize_namespace_numbers_and_symbols" time="0.003"><properties><property name="test_order" value="587" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientUtilitiesCoverage" name="test_sanitize_namespace_whitespace_variations" time="0.003"><properties><property name="test_order" value="588" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientUtilitiesCoverage" name="test_default_namespace_username_variations" time="0.003"><properties><property name="test_order" value="589" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientUtilitiesCoverage" name="test_default_namespace_edge_cases" time="0.003"><properties><property name="test_order" value="590" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientUtilitiesCoverage" name="test_sanitize_namespace_real_world_examples" time="0.003"><properties><property name="test_order" value="591" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientUtilitiesCoverage" name="test_sanitize_namespace_extreme_lengths" time="0.004"><properties><property name="test_order" value="592" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientUtilitiesCoverage" name="test_sanitize_namespace_edge_unicode" time="0.005"><properties><property name="test_order" value="593" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientUtilitiesCoverage" name="test_sanitize_namespace_consistency" time="0.003"><properties><property name="test_order" value="594" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientUtilitiesCoverage" name="test_sanitize_namespace_memory_efficiency" time="0.101"><properties><property name="test_order" value="595" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientIntegrationCoverage" name="test_client_with_different_config_formats" time="0.008"><properties><property name="test_order" value="596" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientIntegrationCoverage" name="test_client_error_handling" time="0.004"><properties><property name="test_order" value="597" /></properties></testcase><testcase classname="tests.test_client_coverage.TestClientIntegrationCoverage" name="test_namespace_sanitize_integration" time="0.003"><properties><property name="test_order" value="598" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_sanitize_namespace_basic_functionality" time="0.003"><properties><property name="test_order" value="599" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_sanitize_namespace_special_characters_removal" time="0.003"><properties><property name="test_order" value="600" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_sanitize_namespace_all_special_chars" time="0.003"><properties><property name="test_order" value="601" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_sanitize_namespace_whitespace_normalization" time="0.003"><properties><property name="test_order" value="602" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_sanitize_namespace_preservation_patterns" time="0.002"><properties><property name="test_order" value="603" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_sanitize_namespace_unicode_handling" time="0.002"><properties><property name="test_order" value="604" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_sanitize_namespace_empty_and_edge_cases" time="0.002"><properties><property name="test_order" value="605" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_default_namespace_basic" time="0.003"><properties><property name="test_order" value="606" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_default_namespace_username_variations" time="0.099"><properties><property name="test_order" value="607" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_default_namespace_edge_cases" time="0.003"><properties><property name="test_order" value="608" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_sanitize_namespace_real_world_examples" time="0.003"><properties><property name="test_order" value="609" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_sanitize_namespace_consistency" time="0.003"><properties><property name="test_order" value="610" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_sanitize_namespace_performance" time="0.010"><properties><property name="test_order" value="611" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_sanitize_namespace_memory_efficiency" time="0.076"><properties><property name="test_order" value="612" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_sanitize_namespace_extreme_lengths" time="0.003"><properties><property name="test_order" value="613" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_sanitize_namespace_edge_unicode" time="0.003"><properties><property name="test_order" value="614" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientUtilitiesCoverageFixed" name="test_default_namespace_deterministic" time="0.003"><properties><property name="test_order" value="615" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientEdgeCases" name="test_sanitize_namespace_regex_patterns" time="0.003"><properties><property name="test_order" value="616" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientEdgeCases" name="test_default_namespace_components" time="0.003"><properties><property name="test_order" value="617" /></properties></testcase><testcase classname="tests.test_client_coverage_fixed.TestClientEdgeCases" name="test_namespace_sanitization_integration_scenarios" time="0.003"><properties><property name="test_order" value="618" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_basic_functionality" time="0.003"><properties><property name="test_order" value="619" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_special_characters_removal" time="0.003"><properties><property name="test_order" value="620" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_all_special_chars" time="0.003"><properties><property name="test_order" value="621" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_whitespace_normalization" time="0.003"><properties><property name="test_order" value="622" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_preservation_patterns" time="0.002"><properties><property name="test_order" value="623" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_unicode_handling" time="0.003"><properties><property name="test_order" value="624" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_empty_and_edge_cases" time="0.002"><properties><property name="test_order" value="625" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_default_namespace_basic" time="0.003"><properties><property name="test_order" value="626" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_default_namespace_username_variations" time="0.004"><properties><property name="test_order" value="627" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_default_namespace_edge_cases" time="0.004"><properties><property name="test_order" value="628" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_real_world_examples" time="0.003"><properties><property name="test_order" value="629" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_consistency" time="0.002"><properties><property name="test_order" value="630" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_performance" time="0.011"><properties><property name="test_order" value="631" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_memory_efficiency" time="0.081"><properties><property name="test_order" value="632" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_extreme_lengths" time="0.003"><properties><property name="test_order" value="633" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_edge_unicode" time="0.002"><properties><property name="test_order" value="634" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_sanitize_namespace_mixed_unicode_special" time="0.003"><properties><property name="test_order" value="635" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientUtilitiesCoverageWorking" name="test_default_namespace_deterministic" time="0.004"><properties><property name="test_order" value="636" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientEdgeCases" name="test_sanitize_namespace_regex_patterns" time="0.003"><properties><property name="test_order" value="637" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientEdgeCases" name="test_default_namespace_components" time="0.003"><properties><property name="test_order" value="638" /></properties></testcase><testcase classname="tests.test_client_coverage_working.TestClientEdgeCases" name="test_namespace_sanitization_integration_scenarios" time="0.003"><properties><property name="test_order" value="639" /></properties></testcase><testcase classname="tests.test_client_direct" name="test_direct_client_import" time="0.003"><properties><property name="test_order" value="640" /></properties></testcase><testcase classname="tests.test_client_phase7_core" name="test_sanitize_namespace_comprehensive" time="0.003"><properties><property name="test_order" value="641" /></properties></testcase><testcase classname="tests.test_client_phase7_core" name="test_default_namespace" time="0.003"><properties><property name="test_order" value="642" /></properties></testcase><testcase classname="tests.test_client_phase7_core" name="test_client_initialization_minimal" time="0.005"><properties><property name="test_order" value="643" /></properties></testcase><testcase classname="tests.test_client_phase7_core" name="test_client_with_explicit_provider" time="0.007"><properties><property name="test_order" value="644" /></properties></testcase><testcase classname="tests.test_client_phase7_core" name="test_client_cache_configuration" time="0.005"><properties><property name="test_order" value="645" /></properties></testcase><testcase classname="tests.test_client_simple.TestSanitizeNamespace" name="test_sanitize_namespace_basic" time="0.003"><properties><property name="test_order" value="646" /></properties></testcase><testcase classname="tests.test_client_simple.TestSanitizeNamespace" name="test_sanitize_namespace_special_characters" time="0.003"><properties><property name="test_order" value="647" /></properties></testcase><testcase classname="tests.test_client_simple.TestSanitizeNamespace" name="test_sanitize_namespace_consecutive_underscores" time="0.004"><properties><property name="test_order" value="648" /></properties></testcase><testcase classname="tests.test_client_simple.TestSanitizeNamespace" name="test_sanitize_namespace_safe_characters" time="0.003"><properties><property name="test_order" value="649" /></properties></testcase><testcase classname="tests.test_client_simple.TestSanitizeNamespace" name="test_sanitize_namespace_empty" time="0.003"><properties><property name="test_order" value="650" /></properties></testcase><testcase classname="tests.test_client_simple.TestSanitizeNamespace" name="test_sanitize_namespace_length_limit" time="0.003"><properties><property name="test_order" value="651" /></properties></testcase><testcase classname="tests.test_client_simple.TestDefaultNamespace" name="test_default_namespace_format" time="0.005"><properties><property name="test_order" value="652" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientBasic" name="test_client_initialization_with_settings" time="0.005"><properties><property name="test_order" value="653" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientBasic" name="test_client_initialization_with_provider" time="0.044"><properties><property name="test_order" value="654" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientBasic" name="test_client_initialization_default" time="0.004"><properties><property name="test_order" value="655" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientBasic" name="test_ask_single_prompt" time="1.053"><properties><property name="test_order" value="656" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientBasic" name="test_ask_with_json_format" time="1.050"><properties><property name="test_order" value="657" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientBasic" name="test_ask_multiple_prompts" time="1.050"><properties><property name="test_order" value="658" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientBasic" name="test_ask_with_kwargs" time="1.052"><properties><property name="test_order" value="659" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientBasic" name="test_client_with_usage_tracking" time="0.047"><properties><property name="test_order" value="660" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientBasic" name="test_client_without_usage_tracking" time="0.044"><properties><property name="test_order" value="661" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientBasic" name="test_client_with_cache" time="0.058"><properties><property name="test_order" value="662" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientBasic" name="test_client_error_handling" time="1.052"><properties><property name="test_order" value="663" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientCaching" name="test_cache_key_building" time="0.007"><properties><property name="test_order" value="664" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientCaching" name="test_should_use_cache" time="0.005"><properties><property name="test_order" value="665" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientCaching" name="test_should_not_use_cache_high_temperature" time="0.005"><properties><property name="test_order" value="666" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientAdvanced" name="test_check_for_updates" time="0.006"><properties><property name="test_order" value="667" /></properties></testcase><testcase classname="tests.test_client_simple.TestAiClientAdvanced" name="test_client_state_isolation" time="0.009"><properties><property name="test_order" value="668" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestClientUtilityFunctions" name="test_sanitize_namespace_basic_cases" time="0.003"><properties><property name="test_order" value="669" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestClientUtilityFunctions" name="test_sanitize_namespace_special_chars" time="0.003"><properties><property name="test_order" value="670" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestClientUtilityFunctions" name="test_sanitize_namespace_edge_cases" time="0.003"><properties><property name="test_order" value="671" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestClientUtilityFunctions" name="test_default_namespace_function" time="0.004"><properties><property name="test_order" value="672" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestClientUtilityFunctions" name="test_running_under_pytest_detection" time="0.003"><properties><property name="test_order" value="673" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientBasicCoverage" name="test_client_init_minimal" time="0.043"><properties><property name="test_order" value="674" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientBasicCoverage" name="test_client_with_explicit_provider" time="0.003"><properties><property name="test_order" value="675" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientBasicCoverage" name="test_check_for_updates_no_api_key" time="0.004"><properties><property name="test_order" value="676" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientBasicCoverage" name="test_check_for_updates_with_api_key" time="0.003"><properties><property name="test_order" value="677" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientBasicCoverage" name="test_ask_single_prompt" time="1.011"><properties><property name="test_order" value="678" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientBasicCoverage" name="test_ask_json_format" time="1.013"><properties><property name="test_order" value="679" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientBasicCoverage" name="test_ask_multiple_prompts" time="1.012"><properties><property name="test_order" value="680" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientBasicCoverage" name="test_get_usage_stats_enabled" time="0.004"><properties><property name="test_order" value="681" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientBasicCoverage" name="test_get_usage_stats_disabled" time="0.003"><properties><property name="test_order" value="682" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientBasicCoverage" name="test_print_usage_summary_enabled" time="0.004"><properties><property name="test_order" value="683" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientBasicCoverage" name="test_print_usage_summary_disabled" time="0.005"><properties><property name="test_order" value="684" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestCreateClientFunction" name="test_create_client_basic" time="0.006"><properties><property name="test_order" value="685" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestCreateClientFunction" name="test_create_client_with_settings" time="0.004"><properties><property name="test_order" value="686" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientEdgeCases" name="test_client_init_with_dotenv" time="0.003"><properties><property name="test_order" value="687" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientEdgeCases" name="test_client_with_usage_tracking" time="0.003"><properties><property name="test_order" value="688" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientEdgeCases" name="test_client_with_cache" time="0.004"><properties><property name="test_order" value="689" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientEdgeCases" name="test_client_with_explicit_cache" time="0.003"><properties><property name="test_order" value="690" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientEdgeCases" name="test_client_progress_indicator" time="0.003"><properties><property name="test_order" value="691" /></properties></testcase><testcase classname="tests.test_client_simple_coverage.TestAiClientEdgeCases" name="test_reconfigure_method" time="0.003"><properties><property name="test_order" value="692" /></properties></testcase><testcase classname="tests.test_config_models.TestModelConfig" name="test_default_model_config" time="0.003"><properties><property name="test_order" value="693" /></properties></testcase><testcase classname="tests.test_config_models.TestModelConfig" name="test_valid_custom_model_config" time="0.003"><properties><property name="test_order" value="694" /></properties></testcase><testcase classname="tests.test_config_models.TestModelConfig" name="test_invalid_tokens_per_minute_too_low" time="0.003"><properties><property name="test_order" value="695" /></properties></testcase><testcase classname="tests.test_config_models.TestModelConfig" name="test_invalid_tokens_per_day_too_high" time="0.003"><properties><property name="test_order" value="696" /></properties></testcase><testcase classname="tests.test_config_models.TestModelConfig" name="test_boundary_values" time="0.003"><properties><property name="test_order" value="697" /></properties></testcase><testcase classname="tests.test_config_models.TestModelConfig" name="test_immutability" time="0.003"><properties><property name="test_order" value="698" /></properties></testcase><testcase classname="tests.test_config_models.TestOpenAIConfig" name="test_default_openai_config" time="0.003"><properties><property name="test_order" value="699" /></properties></testcase><testcase classname="tests.test_config_models.TestOpenAIConfig" name="test_valid_custom_openai_config" time="0.003"><properties><property name="test_order" value="700" /></properties></testcase><testcase classname="tests.test_config_models.TestOpenAIConfig" name="test_invalid_base_url" time="0.003"><properties><property name="test_order" value="701" /></properties></testcase><testcase classname="tests.test_config_models.TestOpenAIConfig" name="test_temperature_bounds" time="0.003"><properties><property name="test_order" value="702" /></properties></testcase><testcase classname="tests.test_config_models.TestOpenAIConfig" name="test_immutability" time="0.002"><properties><property name="test_order" value="703" /></properties></testcase><testcase classname="tests.test_config_models.TestAIConfig" name="test_default_ai_config" time="0.003"><properties><property name="test_order" value="704" /></properties></testcase><testcase classname="tests.test_config_models.TestAIConfig" name="test_environment_variable_integration" time="0.004"><properties><property name="test_order" value="705" /></properties></testcase><testcase classname="tests.test_config_models.TestAIConfig" name="test_global_model_rate_limits_env_vars" time="0.003"><properties><property name="test_order" value="706" /></properties></testcase><testcase classname="tests.test_config_models.TestAIConfig" name="test_per_model_rate_limits_env_vars" time="0.003"><properties><property name="test_order" value="707" /></properties></testcase><testcase classname="tests.test_config_models.TestAIConfig" name="test_invalid_environment_variables" time="0.003"><properties><property name="test_order" value="708" /></properties></testcase><testcase classname="tests.test_config_models.TestAIConfig" name="test_get_model_config" time="0.003"><properties><property name="test_order" value="709" /></properties></testcase><testcase classname="tests.test_config_models.TestAIConfig" name="test_update_model_config" time="0.003"><properties><property name="test_order" value="710" /></properties></testcase><testcase classname="tests.test_config_models.TestAIConfig" name="test_immutability" time="0.003"><properties><property name="test_order" value="711" /></properties></testcase><testcase classname="tests.test_config_models.TestAIConfig" name="test_extra_fields_forbidden" time="0.003"><properties><property name="test_order" value="712" /></properties></testcase><testcase classname="tests.test_config_models.TestConfigIntegration" name="test_full_configuration_workflow" time="0.003"><properties><property name="test_order" value="713" /></properties></testcase><testcase classname="tests.test_config_models.TestConfigIntegration" name="test_configuration_validation_chain" time="0.003"><properties><property name="test_order" value="714" /></properties></testcase><testcase classname="tests.test_config_models.TestConfigIntegration" name="test_environment_variable_precedence" time="0.003"><properties><property name="test_order" value="715" /></properties></testcase><testcase classname="tests.test_config_resolver.TestProviderResolution" name="test_resolve_provider_per_request" time="0.003"><properties><property name="test_order" value="716" /></properties></testcase><testcase classname="tests.test_config_resolver.TestProviderResolution" name="test_resolve_provider_env_override" time="0.003"><properties><property name="test_order" value="717" /></properties></testcase><testcase classname="tests.test_config_resolver.TestProviderResolution" name="test_resolve_provider_from_url_ollama" time="0.002"><properties><property name="test_order" value="718" /></properties></testcase><testcase classname="tests.test_config_resolver.TestProviderResolution" name="test_resolve_provider_from_url_lmstudio" time="0.003"><properties><property name="test_order" value="719" /></properties></testcase><testcase classname="tests.test_config_resolver.TestProviderResolution" name="test_resolve_provider_from_url_openai" time="0.003"><properties><property name="test_order" value="720" /></properties></testcase><testcase classname="tests.test_config_resolver.TestProviderResolution" name="test_resolve_provider_default" time="0.003"><properties><property name="test_order" value="721" /></properties></testcase><testcase classname="tests.test_config_resolver.TestApiKeyResolution" name="test_resolve_api_key_per_request" time="0.045"><properties><property name="test_order" value="722" /></properties></testcase><testcase classname="tests.test_config_resolver.TestApiKeyResolution" name="test_resolve_api_key_settings_override" time="0.002"><properties><property name="test_order" value="723" /></properties></testcase><testcase classname="tests.test_config_resolver.TestApiKeyResolution" name="test_resolve_api_key_vendor_specific" time="0.002"><properties><property name="test_order" value="724" /></properties></testcase><testcase classname="tests.test_config_resolver.TestApiKeyResolution" name="test_resolve_api_key_from_settings" time="0.006"><properties><property name="test_order" value="725" /></properties></testcase><testcase classname="tests.test_config_resolver.TestApiKeyResolution" name="test_resolve_api_key_local_fallback" time="0.002"><properties><property name="test_order" value="726" /></properties></testcase><testcase classname="tests.test_config_resolver.TestApiKeyResolution" name="test_resolve_api_key_missing_cloud" time="0.003"><properties><property name="test_order" value="727" /></properties></testcase><testcase classname="tests.test_config_resolver.TestBaseUrlResolution" name="test_resolve_base_url_per_request" time="0.002"><properties><property name="test_order" value="728" /></properties></testcase><testcase classname="tests.test_config_resolver.TestBaseUrlResolution" name="test_resolve_base_url_settings_override" time="0.003"><properties><property name="test_order" value="729" /></properties></testcase><testcase classname="tests.test_config_resolver.TestBaseUrlResolution" name="test_resolve_base_url_provider_defaults" time="0.002"><properties><property name="test_order" value="730" /></properties></testcase><testcase classname="tests.test_config_resolver.TestResolvedConfig" name="test_resolve_request_config_full" time="0.005"><properties><property name="test_order" value="731" /></properties></testcase><testcase classname="tests.test_config_resolver.TestResolvedConfig" name="test_resolve_request_config_env_provider" time="0.005"><properties><property name="test_order" value="732" /></properties></testcase><testcase classname="tests.test_config_resolver.TestResolvedConfig" name="test_resolve_request_config_vendor_key" time="0.006"><properties><property name="test_order" value="733" /></properties></testcase><testcase classname="tests.test_config_resolver.TestResolvedConfig" name="test_resolve_request_config_local_provider_inference" time="0.005"><properties><property name="test_order" value="734" /></properties></testcase><testcase classname="tests.test_config_resolver.TestResolvedConfig" name="test_resolve_request_config_with_settings_vendor_keys" time="0.005"><properties><property name="test_order" value="735" /></properties></testcase><testcase classname="tests.test_config_resolver.TestResolvedConfig" name="test_resolve_request_config_precedence" time="0.005"><properties><property name="test_order" value="736" /></properties></testcase><testcase classname="tests.test_config_resolver.TestErrorHandling" name="test_unknown_provider_error" time="0.006"><properties><property name="test_order" value="737" /></properties></testcase><testcase classname="tests.test_config_resolver.TestErrorHandling" name="test_missing_api_key_cloud_provider" time="0.005"><properties><property name="test_order" value="738" /></properties></testcase><testcase classname="tests.test_config_resolver.TestErrorHandling" name="test_local_provider_no_key_required" time="0.005"><properties><property name="test_order" value="739" /></properties></testcase><testcase classname="tests.test_config_resolver.TestProviderSpecific" name="test_together_ai_config" time="0.005"><properties><property name="test_order" value="740" /></properties></testcase><testcase classname="tests.test_config_resolver.TestProviderSpecific" name="test_openrouter_config" time="0.006"><properties><property name="test_order" value="741" /></properties></testcase><testcase classname="tests.test_config_resolver.TestBackwardCompatibility" name="test_legacy_ai_api_key" time="0.005"><properties><property name="test_order" value="742" /></properties></testcase><testcase classname="tests.test_config_resolver.TestBackwardCompatibility" name="test_default_settings_still_work" time="0.005"><properties><property name="test_order" value="743" /></properties></testcase><testcase classname="tests.test_context_configuration.TestConfigurationContext" name="test_configuration_context_creation" time="0.003"><properties><property name="test_order" value="744" /></properties></testcase><testcase classname="tests.test_context_configuration.TestConfigurationContext" name="test_configuration_context_manager" time="0.003"><properties><property name="test_order" value="745" /></properties></testcase><testcase classname="tests.test_context_configuration.TestConfigurationContext" name="test_get_default_context" time="0.003"><properties><property name="test_order" value="746" /></properties></testcase><testcase classname="tests.test_context_configuration.TestConfigurationContext" name="test_set_default_context" time="0.002"><properties><property name="test_order" value="747" /></properties></testcase><testcase classname="tests.test_context_configuration.TestConfigurationContext" name="test_get_current_ai_settings" time="0.005"><properties><property name="test_order" value="748" /></properties></testcase><testcase classname="tests.test_context_configuration.TestConfigurationContext" name="test_get_current_environment_provider" time="0.004"><properties><property name="test_order" value="749" /></properties></testcase><testcase classname="tests.test_context_configuration.TestConfigurationContext" name="test_get_current_config_manager" time="0.003"><properties><property name="test_order" value="750" /></properties></testcase><testcase classname="tests.test_context_metrics.TestMetricsContext" name="test_metrics_context_creation" time="0.002"><properties><property name="test_order" value="751" /></properties></testcase><testcase classname="tests.test_context_metrics.TestMetricsContext" name="test_metrics_context_manager" time="0.003"><properties><property name="test_order" value="752" /></properties></testcase><testcase classname="tests.test_context_metrics.TestMetricsContext" name="test_get_default_metrics_context" time="0.003"><properties><property name="test_order" value="753" /></properties></testcase><testcase classname="tests.test_context_metrics.TestMetricsContext" name="test_set_default_metrics_context" time="0.003"><properties><property name="test_order" value="754" /></properties></testcase><testcase classname="tests.test_context_metrics.TestMetricsContext" name="test_increment_metric" time="0.003"><properties><property name="test_order" value="755" /></properties></testcase><testcase classname="tests.test_context_metrics.TestMetricsContext" name="test_gauge_metric" time="0.003"><properties><property name="test_order" value="756" /></properties></testcase><testcase classname="tests.test_context_metrics.TestMetricsContext" name="test_histogram_metric" time="0.003"><properties><property name="test_order" value="757" /></properties></testcase><testcase classname="tests.test_context_metrics.TestMetricsContext" name="test_timer_metric" time="0.002"><properties><property name="test_order" value="758" /></properties></testcase><testcase classname="tests.test_context_metrics.TestMetricsContext" name="test_get_metric" time="0.002"><properties><property name="test_order" value="759" /></properties></testcase><testcase classname="tests.test_context_metrics.TestMetricsContext" name="test_get_all_metrics" time="0.003"><properties><property name="test_order" value="760" /></properties></testcase><testcase classname="tests.test_coverage_improvements.TestCoverageImprovements" name="test_uploaded_file_str_and_repr" time="0.004"><properties><property name="test_order" value="761" /></properties></testcase><testcase classname="tests.test_coverage_improvements.TestCoverageImprovements" name="test_uploaded_file_datetime_serializer_none" time="0.003"><properties><property name="test_order" value="762" /></properties></testcase><testcase classname="tests.test_coverage_improvements.TestCoverageImprovements" name="test_provider_capabilities_openai_compatible" time="0.002"><properties><property name="test_order" value="763" /></properties></testcase><testcase classname="tests.test_coverage_improvements.TestCoverageImprovements" name="test_provider_capabilities_openai" time="0.002"><properties><property name="test_order" value="764" /></properties></testcase><testcase classname="tests.test_coverage_improvements.TestCoverageImprovements" name="test_exception_constructors_with_logging" time="0.004"><properties><property name="test_order" value="765" /></properties></testcase><testcase classname="tests.test_coverage_improvements.TestCoverageImprovements" name="test_openai_client_methods" time="0.003"><properties><property name="test_order" value="766" /></properties></testcase><testcase classname="tests.test_coverage_improvements.TestVersionImportFallback" name="test_version_fallback_on_import_error" time="0.005"><properties><property name="test_order" value="767" /></properties></testcase><testcase classname="tests.test_coverage_improvements.TestVersionImportFallback" name="test_version_normal_import" time="0.004"><properties><property name="test_order" value="768" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_dashboard_initialization" time="0.003"><properties><property name="test_order" value="769" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_load_env_file" time="0.007"><properties><property name="test_order" value="770" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_load_env_file_missing" time="0.003"><properties><property name="test_order" value="771" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_parse_pytest_output_success" time="0.005"><properties><property name="test_order" value="772" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_parse_pytest_output_with_failures" time="0.003"><properties><property name="test_order" value="773" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_parse_pytest_output_empty" time="0.003"><properties><property name="test_order" value="774" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_parse_pytest_output_non_string" time="0.002"><properties><property name="test_order" value="775" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_run_test_suite_success" time="0.022"><properties><property name="test_order" value="776" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_run_test_suite_with_failures" time="0.004"><properties><property name="test_order" value="777" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_run_test_suite_error" time="0.003"><properties><property name="test_order" value="778" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_generate_module_support_matrix" time="0.004"><properties><property name="test_order" value="779" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_dashboard_with_api_key" time="0.010"><properties><property name="test_order" value="780" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_dashboard_without_api_key" time="0.008"><properties><property name="test_order" value="781" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_full_suite_mode" time="0.009"><properties><property name="test_order" value="782" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboard" name="test_files_api_focus_mode" time="0.006"><properties><property name="test_order" value="783" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboardIntegration" name="test_dashboard_detects_missing_tests" time="0.003"><properties><property name="test_order" value="784" /></properties></testcase><testcase classname="tests.test_dashboard.TestTestDashboardIntegration" name="test_dashboard_counts_are_accurate" time="0.002"><properties><property name="test_order" value="785" /></properties></testcase><testcase classname="tests.test_di_configuration.TestConfigurationContext" name="test_configuration_context_basic" time="0.005"><properties><property name="test_order" value="786" /></properties></testcase><testcase classname="tests.test_di_configuration.TestConfigurationContext" name="test_configuration_context_with_ai_settings" time="0.005"><properties><property name="test_order" value="787" /></properties></testcase><testcase classname="tests.test_di_configuration.TestConfigurationContext" name="test_configuration_context_additional_config" time="0.003"><properties><property name="test_order" value="788" /></properties></testcase><testcase classname="tests.test_di_configuration.TestConfigurationContext" name="test_configuration_context_nesting" time="0.007"><properties><property name="test_order" value="789" /></properties></testcase><testcase classname="tests.test_di_configuration.TestConfigurationContext" name="test_configuration_context_require_current" time="0.003"><properties><property name="test_order" value="790" /></properties></testcase><testcase classname="tests.test_di_configuration.TestConfigurationContext" name="test_default_context_management" time="0.003"><properties><property name="test_order" value="791" /></properties></testcase><testcase classname="tests.test_di_configuration.TestConfigurationContext" name="test_configuration_context_function" time="0.006"><properties><property name="test_order" value="792" /></properties></testcase><testcase classname="tests.test_di_configuration.TestConfigurationContext" name="test_backward_compatibility_functions" time="0.008"><properties><property name="test_order" value="793" /></properties></testcase><testcase classname="tests.test_di_configuration.TestConfigurationContextIntegration" name="test_context_with_ai_settings_integration" time="0.008"><properties><property name="test_order" value="794" /></properties></testcase><testcase classname="tests.test_di_configuration.TestConfigurationContextIntegration" name="test_context_caching_behavior" time="0.008"><properties><property name="test_order" value="795" /></properties></testcase><testcase classname="tests.test_di_configuration.TestConfigurationContextIntegration" name="test_context_thread_safety" time="0.111"><properties><property name="test_order" value="796" /></properties></testcase><testcase classname="tests.test_di_configuration.TestConfigurationContextIntegration" name="test_context_error_handling" time="0.003"><properties><property name="test_order" value="797" /></properties></testcase><testcase classname="tests.test_di_environment.TestEnvironmentProviderImplementation" name="test_context_var_provider_basic" time="0.002"><properties><property name="test_order" value="798" /></properties></testcase><testcase classname="tests.test_di_environment.TestEnvironmentProviderImplementation" name="test_context_var_provider_with_overrides" time="0.002"><properties><property name="test_order" value="799" /></properties></testcase><testcase classname="tests.test_di_environment.TestEnvironmentProviderImplementation" name="test_context_var_provider_warning" time="0.003"><properties><property name="test_order" value="800" /></properties></testcase><testcase classname="tests.test_di_environment.TestEnvironmentProviderImplementation" name="test_standard_provider" time="0.003"><properties><property name="test_order" value="801" /></properties></testcase><testcase classname="tests.test_di_environment.TestEnvironmentProviderImplementation" name="test_standard_provider_with_prefix" time="0.003"><properties><property name="test_order" value="802" /></properties></testcase><testcase classname="tests.test_di_environment.TestEnvironmentProviderImplementation" name="test_test_provider" time="0.003"><properties><property name="test_order" value="803" /></properties></testcase><testcase classname="tests.test_di_environment.TestEnvironmentProviderImplementation" name="test_default_provider_management" time="0.003"><properties><property name="test_order" value="804" /></properties></testcase><testcase classname="tests.test_di_environment.TestEnvironmentProviderImplementation" name="test_provider_not_implemented_methods" time="0.003"><properties><property name="test_order" value="805" /></properties></testcase><testcase classname="tests.test_di_environment.TestEnvironmentProviderIntegration" name="test_context_var_provider_respects_overrides" time="0.003"><properties><property name="test_order" value="806" /></properties></testcase><testcase classname="tests.test_di_environment.TestEnvironmentProviderIntegration" name="test_provider_isolation" time="0.003"><properties><property name="test_order" value="807" /></properties></testcase><testcase classname="tests.test_di_environment.TestEnvironmentProviderIntegration" name="test_provider_thread_safety" time="0.156"><properties><property name="test_order" value="808" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContext" name="test_metrics_context_basic" time="0.003"><properties><property name="test_order" value="809" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContext" name="test_metrics_context_timer" time="0.015"><properties><property name="test_order" value="810" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContext" name="test_metrics_context_nesting" time="0.003"><properties><property name="test_order" value="811" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContext" name="test_metrics_context_require_current" time="0.003"><properties><property name="test_order" value="812" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContext" name="test_metrics_context_reset" time="0.003"><properties><property name="test_order" value="813" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContext" name="test_default_metrics_context_management" time="0.002"><properties><property name="test_order" value="814" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContext" name="test_metrics_context_function" time="0.003"><properties><property name="test_order" value="815" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContext" name="test_metrics_context_with_custom_registry" time="0.003"><properties><property name="test_order" value="816" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContextBackwardCompatibility" name="test_backward_compatibility_functions" time="0.015"><properties><property name="test_order" value="817" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContextBackwardCompatibility" name="test_backward_compatibility_with_context" time="0.003"><properties><property name="test_order" value="818" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContextIntegration" name="test_context_isolation" time="0.003"><properties><property name="test_order" value="819" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContextIntegration" name="test_context_thread_safety" time="0.016"><properties><property name="test_order" value="820" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContextIntegration" name="test_context_error_handling" time="0.003"><properties><property name="test_order" value="821" /></properties></testcase><testcase classname="tests.test_di_metrics.TestMetricsContextIntegration" name="test_complex_metrics_workflow" time="0.015"><properties><property name="test_order" value="822" /></properties></testcase><testcase classname="tests.test_dotenv_isolation.TestDotenvIsolation" name="test_ai_settings_does_not_load_dotenv_implicitly" time="0.008"><properties><property name="test_order" value="823" /></properties></testcase><testcase classname="tests.test_dotenv_isolation.TestDotenvIsolation" name="test_ai_settings_from_dotenv_loads_dotenv" time="0.011"><properties><property name="test_order" value="824" /></properties></testcase><testcase classname="tests.test_dotenv_isolation.TestDotenvIsolation" name="test_ai_client_auto_loads_dotenv_outside_pytest" time="0.012"><properties><property name="test_order" value="825" /></properties></testcase><testcase classname="tests.test_dotenv_isolation.TestDotenvIsolation" name="test_ai_client_does_not_load_dotenv_under_pytest" time="0.006"><properties><property name="test_order" value="826" /></properties></testcase><testcase classname="tests.test_dotenv_isolation.TestDotenvIsolation" name="test_running_under_pytest_detection" time="0.002"><properties><property name="test_order" value="827" /></properties></testcase><testcase classname="tests.test_dotenv_isolation.TestProviderFactoryWrapping" name="test_missing_base_url_wrapped_as_provider_configuration_error" time="0.006"><properties><property name="test_order" value="828" /></properties></testcase><testcase classname="tests.test_dotenv_isolation.TestProviderFactoryWrapping" name="test_missing_api_key_for_openai_wrapped_correctly" time="0.006"><properties><property name="test_order" value="829" /></properties><failure message="ai_utilities.providers.provider_exceptions.ProviderConfigurationError: Provider 'openai' configuration error: API key is required">settings = AiSettings(provider='openai', api_key=None, openai_api_key=None, groq_api_key=None, together_api_key=None, openrouter_..., cache_sqlite_busy_timeout_ms=3000, cache_sqlite_max_entries=None, cache_sqlite_prune_batch=200, cache_namespace=None)
provider = None

    def create_provider(settings: "AiSettings", provider: Optional[BaseProvider] = None) -&gt; BaseProvider:
        """Create an AI provider based on settings.
    
        Args:
            settings: AI settings containing provider configuration
            provider: Optional explicit provider to use (overrides settings)
    
        Returns:
            Configured AI provider instance
    
        Raises:
            ProviderConfigurationError: If provider configuration is invalid
        """
        # If explicit provider is provided, use it
        if provider is not None:
            return provider
    
        # Check if settings is None
        if settings is None:
            raise ProviderConfigurationError("Settings cannot be None", "unknown")
    
        try:
&gt;           config = resolve_request_config(settings)

src/ai_utilities/providers/provider_factory.py:62: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/config_resolver.py:497: in resolve_request_config
    resolved_api_key = resolve_api_key(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

provider = 'openai', api_key = None, settings_api_key = None
settings = AiSettings(provider='openai', api_key=None, openai_api_key=None, groq_api_key=None, together_api_key=None, openrouter_..., cache_sqlite_busy_timeout_ms=3000, cache_sqlite_max_entries=None, cache_sqlite_prune_batch=200, cache_namespace=None)
env_vars = {'COMMAND_MODE': 'unix2003', 'COV_CORE_CONFIG': '/Users/steffenrasmussen/PycharmProjects/ai_utilities/.coveragerc', 'C...RE_DATAFILE': '/Users/steffenrasmussen/PycharmProjects/ai_utilities/.coverage', 'COV_CORE_SOURCE': 'ai_utilities', ...}

    def resolve_api_key(
        provider: str,
        api_key: Optional[str] = None,
        settings_api_key: Optional[str] = None,
        settings: Optional[Any] = None,
        env_vars: Optional[Dict[str, str]] = None
    ) -&gt; str:
        """Resolve API key using precedence rules.
    
        Args:
            provider: Resolved provider name
            api_key: Per-request API key override
            settings_api_key: Settings API_KEY (from AI_API_KEY)
            settings: AiSettings instance with vendor-specific keys
            env_vars: Environment variables dict
    
        Returns:
            Resolved API key
    
        Raises:
            MissingApiKeyError: If no API key is available for cloud providers
        """
        if env_vars is None:
            env_vars = {}
    
        # 1) Per-request API key wins
        if api_key:
            return api_key
    
        # 2) Settings API_KEY (AI_API_KEY override)
        if settings_api_key:
            return settings_api_key
    
        # 3) Vendor-specific key from settings
        if settings:
            vendor_key = _get_vendor_key_from_settings(provider, settings)
            if vendor_key:
                return vendor_key
    
        # 4) Vendor-specific key from environment
        vendor_key = _get_vendor_key_for_provider(provider, env_vars)
        if vendor_key:
            return vendor_key
    
        # 5) For local providers, allow fallback tokens
        if provider == "openai_compatible":
            return "dummy-key"
        if provider in ["ollama", "lmstudio", "text-generation-webui", "fastchat"]:
            fallbacks = {
                "ollama": "ollama",
                "lmstudio": "lm-studio",
                "text-generation-webui": "webui",
                "fastchat": "fastchat"
            }
            return fallbacks.get(provider, "not-required")
    
        # 6) Cloud providers must have API keys
        if provider == "openai":
&gt;           raise MissingApiKeyError("API key is required")
E           ai_utilities.config_resolver.MissingApiKeyError: API key is required

src/ai_utilities/config_resolver.py:275: MissingApiKeyError

During handling of the above exception, another exception occurred:

self = &lt;tests.test_dotenv_isolation.TestProviderFactoryWrapping object at 0x10c822280&gt;, monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10dbaecd0&gt;

    def test_missing_api_key_for_openai_wrapped_correctly(self, monkeypatch):
        """Test that OpenAI provider creation succeeds with api_key=None (actual behavior)."""
        # Clear environment variables to ensure test isolation
        monkeypatch.delenv("OPENAI_API_KEY", raising=False)
        monkeypatch.delenv("AI_API_KEY", raising=False)
    
        settings = AiSettings(provider="openai", api_key=None, _env_file=None)
    
        # OpenAI provider creation should succeed even with api_key=None
        # API key validation likely happens during actual API calls, not provider creation
&gt;       provider = create_provider(settings)

tests/test_dotenv_isolation.py:167: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

settings = AiSettings(provider='openai', api_key=None, openai_api_key=None, groq_api_key=None, together_api_key=None, openrouter_..., cache_sqlite_busy_timeout_ms=3000, cache_sqlite_max_entries=None, cache_sqlite_prune_batch=200, cache_namespace=None)
provider = None

    def create_provider(settings: "AiSettings", provider: Optional[BaseProvider] = None) -&gt; BaseProvider:
        """Create an AI provider based on settings.
    
        Args:
            settings: AI settings containing provider configuration
            provider: Optional explicit provider to use (overrides settings)
    
        Returns:
            Configured AI provider instance
    
        Raises:
            ProviderConfigurationError: If provider configuration is invalid
        """
        # If explicit provider is provided, use it
        if provider is not None:
            return provider
    
        # Check if settings is None
        if settings is None:
            raise ProviderConfigurationError("Settings cannot be None", "unknown")
    
        try:
            config = resolve_request_config(settings)
    
            # Create provider based on resolved provider
            if config.provider == "openai":
                # Lazy import to avoid dependency issues
                try:
                    from .openai_provider import OpenAIProvider
                except ImportError as e:
                    raise MissingOptionalDependencyError(
                        "OpenAI provider requires extra 'openai'. Install with: pip install ai-utilities[openai]"
                    ) from e
                return OpenAIProvider(settings)
    
            elif config.provider in ["groq", "together", "openrouter"]:
                # These are all OpenAI-compatible with different base URLs
                return OpenAICompatibleProvider(
                    api_key=config.api_key,
                    base_url=config.base_url,
                    timeout=int(config.timeout or 30),
                    extra_headers=settings.extra_headers,
                    model=getattr(settings, 'model', None),
                )
    
            elif config.provider in ["ollama", "lmstudio", "text-generation-webui", "fastchat", "openai_compatible"]:
                # Local providers
                return OpenAICompatibleProvider(
                    api_key=config.api_key,
                    base_url=config.base_url,
                    timeout=int(config.timeout or 30),
                    extra_headers=settings.extra_headers,
                    model=getattr(settings, 'model', None),
                )
    
            else:
                raise ProviderConfigurationError(
                    f"Unknown provider: {config.provider}",
                    config.provider
                )
    
        except MissingBaseUrlError as e:
            raise ProviderConfigurationError(str(e), getattr(settings, "provider", "unknown"))
        except MissingApiKeyError as e:
            provider_name = getattr(settings, "provider", "unknown") or "unknown"
            if provider_name == "openai":
&gt;               raise ProviderConfigurationError("API key is required", "openai")
E               ai_utilities.providers.provider_exceptions.ProviderConfigurationError: Provider 'openai' configuration error: API key is required

src/ai_utilities/providers/provider_factory.py:106: ProviderConfigurationError</failure></testcase><testcase classname="tests.test_dotenv_isolation.TestProviderFactoryWrapping" name="test_unknown_provider_wrapped_as_provider_configuration_error" time="0.008"><properties><property name="test_order" value="830" /></properties></testcase><testcase classname="tests.test_env_detection.TestInteractiveEnvironment" name="test_interactive_environment_default_true" time="0.003"><properties><property name="test_order" value="831" /></properties></testcase><testcase classname="tests.test_env_detection.TestInteractiveEnvironment" name="test_ci_environment_not_interactive" time="0.003"><properties><property name="test_order" value="832" /></properties></testcase><testcase classname="tests.test_env_detection.TestInteractiveEnvironment" name="test_pytest_environment_not_interactive" time="0.003"><properties><property name="test_order" value="833" /></properties></testcase><testcase classname="tests.test_env_detection.TestInteractiveEnvironment" name="test_pytest_module_not_interactive" time="0.004"><properties><property name="test_order" value="834" /></properties></testcase><testcase classname="tests.test_env_detection.TestInteractiveEnvironment" name="test_non_tty_not_interactive" time="0.003"><properties><property name="test_order" value="835" /></properties></testcase><testcase classname="tests.test_env_detection.TestInteractiveEnvironment" name="test_nologin_shell_not_interactive" time="0.003"><properties><property name="test_order" value="836" /></properties></testcase><testcase classname="tests.test_env_detection.TestInteractiveEnvironment" name="test_false_shell_not_interactive" time="0.003"><properties><property name="test_order" value="837" /></properties></testcase><testcase classname="tests.test_env_detection.TestInteractiveEnvironment" name="test_docker_container_not_interactive" time="0.003"><properties><property name="test_order" value="838" /></properties></testcase><testcase classname="tests.test_env_detection.TestInteractiveEnvironment" name="test_systemd_not_interactive" time="0.003"><properties><property name="test_order" value="839" /></properties></testcase><testcase classname="tests.test_env_detection.TestInteractiveEnvironment" name="test_daemon_process_not_interactive" time="0.003"><properties><property name="test_order" value="840" /></properties></testcase><testcase classname="tests.test_env_detection.TestCIEnvironment" name="test_no_ci_indicators" time="0.003"><properties><property name="test_order" value="841" /></properties></testcase><testcase classname="tests.test_env_detection.TestCIEnvironment" name="test_generic_ci_detected" time="0.003"><properties><property name="test_order" value="842" /></properties></testcase><testcase classname="tests.test_env_detection.TestCIEnvironment" name="test_github_actions_detected" time="0.003"><properties><property name="test_order" value="843" /></properties></testcase><testcase classname="tests.test_env_detection.TestCIEnvironment" name="test_gitlab_ci_detected" time="0.003"><properties><property name="test_order" value="844" /></properties></testcase><testcase classname="tests.test_env_detection.TestCIEnvironment" name="test_all_ci_indicators" time="0.005"><properties><property name="test_order" value="845" /></properties></testcase><testcase classname="tests.test_env_detection.TestDevelopmentEnvironment" name="test_no_dev_indicators" time="0.003"><properties><property name="test_order" value="846" /></properties></testcase><testcase classname="tests.test_env_detection.TestDevelopmentEnvironment" name="test_virtual_env_detected" time="0.003"><properties><property name="test_order" value="847" /></properties></testcase><testcase classname="tests.test_env_detection.TestDevelopmentEnvironment" name="test_conda_env_detected" time="0.003"><properties><property name="test_order" value="848" /></properties></testcase><testcase classname="tests.test_env_detection.TestDevelopmentEnvironment" name="test_pycharm_detected" time="0.003"><properties><property name="test_order" value="849" /></properties></testcase><testcase classname="tests.test_env_detection.TestDevelopmentEnvironment" name="test_vscode_detected" time="0.003"><properties><property name="test_order" value="850" /></properties></testcase><testcase classname="tests.test_env_detection.TestDevelopmentEnvironment" name="test_ipython_detected" time="0.003"><properties><property name="test_order" value="851" /></properties></testcase><testcase classname="tests.test_env_detection.TestEnvironmentType" name="test_ci_environment_type" time="0.003"><properties><property name="test_order" value="852" /></properties></testcase><testcase classname="tests.test_env_detection.TestEnvironmentType" name="test_non_interactive_environment_type" time="0.003"><properties><property name="test_order" value="853" /></properties></testcase><testcase classname="tests.test_env_detection.TestEnvironmentType" name="test_development_environment_type" time="0.004"><properties><property name="test_order" value="854" /></properties></testcase><testcase classname="tests.test_env_detection.TestEnvironmentType" name="test_interactive_environment_type" time="0.003"><properties><property name="test_order" value="855" /></properties></testcase><testcase classname="tests.test_env_detection.TestSafeInput" name="test_safe_input_non_interactive_returns_default" time="0.003"><properties><property name="test_order" value="856" /></properties></testcase><testcase classname="tests.test_env_detection.TestSafeInput" name="test_safe_input_interactive_gets_input" time="0.003"><properties><property name="test_order" value="857" /></properties></testcase><testcase classname="tests.test_env_detection.TestSafeInput" name="test_safe_input_eof_error_returns_default" time="0.004"><properties><property name="test_order" value="858" /></properties></testcase><testcase classname="tests.test_env_detection.TestSafeInput" name="test_safe_input_keyboard_interrupt_returns_default" time="0.003"><properties><property name="test_order" value="859" /></properties></testcase><testcase classname="tests.test_env_detection.TestSafeInput" name="test_safe_input_empty_default" time="0.003"><properties><property name="test_order" value="860" /></properties></testcase><testcase classname="tests.test_env_detection.TestShouldPromptForReconfigure" name="test_should_prompt_interactive_non_ci" time="0.004"><properties><property name="test_order" value="861" /></properties></testcase><testcase classname="tests.test_env_detection.TestShouldPromptForReconfigure" name="test_should_not_prompt_non_interactive" time="0.003"><properties><property name="test_order" value="862" /></properties></testcase><testcase classname="tests.test_env_detection.TestShouldPromptForReconfigure" name="test_should_not_prompt_ci" time="0.003"><properties><property name="test_order" value="863" /></properties></testcase><testcase classname="tests.test_env_detection.TestLogEnvironmentInfo" name="test_log_environment_info_ci" time="0.003"><properties><property name="test_order" value="864" /></properties></testcase><testcase classname="tests.test_env_detection.TestLogEnvironmentInfo" name="test_log_environment_info_development" time="0.004"><properties><property name="test_order" value="865" /></properties></testcase><testcase classname="tests.test_env_detection.TestLogEnvironmentInfo" name="test_log_environment_info_interactive" time="0.003"><properties><property name="test_order" value="866" /></properties></testcase><testcase classname="tests.test_env_detection.TestEdgeCases" name="test_empty_environment_variables" time="0.003"><properties><property name="test_order" value="867" /></properties></testcase><testcase classname="tests.test_env_detection.TestEdgeCases" name="test_whitespace_environment_variables" time="0.003"><properties><property name="test_order" value="868" /></properties></testcase><testcase classname="tests.test_env_detection.TestEdgeCases" name="test_missing_stdin_isatty" time="0.003"><properties><property name="test_order" value="869" /></properties></testcase><testcase classname="tests.test_env_detection.TestEdgeCases" name="test_environment_precedence" time="0.003"><properties><property name="test_order" value="870" /></properties></testcase><testcase classname="tests.test_env_overrides.TestEnvOverrides" name="test_get_env_overrides_default" time="0.003"><properties><property name="test_order" value="871" /></properties></testcase><testcase classname="tests.test_env_overrides.TestEnvOverrides" name="test_override_env_basic" time="0.003"><properties><property name="test_order" value="872" /></properties></testcase><testcase classname="tests.test_env_overrides.TestEnvOverrides" name="test_override_env_nested" time="0.003"><properties><property name="test_order" value="873" /></properties></testcase><testcase classname="tests.test_env_overrides.TestEnvOverrides" name="test_override_env_type_conversion" time="0.003"><properties><property name="test_order" value="874" /></properties></testcase><testcase classname="tests.test_env_overrides.TestEnvOverrides" name="test_override_env_exception_handling" time="0.003"><properties><property name="test_order" value="875" /></properties></testcase><testcase classname="tests.test_env_overrides.TestEnvOverrides" name="test_ai_settings_integration_behavior" time="0.008"><properties><property name="test_order" value="876" /></properties><failure message="AssertionError: assert 'gpt-3.5-turbo' == 'vicuna-7b-v1.5'&#10;  &#10;  #x1B[0m#x1B[91m- vicuna-7b-v1.5#x1B[39;49;00m#x1B[90m#x1B[39;49;00m&#10;  #x1B[92m+ gpt-3.5-turbo#x1B[39;49;00m#x1B[90m#x1B[39;49;00m">self = &lt;tests.test_env_overrides.TestEnvOverrides object at 0x10c86d8e0&gt;

    def test_ai_settings_integration_behavior(self):
        """Test AiSettings.settings_customise_sources behavior with overrides."""
        # Test that AiSettings properly integrates with override_env
        # This validates the settings_customise_sources behavior without testing internals
    
        # Test with no overrides - should use defaults
        settings = AiSettings()
&gt;       assert settings.model == 'vicuna-7b-v1.5'  # Actual default value
E       AssertionError: assert 'gpt-3.5-turbo' == 'vicuna-7b-v1.5'
E         
E         #x1B[0m#x1B[91m- vicuna-7b-v1.5#x1B[39;49;00m#x1B[90m#x1B[39;49;00m
E         #x1B[92m+ gpt-3.5-turbo#x1B[39;49;00m#x1B[90m#x1B[39;49;00m

tests/test_env_overrides.py:119: AssertionError</failure></testcase><testcase classname="tests.test_env_overrides.TestEnvOverrides" name="test_override_only_baseline" time="0.005"><properties><property name="test_order" value="877" /></properties></testcase><testcase classname="tests.test_env_overrides.TestEnvOverrides" name="test_task_inheritance_no_crosstalk" time="0.024"><properties><property name="test_order" value="878" /></properties></testcase><testcase classname="tests.test_env_overrides.TestEnvOverrides" name="test_ai_settings_integration" time="0.006"><properties><property name="test_order" value="879" /></properties><failure message="AssertionError: assert 'gpt-3.5-turbo' == 'vicuna-7b-v1.5'&#10;  &#10;  #x1B[0m#x1B[91m- vicuna-7b-v1.5#x1B[39;49;00m#x1B[90m#x1B[39;49;00m&#10;  #x1B[92m+ gpt-3.5-turbo#x1B[39;49;00m#x1B[90m#x1B[39;49;00m">self = &lt;tests.test_env_overrides.TestEnvOverrides object at 0x10c86d2e0&gt;, monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10d7d7100&gt;

    def test_ai_settings_integration(self, monkeypatch):
        """Test AiSettings integration with environment overrides."""
        # Don't set any environment variables - test default behavior first
        settings = AiSettings()
&gt;       assert settings.model == 'vicuna-7b-v1.5'  # Actual default value
E       AssertionError: assert 'gpt-3.5-turbo' == 'vicuna-7b-v1.5'
E         
E         #x1B[0m#x1B[91m- vicuna-7b-v1.5#x1B[39;49;00m#x1B[90m#x1B[39;49;00m
E         #x1B[92m+ gpt-3.5-turbo#x1B[39;49;00m#x1B[90m#x1B[39;49;00m

tests/test_env_overrides.py:194: AssertionError</failure></testcase><testcase classname="tests.test_env_overrides.TestEnvOverrides" name="test_ai_settings_precedence" time="0.008"><properties><property name="test_order" value="880" /></properties></testcase><testcase classname="tests.test_env_overrides.TestEnvOverrides" name="test_async_isolation" time="0.108"><properties><property name="test_order" value="881" /></properties></testcase><testcase classname="tests.test_env_overrides.TestEnvOverrides" name="test_thread_isolation" time="0.112"><properties><property name="test_order" value="882" /></properties></testcase><testcase classname="tests.test_env_overrides.TestEnvOverrides" name="test_no_os_environ_mutation" time="0.003"><properties><property name="test_order" value="883" /></properties></testcase><testcase classname="tests.test_env_utils.TestCleanupAiEnvVars" name="test_cleanup_ai_env_vars_removes_ai_variables" time="0.003"><properties><property name="test_order" value="884" /></properties></testcase><testcase classname="tests.test_env_utils.TestCleanupAiEnvVars" name="test_cleanup_ai_env_vars_with_no_ai_variables" time="0.002"><properties><property name="test_order" value="885" /></properties></testcase><testcase classname="tests.test_env_utils.TestCleanupAiEnvVars" name="test_cleanup_ai_env_vars_with_empty_values" time="0.003"><properties><property name="test_order" value="886" /></properties></testcase><testcase classname="tests.test_env_utils.TestGetAiEnvVars" name="test_get_ai_env_vars_returns_only_ai_variables" time="0.002"><properties><property name="test_order" value="887" /></properties></testcase><testcase classname="tests.test_env_utils.TestGetAiEnvVars" name="test_get_ai_env_vars_with_no_ai_variables" time="0.003"><properties><property name="test_order" value="888" /></properties></testcase><testcase classname="tests.test_env_utils.TestGetAiEnvVars" name="test_get_ai_env_vars_with_case_sensitivity" time="0.003"><properties><property name="test_order" value="889" /></properties></testcase><testcase classname="tests.test_env_utils.TestValidateAiEnvVars" name="test_validate_ai_env_vars_filters_known_variables" time="0.003"><properties><property name="test_order" value="890" /></properties></testcase><testcase classname="tests.test_env_utils.TestValidateAiEnvVars" name="test_validate_ai_env_vars_with_all_known_variables" time="0.003"><properties><property name="test_order" value="891" /></properties></testcase><testcase classname="tests.test_env_utils.TestValidateAiEnvVars" name="test_validate_ai_env_vars_with_no_known_variables" time="0.003"><properties><property name="test_order" value="892" /></properties></testcase><testcase classname="tests.test_env_utils.TestIsolatedEnvContext" name="test_isolated_env_context_sets_and_restores_variables" time="0.002"><properties><property name="test_order" value="893" /></properties></testcase><testcase classname="tests.test_env_utils.TestIsolatedEnvContext" name="test_isolated_env_context_with_no_variables" time="0.003"><properties><property name="test_order" value="894" /></properties></testcase><testcase classname="tests.test_env_utils.TestIsolatedEnvContext" name="test_isolated_env_context_with_empty_dict" time="0.002"><properties><property name="test_order" value="895" /></properties></testcase><testcase classname="tests.test_env_utils.TestIsolatedEnvContext" name="test_isolated_env_context_restores_on_exception" time="0.002"><properties><property name="test_order" value="896" /></properties></testcase><testcase classname="tests.test_env_utils.TestIsolatedEnvContext" name="test_isolated_env_context_nested" time="0.003"><properties><property name="test_order" value="897" /></properties></testcase><testcase classname="tests.test_env_utils.TestIntegration" name="test_cleanup_and_get_interaction" time="0.003"><properties><property name="test_order" value="898" /></properties></testcase><testcase classname="tests.test_env_utils.TestIntegration" name="test_validate_and_isolated_context_interaction" time="0.003"><properties><property name="test_order" value="899" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_ci_environment_detection[CI]" time="0.003"><properties><property name="test_order" value="900" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_ci_environment_detection[CONTINUOUS_INTEGRATION]" time="0.003"><properties><property name="test_order" value="901" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_ci_environment_detection[GITHUB_ACTIONS]" time="0.050"><properties><property name="test_order" value="902" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_ci_environment_detection[GITLAB_CI]" time="0.003"><properties><property name="test_order" value="903" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_ci_environment_detection[TRAVIS]" time="0.003"><properties><property name="test_order" value="904" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_ci_environment_detection[CIRCLECI]" time="0.003"><properties><property name="test_order" value="905" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_ci_environment_detection[JENKINS_URL]" time="0.003"><properties><property name="test_order" value="906" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_ci_environment_detection[AZURE_PIPELINES]" time="0.003"><properties><property name="test_order" value="907" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_ci_environment_detection[BITBUCKET_BUILD_NUMBER]" time="0.003"><properties><property name="test_order" value="908" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_ci_environment_detection[APPVEYOR]" time="0.003"><properties><property name="test_order" value="909" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_ci_environment_detection[CODEBUILD_BUILD_ID]" time="0.003"><properties><property name="test_order" value="910" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_ci_environment_detection[GOOGLE_CLOUD_PROJECT]" time="0.003"><properties><property name="test_order" value="911" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_ci_environment_detection[BUILDKITE]" time="0.003"><properties><property name="test_order" value="912" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_no_ci_environment" time="0.003"><properties><property name="test_order" value="913" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_development_environment_detection[VIRTUAL_ENV]" time="0.003"><properties><property name="test_order" value="914" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_development_environment_detection[CONDA_DEFAULT_ENV]" time="0.003"><properties><property name="test_order" value="915" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_development_environment_detection[PYCHARM_HOSTED]" time="0.003"><properties><property name="test_order" value="916" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_development_environment_detection[VSCODE_PID]" time="0.003"><properties><property name="test_order" value="917" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_development_environment_detection[IPython]" time="0.003"><properties><property name="test_order" value="918" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_no_development_environment" time="0.003"><properties><property name="test_order" value="919" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_pytest_environment_detection" time="0.003"><properties><property name="test_order" value="920" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_pytest_in_sys_modules" time="0.003"><properties><property name="test_order" value="921" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_tty_detection" time="0.004"><properties><property name="test_order" value="922" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_non_interactive_shell_detection[/bin/nologin]" time="0.003"><properties><property name="test_order" value="923" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_non_interactive_shell_detection[/usr/bin/false]" time="0.003"><properties><property name="test_order" value="924" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_non_interactive_shell_detection[/sbin/nologin]" time="0.003"><properties><property name="test_order" value="925" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_interactive_shell_detection" time="0.004"><properties><property name="test_order" value="926" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_docker_environment_detection" time="0.003"><properties><property name="test_order" value="927" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_systemd_environment_detection" time="0.003"><properties><property name="test_order" value="928" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentDetection" name="test_daemon_process_detection" time="0.003"><properties><property name="test_order" value="929" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentType" name="test_ci_environment_type" time="0.003"><properties><property name="test_order" value="930" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentType" name="test_non_interactive_environment_type" time="0.003"><properties><property name="test_order" value="931" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentType" name="test_development_environment_type" time="0.003"><properties><property name="test_order" value="932" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvironmentType" name="test_interactive_environment_type" time="0.003"><properties><property name="test_order" value="933" /></properties></testcase><testcase classname="tests.test_environment_modules.TestSafeInput" name="test_safe_input_in_non_interactive" time="0.003"><properties><property name="test_order" value="934" /></properties></testcase><testcase classname="tests.test_environment_modules.TestSafeInput" name="test_safe_input_success" time="0.003"><properties><property name="test_order" value="935" /></properties></testcase><testcase classname="tests.test_environment_modules.TestSafeInput" name="test_safe_input_eof_error" time="0.003"><properties><property name="test_order" value="936" /></properties></testcase><testcase classname="tests.test_environment_modules.TestSafeInput" name="test_safe_input_keyboard_interrupt" time="0.003"><properties><property name="test_order" value="937" /></properties></testcase><testcase classname="tests.test_environment_modules.TestSafeInput" name="test_safe_input_empty_default" time="0.004"><properties><property name="test_order" value="938" /></properties></testcase><testcase classname="tests.test_environment_modules.TestReconfigurePrompting" name="test_should_prompt_in_interactive" time="0.003"><properties><property name="test_order" value="939" /></properties></testcase><testcase classname="tests.test_environment_modules.TestReconfigurePrompting" name="test_should_not_prompt_in_ci" time="0.003"><properties><property name="test_order" value="940" /></properties></testcase><testcase classname="tests.test_environment_modules.TestReconfigurePrompting" name="test_should_not_prompt_in_non_interactive" time="0.003"><properties><property name="test_order" value="941" /></properties></testcase><testcase classname="tests.test_environment_modules.TestLogEnvironmentInfo" name="test_log_environment_info_ci" time="0.003"><properties><property name="test_order" value="942" /></properties></testcase><testcase classname="tests.test_environment_modules.TestLogEnvironmentInfo" name="test_log_environment_info_development" time="0.003"><properties><property name="test_order" value="943" /></properties></testcase><testcase classname="tests.test_environment_modules.TestLogEnvironmentInfo" name="test_log_environment_info_non_interactive" time="0.003"><properties><property name="test_order" value="944" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvOverrides" name="test_get_env_overrides_empty" time="0.003"><properties><property name="test_order" value="945" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvOverrides" name="test_override_env_context_manager" time="0.003"><properties><property name="test_order" value="946" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvOverrides" name="test_override_env_with_none" time="0.003"><properties><property name="test_order" value="947" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvOverrides" name="test_override_env_type_conversion" time="0.002"><properties><property name="test_order" value="948" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvOverrides" name="test_override_env_nested_contexts" time="0.003"><properties><property name="test_order" value="949" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEnvOverrides" name="test_override_env_exception_handling" time="0.002"><properties><property name="test_order" value="950" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_init_default_prefix" time="0.002"><properties><property name="test_order" value="951" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_init_custom_prefix" time="0.003"><properties><property name="test_order" value="952" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_get_with_override" time="0.003"><properties><property name="test_order" value="953" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_get_without_override" time="0.003"><properties><property name="test_order" value="954" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_get_override_takes_precedence" time="0.003"><properties><property name="test_order" value="955" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_get_not_found" time="0.003"><properties><property name="test_order" value="956" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_get_bool_true_values" time="0.003"><properties><property name="test_order" value="957" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_get_bool_false_values" time="0.003"><properties><property name="test_order" value="958" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_get_bool_not_found" time="0.003"><properties><property name="test_order" value="959" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_get_int_success" time="0.002"><properties><property name="test_order" value="960" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_get_int_not_found" time="0.004"><properties><property name="test_order" value="961" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_get_int_invalid_value" time="0.003"><properties><property name="test_order" value="962" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_get_float_success" time="0.002"><properties><property name="test_order" value="963" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_get_float_not_found" time="0.003"><properties><property name="test_order" value="964" /></properties></testcase><testcase classname="tests.test_environment_modules.TestOverrideAwareEnvSource" name="test_get_float_invalid_value" time="0.003"><properties><property name="test_order" value="965" /></properties></testcase><testcase classname="tests.test_environment_modules.TestGlobalAIEnvFunctions" name="test_get_ai_env_with_override" time="0.002"><properties><property name="test_order" value="966" /></properties></testcase><testcase classname="tests.test_environment_modules.TestGlobalAIEnvFunctions" name="test_get_ai_env_without_override" time="0.003"><properties><property name="test_order" value="967" /></properties></testcase><testcase classname="tests.test_environment_modules.TestGlobalAIEnvFunctions" name="test_get_ai_env_bool" time="0.003"><properties><property name="test_order" value="968" /></properties></testcase><testcase classname="tests.test_environment_modules.TestGlobalAIEnvFunctions" name="test_get_ai_env_int" time="0.003"><properties><property name="test_order" value="969" /></properties></testcase><testcase classname="tests.test_environment_modules.TestGlobalAIEnvFunctions" name="test_get_ai_env_float" time="0.002"><properties><property name="test_order" value="970" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEdgeCases" name="test_override_env_empty_dict" time="0.002"><properties><property name="test_order" value="971" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEdgeCases" name="test_multiple_overrides_same_key" time="0.003"><properties><property name="test_order" value="972" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEdgeCases" name="test_environment_variable_case_sensitivity" time="0.004"><properties><property name="test_order" value="973" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEdgeCases" name="test_context_isolation" time="0.002"><properties><property name="test_order" value="974" /></properties></testcase><testcase classname="tests.test_environment_modules.TestEdgeCases" name="test_large_override_dict" time="0.003"><properties><property name="test_order" value="975" /></properties></testcase><testcase classname="tests.test_error_codes.TestErrorCodeEnum" name="test_error_code_values" time="0.002"><properties><property name="test_order" value="976" /></properties></testcase><testcase classname="tests.test_error_codes.TestErrorCodeEnum" name="test_legacy_error_codes" time="0.003"><properties><property name="test_order" value="977" /></properties></testcase><testcase classname="tests.test_error_codes.TestErrorCodeEnum" name="test_error_code_categories" time="0.003"><properties><property name="test_order" value="978" /></properties></testcase><testcase classname="tests.test_error_codes.TestErrorCodeEnum" name="test_error_code_uniqueness" time="0.003"><properties><property name="test_order" value="979" /></properties></testcase><testcase classname="tests.test_error_codes.TestErrorInfo" name="test_error_info_initialization" time="0.003"><properties><property name="test_order" value="980" /></properties></testcase><testcase classname="tests.test_error_codes.TestErrorInfo" name="test_error_info_defaults" time="0.003"><properties><property name="test_order" value="981" /></properties></testcase><testcase classname="tests.test_error_codes.TestErrorInfo" name="test_error_info_to_dict" time="0.002"><properties><property name="test_order" value="982" /></properties></testcase><testcase classname="tests.test_error_codes.TestAIUtilitiesError" name="test_basic_initialization" time="0.002"><properties><property name="test_order" value="983" /></properties></testcase><testcase classname="tests.test_error_codes.TestAIUtilitiesError" name="test_full_initialization" time="0.002"><properties><property name="test_order" value="984" /></properties></testcase><testcase classname="tests.test_error_codes.TestAIUtilitiesError" name="test_to_dict" time="0.003"><properties><property name="test_order" value="985" /></properties></testcase><testcase classname="tests.test_error_codes.TestAIUtilitiesError" name="test_inheritance" time="0.002"><properties><property name="test_order" value="986" /></properties></testcase><testcase classname="tests.test_error_codes.TestSpecializedExceptions" name="test_configuration_error" time="0.003"><properties><property name="test_order" value="987" /></properties></testcase><testcase classname="tests.test_error_codes.TestSpecializedExceptions" name="test_configuration_error_custom_code" time="0.003"><properties><property name="test_order" value="988" /></properties></testcase><testcase classname="tests.test_error_codes.TestSpecializedExceptions" name="test_provider_error" time="0.003"><properties><property name="test_order" value="989" /></properties></testcase><testcase classname="tests.test_error_codes.TestSpecializedExceptions" name="test_cache_error" time="0.002"><properties><property name="test_order" value="990" /></properties></testcase><testcase classname="tests.test_error_codes.TestSpecializedExceptions" name="test_file_error" time="0.002"><properties><property name="test_order" value="991" /></properties></testcase><testcase classname="tests.test_error_codes.TestSpecializedExceptions" name="test_usage_error" time="0.002"><properties><property name="test_order" value="992" /></properties></testcase><testcase classname="tests.test_error_codes.TestSpecializedExceptions" name="test_json_parse_error" time="0.003"><properties><property name="test_order" value="993" /></properties></testcase><testcase classname="tests.test_error_codes.TestErrorCodeMapping" name="test_mapping_completeness" time="0.002"><properties><property name="test_order" value="994" /></properties></testcase><testcase classname="tests.test_error_codes.TestErrorCodeMapping" name="test_mapping_values" time="0.003"><properties><property name="test_order" value="995" /></properties></testcase><testcase classname="tests.test_error_codes.TestErrorCodeMapping" name="test_unknown_error_mapping" time="0.003"><properties><property name="test_order" value="996" /></properties></testcase><testcase classname="tests.test_error_codes.TestCreateError" name="test_create_configuration_error" time="0.003"><properties><property name="test_order" value="997" /></properties></testcase><testcase classname="tests.test_error_codes.TestCreateError" name="test_create_provider_error" time="0.002"><properties><property name="test_order" value="998" /></properties></testcase><testcase classname="tests.test_error_codes.TestCreateError" name="test_create_unknown_error" time="0.002"><properties><property name="test_order" value="999" /></properties></testcase><testcase classname="tests.test_error_codes.TestCreateError" name="test_create_error_with_all_params" time="0.002"><properties><property name="test_order" value="1000" /></properties></testcase><testcase classname="tests.test_error_codes.TestHandleProviderError" name="test_authentication_error" time="0.003"><properties><property name="test_order" value="1001" /></properties></testcase><testcase classname="tests.test_error_codes.TestHandleProviderError" name="test_rate_limit_error" time="0.050"><properties><property name="test_order" value="1002" /></properties></testcase><testcase classname="tests.test_error_codes.TestHandleProviderError" name="test_quota_error" time="0.003"><properties><property name="test_order" value="1003" /></properties></testcase><testcase classname="tests.test_error_codes.TestHandleProviderError" name="test_model_not_found_error" time="0.003"><properties><property name="test_order" value="1004" /></properties></testcase><testcase classname="tests.test_error_codes.TestHandleProviderError" name="test_timeout_error" time="0.003"><properties><property name="test_order" value="1005" /></properties></testcase><testcase classname="tests.test_error_codes.TestHandleProviderError" name="test_network_error" time="0.003"><properties><property name="test_order" value="1006" /></properties></testcase><testcase classname="tests.test_error_codes.TestHandleProviderError" name="test_server_error" time="0.002"><properties><property name="test_order" value="1007" /></properties></testcase><testcase classname="tests.test_error_codes.TestHandleProviderError" name="test_generic_error" time="0.003"><properties><property name="test_order" value="1008" /></properties></testcase><testcase classname="tests.test_error_codes.TestHandleProviderError" name="test_error_details" time="0.003"><properties><property name="test_order" value="1009" /></properties></testcase><testcase classname="tests.test_error_codes.TestGetErrorSeverity" name="test_critical_severity" time="0.003"><properties><property name="test_order" value="1010" /></properties></testcase><testcase classname="tests.test_error_codes.TestGetErrorSeverity" name="test_high_severity" time="0.002"><properties><property name="test_order" value="1011" /></properties></testcase><testcase classname="tests.test_error_codes.TestGetErrorSeverity" name="test_medium_severity" time="0.002"><properties><property name="test_order" value="1012" /></properties></testcase><testcase classname="tests.test_error_codes.TestGetErrorSeverity" name="test_low_severity" time="0.002"><properties><property name="test_order" value="1013" /></properties></testcase><testcase classname="tests.test_error_codes.TestLegacyConstants" name="test_legacy_constants_format" time="0.003"><properties><property name="test_order" value="1014" /></properties></testcase><testcase classname="tests.test_error_codes.TestLegacyConstants" name="test_legacy_constants_content" time="0.003"><properties><property name="test_order" value="1015" /></properties></testcase><testcase classname="tests.test_error_codes.TestEdgeCases" name="test_error_with_none_details" time="0.002"><properties><property name="test_order" value="1016" /></properties></testcase><testcase classname="tests.test_error_codes.TestEdgeCases" name="test_error_with_empty_details" time="0.003"><properties><property name="test_order" value="1017" /></properties></testcase><testcase classname="tests.test_error_codes.TestEdgeCases" name="test_error_with_complex_details" time="0.003"><properties><property name="test_order" value="1018" /></properties></testcase><testcase classname="tests.test_error_codes.TestEdgeCases" name="test_error_str_representation" time="0.002"><properties><property name="test_order" value="1019" /></properties></testcase><testcase classname="tests.test_error_codes.TestEdgeCases" name="test_error_repr" time="0.002"><properties><property name="test_order" value="1020" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestCoreExamples" name="test_getting_started_example" time="1.018"><properties><property name="test_order" value="1021" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestCoreExamples" name="test_files_quickstart_example" time="0.052"><properties><property name="test_order" value="1022" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestCoreExamples" name="test_audio_quickstart_example" time="0.009"><properties><property name="test_order" value="1023" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestCoreExamples" name="test_model_validation_example" time="0.004"><properties><property name="test_order" value="1024" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestCoreExamples" name="test_main_example" time="0.004"><properties><property name="test_order" value="1025" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestProviderExamples" name="test_provider_examples_import_and_structure[fastchat_example]" time="2.050"><properties><property name="test_order" value="1026" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestProviderExamples" name="test_provider_examples_import_and_structure[text_generation_webui_example]" time="2.055"><properties><property name="test_order" value="1027" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestProviderExamples" name="test_provider_examples_import_and_structure[environment_isolation_example]" time="0.032"><properties><property name="test_order" value="1028" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestFeatureExamples" name="test_feature_examples_import_and_structure[ask_parameters_demo]" time="0.011"><properties><property name="test_order" value="1029" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestFeatureExamples" name="test_feature_examples_import_and_structure[usage_tracking_example]" time="5.193"><properties><property name="test_order" value="1030" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestFeatureExamples" name="test_feature_examples_import_and_structure[simple_document_ai]" time="0.053"><properties><property name="test_order" value="1031" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestFeatureExamples" name="test_feature_examples_import_and_structure[audio_transcription_demo]" time="0.010"><properties><property name="test_order" value="1032" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestFeatureExamples" name="test_feature_examples_import_and_structure[document_ai_demo]" time="0.013"><properties><property name="test_order" value="1033" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestAdvancedExamples" name="test_setup_examples_import_and_structure[interactive_setup_example]" time="0.004"><properties><property name="test_order" value="1034" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestAdvancedExamples" name="test_setup_examples_import_and_structure[smart_setup_example]" time="0.004"><properties><property name="test_order" value="1035" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestAdvancedExamples" name="test_setup_examples_import_and_structure[setup_examples]" time="0.006"><properties><property name="test_order" value="1036" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestAdvancedExamples" name="test_generation_examples_import_and_structure[simple_image_generation]" time="0.131"><properties><property name="test_order" value="1037" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestAdvancedExamples" name="test_generation_examples_import_and_structure[audio_generation_demo]" time="0.007"><properties><property name="test_order" value="1038" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestAdvancedExamples" name="test_generation_examples_import_and_structure[image_generation_demo]" time="0.420"><properties><property name="test_order" value="1039" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestAdvancedExamples" name="test_workflow_examples_import_and_structure[files_demo]" time="0.192"><properties><property name="test_order" value="1040" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestAdvancedExamples" name="test_workflow_examples_import_and_structure[complete_content_workflow]" time="0.010"><properties><property name="test_order" value="1041" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestAdvancedExamples" name="test_workflow_examples_import_and_structure[knowledge_example]" time="0.019"><properties><property name="test_order" value="1042" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestAdvancedExamples" name="test_workflow_examples_import_and_structure[parallel_usage_tracking_example]" time="2.116"><properties><property name="test_order" value="1043" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestSpecialCases" name="test_async_examples_have_async_functions" time="0.003"><properties><property name="test_order" value="1044" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[ask_parameters_demo]" time="0.004"><properties><property name="test_order" value="1045" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[audio_generation_demo]" time="0.002"><properties><property name="test_order" value="1046" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[audio_quickstart]" time="0.002"><properties><property name="test_order" value="1047" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[audio_transcription_demo]" time="0.003"><properties><property name="test_order" value="1048" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[complete_content_workflow]" time="0.003"><properties><property name="test_order" value="1049" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[document_ai_demo]" time="0.003"><properties><property name="test_order" value="1050" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[environment_isolation_example]" time="0.003"><properties><property name="test_order" value="1051" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[fastchat_example]" time="0.003"><properties><property name="test_order" value="1052" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[files_demo]" time="0.003"><properties><property name="test_order" value="1053" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[files_quickstart]" time="0.002"><properties><property name="test_order" value="1054" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[getting_started]" time="0.003"><properties><property name="test_order" value="1055" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[image_generation_demo]" time="0.003"><properties><property name="test_order" value="1056" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[interactive_setup_example]" time="0.003"><properties><property name="test_order" value="1057" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[knowledge_example]" time="0.003"><properties><property name="test_order" value="1058" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[parallel_usage_tracking_example]" time="0.003"><properties><property name="test_order" value="1059" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[setup_examples]" time="0.003"><properties><property name="test_order" value="1060" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[simple_document_ai]" time="0.003"><properties><property name="test_order" value="1061" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[simple_image_generation]" time="0.003"><properties><property name="test_order" value="1062" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[smart_setup_example]" time="0.003"><properties><property name="test_order" value="1063" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[text_generation_webui_example]" time="0.003"><properties><property name="test_order" value="1064" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[usage_tracking_example]" time="0.004"><properties><property name="test_order" value="1065" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[model_validation]" time="0.003"><properties><property name="test_order" value="1066" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_all_examples_import[main]" time="0.002"><properties><property name="test_order" value="1067" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[ask_parameters_demo-expected_functions0]" time="0.003"><properties><property name="test_order" value="1068" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[audio_generation_demo-expected_functions1]" time="0.003"><properties><property name="test_order" value="1069" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[audio_quickstart-expected_functions2]" time="0.003"><properties><property name="test_order" value="1070" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[audio_transcription_demo-expected_functions3]" time="0.003"><properties><property name="test_order" value="1071" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[complete_content_workflow-expected_functions4]" time="0.003"><properties><property name="test_order" value="1072" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[document_ai_demo-expected_functions5]" time="0.003"><properties><property name="test_order" value="1073" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[environment_isolation_example-expected_functions6]" time="0.003"><properties><property name="test_order" value="1074" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[fastchat_example-expected_functions7]" time="0.003"><properties><property name="test_order" value="1075" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[files_demo-expected_functions8]" time="0.003"><properties><property name="test_order" value="1076" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[getting_started-expected_functions9]" time="0.003"><properties><property name="test_order" value="1077" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[image_generation_demo-expected_functions10]" time="0.003"><properties><property name="test_order" value="1078" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[interactive_setup_example-expected_functions11]" time="0.003"><properties><property name="test_order" value="1079" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[knowledge_example-expected_functions12]" time="0.003"><properties><property name="test_order" value="1080" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[setup_examples-expected_functions13]" time="0.003"><properties><property name="test_order" value="1081" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[smart_setup_example-expected_functions14]" time="0.002"><properties><property name="test_order" value="1082" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[text_generation_webui_example-expected_functions15]" time="0.002"><properties><property name="test_order" value="1083" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[usage_tracking_example-expected_functions16]" time="0.003"><properties><property name="test_order" value="1084" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[model_validation-expected_functions17]" time="0.004"><properties><property name="test_order" value="1085" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[main-expected_functions18]" time="0.003"><properties><property name="test_order" value="1086" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[files_quickstart-expected_functions19]" time="0.003"><properties><property name="test_order" value="1087" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[simple_document_ai-expected_functions20]" time="0.003"><properties><property name="test_order" value="1088" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[simple_image_generation-expected_functions21]" time="0.003"><properties><property name="test_order" value="1089" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_entry_functions[parallel_usage_tracking_example-expected_functions22]" time="0.003"><properties><property name="test_order" value="1090" /></properties></testcase><testcase classname="tests.test_examples_comprehensive" name="test_examples_have_special_functions[files_quickstart-expected_functions0]" time="0.003"><properties><property name="test_order" value="1091" /></properties></testcase><testcase classname="tests.test_examples_comprehensive.TestExampleErrorHandling" name="test_examples_handle_missing_api_keys" time="0.000"><properties><property name="test_order" value="1092" /></properties><skipped type="pytest.skip" message="Example testing has mocking issues - needs investigation">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_examples_comprehensive.py:408: Example testing has mocking issues - needs investigation</skipped></testcase><testcase classname="tests.test_examples_comprehensive.TestExampleErrorHandling" name="test_examples_handle_missing_files" time="0.053"><properties><property name="test_order" value="1093" /></properties></testcase><testcase classname="tests.test_exceptions.TestAIUsageDisabledError" name="test_default_message" time="0.003"><properties><property name="test_order" value="1094" /></properties></testcase><testcase classname="tests.test_exceptions.TestAIUsageDisabledError" name="test_custom_message" time="0.003"><properties><property name="test_order" value="1095" /></properties></testcase><testcase classname="tests.test_exceptions.TestAIUsageDisabledError" name="test_inheritance" time="0.002"><properties><property name="test_order" value="1096" /></properties></testcase><testcase classname="tests.test_exceptions.TestAIUsageDisabledError" name="test_exception_chaining" time="0.003"><properties><property name="test_order" value="1097" /></properties></testcase><testcase classname="tests.test_exceptions.TestInvalidPromptError" name="test_default_message" time="0.003"><properties><property name="test_order" value="1098" /></properties></testcase><testcase classname="tests.test_exceptions.TestInvalidPromptError" name="test_custom_message" time="0.003"><properties><property name="test_order" value="1099" /></properties></testcase><testcase classname="tests.test_exceptions.TestInvalidPromptError" name="test_inheritance" time="0.003"><properties><property name="test_order" value="1100" /></properties></testcase><testcase classname="tests.test_exceptions.TestMemoryUsageExceededError" name="test_default_message" time="0.003"><properties><property name="test_order" value="1101" /></properties></testcase><testcase classname="tests.test_exceptions.TestMemoryUsageExceededError" name="test_custom_message" time="0.003"><properties><property name="test_order" value="1102" /></properties></testcase><testcase classname="tests.test_exceptions.TestMemoryUsageExceededError" name="test_inheritance" time="0.002"><properties><property name="test_order" value="1103" /></properties></testcase><testcase classname="tests.test_exceptions.TestRateLimitExceededError" name="test_default_message" time="0.003"><properties><property name="test_order" value="1104" /></properties></testcase><testcase classname="tests.test_exceptions.TestRateLimitExceededError" name="test_custom_message" time="0.003"><properties><property name="test_order" value="1105" /></properties></testcase><testcase classname="tests.test_exceptions.TestRateLimitExceededError" name="test_inheritance" time="0.002"><properties><property name="test_order" value="1106" /></properties></testcase><testcase classname="tests.test_exceptions.TestLoggingError" name="test_default_message" time="0.003"><properties><property name="test_order" value="1107" /></properties></testcase><testcase classname="tests.test_exceptions.TestLoggingError" name="test_custom_message" time="0.003"><properties><property name="test_order" value="1108" /></properties></testcase><testcase classname="tests.test_exceptions.TestLoggingError" name="test_inheritance" time="0.002"><properties><property name="test_order" value="1109" /></properties></testcase><testcase classname="tests.test_exceptions.TestConfigError" name="test_custom_message" time="0.003"><properties><property name="test_order" value="1110" /></properties></testcase><testcase classname="tests.test_exceptions.TestConfigError" name="test_inheritance" time="0.002"><properties><property name="test_order" value="1111" /></properties></testcase><testcase classname="tests.test_exceptions.TestConfigError" name="test_message_attribute" time="0.003"><properties><property name="test_order" value="1112" /></properties></testcase><testcase classname="tests.test_exceptions.TestExceptionBehavior" name="test_all_exceptions_can_be_caught" time="0.003"><properties><property name="test_order" value="1113" /></properties></testcase><testcase classname="tests.test_exceptions.TestExceptionBehavior" name="test_exception_repr" time="0.002"><properties><property name="test_order" value="1114" /></properties></testcase><testcase classname="tests.test_exceptions.TestExceptionBehavior" name="test_exception_hash" time="0.002"><properties><property name="test_order" value="1115" /></properties></testcase><testcase classname="tests.test_exceptions.TestExceptionBehavior" name="test_exception_equality" time="0.003"><properties><property name="test_order" value="1116" /></properties></testcase><testcase classname="tests.test_exceptions.TestLoggingIntegration" name="test_all_exceptions_log_on_creation" time="0.004"><properties><property name="test_order" value="1117" /></properties></testcase><testcase classname="tests.test_exceptions.TestLoggingIntegration" name="test_logging_failure_doesnt_break_exception" time="0.003"><properties><property name="test_order" value="1118" /></properties></testcase><testcase classname="tests.test_exceptions.TestLoggingIntegration" name="test_exception_with_logging_configured" time="0.003"><properties><property name="test_order" value="1119" /></properties></testcase><testcase classname="tests.test_exceptions.TestEdgeCases" name="test_empty_message" time="0.003"><properties><property name="test_order" value="1120" /></properties></testcase><testcase classname="tests.test_exceptions.TestEdgeCases" name="test_none_message" time="0.003"><properties><property name="test_order" value="1121" /></properties></testcase><testcase classname="tests.test_exceptions.TestEdgeCases" name="test_long_message" time="0.003"><properties><property name="test_order" value="1122" /></properties></testcase><testcase classname="tests.test_exceptions.TestEdgeCases" name="test_special_characters_in_message" time="0.003"><properties><property name="test_order" value="1123" /></properties></testcase><testcase classname="tests.test_exceptions.TestEdgeCases" name="test_exception_pickling" time="0.003"><properties><property name="test_order" value="1124" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_minimal_creation" time="0.002"><properties><property name="test_order" value="1125" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_full_creation" time="0.003"><properties><property name="test_order" value="1126" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_required_fields_validation" time="0.003"><properties><property name="test_order" value="1127" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_field_types_validation" time="0.003"><properties><property name="test_order" value="1128" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_optional_fields_default_values" time="0.003"><properties><property name="test_order" value="1129" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_purpose_field_various_values" time="0.003"><properties><property name="test_order" value="1130" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_created_at_serialization" time="0.004"><properties><property name="test_order" value="1131" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_created_at_serialization_none" time="0.002"><properties><property name="test_order" value="1132" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_str_representation" time="0.003"><properties><property name="test_order" value="1133" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_str_representation_with_long_values" time="0.003"><properties><property name="test_order" value="1134" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_repr_representation" time="0.003"><properties><property name="test_order" value="1135" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_repr_representation_with_none_purpose" time="0.002"><properties><property name="test_order" value="1136" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_model_config_populate_by_name" time="0.002"><properties><property name="test_order" value="1137" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_equality" time="0.003"><properties><property name="test_order" value="1138" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_hashability" time="0.002"><properties><property name="test_order" value="1139" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_model_dump_and_load" time="0.003"><properties><property name="test_order" value="1140" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_json_serialization" time="0.003"><properties><property name="test_order" value="1141" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFile" name="test_json_deserialization" time="0.004"><properties><property name="test_order" value="1142" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFileEdgeCases" name="test_empty_string_fields" time="0.057"><properties><property name="test_order" value="1143" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFileEdgeCases" name="test_very_large_file_size" time="0.003"><properties><property name="test_order" value="1144" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFileEdgeCases" name="test_special_characters_in_filename" time="0.002"><properties><property name="test_order" value="1145" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFileEdgeCases" name="test_unicode_in_fields" time="0.002"><properties><property name="test_order" value="1146" /></properties></testcase><testcase classname="tests.test_file_models.TestUploadedFileEdgeCases" name="test_microsecond_precision_datetime" time="0.003"><properties><property name="test_order" value="1147" /></properties></testcase><testcase classname="tests.test_files_api.TestFileUpload" name="test_upload_file_success" time="0.008"><properties><property name="test_order" value="1148" /></properties></testcase><testcase classname="tests.test_files_api.TestFileUpload" name="test_upload_file_with_custom_filename" time="0.006"><properties><property name="test_order" value="1149" /></properties></testcase><testcase classname="tests.test_files_api.TestFileUpload" name="test_upload_file_nonexistent" time="0.005"><properties><property name="test_order" value="1150" /></properties></testcase><testcase classname="tests.test_files_api.TestFileUpload" name="test_upload_file_directory" time="0.006"><properties><property name="test_order" value="1151" /></properties></testcase><testcase classname="tests.test_files_api.TestFileUpload" name="test_upload_file_path_string" time="0.006"><properties><property name="test_order" value="1152" /></properties></testcase><testcase classname="tests.test_files_api.TestFileUpload" name="test_upload_file_provider_error" time="0.007"><properties><property name="test_order" value="1153" /></properties></testcase><testcase classname="tests.test_files_api.TestFileUpload" name="test_upload_file_capability_error" time="0.010"><properties><property name="test_order" value="1154" /></properties></testcase><testcase classname="tests.test_files_api.TestFileDownload" name="test_download_file_success" time="0.006"><properties><property name="test_order" value="1155" /></properties></testcase><testcase classname="tests.test_files_api.TestFileDownload" name="test_download_file_to_path" time="0.007"><properties><property name="test_order" value="1156" /></properties></testcase><testcase classname="tests.test_files_api.TestFileDownload" name="test_download_file_to_path_string" time="0.007"><properties><property name="test_order" value="1157" /></properties></testcase><testcase classname="tests.test_files_api.TestFileDownload" name="test_download_file_creates_directories" time="0.009"><properties><property name="test_order" value="1158" /></properties></testcase><testcase classname="tests.test_files_api.TestFileDownload" name="test_download_file_empty_id" time="0.006"><properties><property name="test_order" value="1159" /></properties></testcase><testcase classname="tests.test_files_api.TestFileDownload" name="test_download_file_provider_error" time="0.005"><properties><property name="test_order" value="1160" /></properties></testcase><testcase classname="tests.test_files_api.TestFileDownload" name="test_download_file_capability_error" time="0.010"><properties><property name="test_order" value="1161" /></properties></testcase><testcase classname="tests.test_files_api.TestFileDownload" name="test_download_file_unknown_id" time="0.006"><properties><property name="test_order" value="1162" /></properties></testcase><testcase classname="tests.test_files_api.TestAsyncFileOperations" name="test_async_upload_file_success" time="0.009"><properties><property name="test_order" value="1163" /></properties></testcase><testcase classname="tests.test_files_api.TestAsyncFileOperations" name="test_async_download_file_success" time="0.006"><properties><property name="test_order" value="1164" /></properties></testcase><testcase classname="tests.test_files_api.TestAsyncFileOperations" name="test_async_download_file_to_path" time="0.008"><properties><property name="test_order" value="1165" /></properties></testcase><testcase classname="tests.test_files_api.TestAsyncFileOperations" name="test_async_upload_file_validation" time="0.006"><properties><property name="test_order" value="1166" /></properties></testcase><testcase classname="tests.test_files_api.TestAsyncFileOperations" name="test_async_download_file_validation" time="0.006"><properties><property name="test_order" value="1167" /></properties></testcase><testcase classname="tests.test_files_api.TestAsyncFileOperations" name="test_async_capability_errors" time="0.015"><properties><property name="test_order" value="1168" /></properties></testcase><testcase classname="tests.test_files_api.TestUploadedFileModel" name="test_uploaded_file_creation" time="0.003"><properties><property name="test_order" value="1169" /></properties></testcase><testcase classname="tests.test_files_api.TestUploadedFileModel" name="test_uploaded_file_with_datetime" time="0.003"><properties><property name="test_order" value="1170" /></properties></testcase><testcase classname="tests.test_files_api.TestUploadedFileModel" name="test_uploaded_file_string_representation" time="0.003"><properties><property name="test_order" value="1171" /></properties></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_upload_file_real_api" time="0.000"><properties><property name="test_order" value="1172" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:75: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_upload_file_different_purposes" time="0.000"><properties><property name="test_order" value="1173" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:95: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_upload_file_custom_filename" time="0.000"><properties><property name="test_order" value="1174" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:109: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_download_file_real_api" time="0.000"><properties><property name="test_order" value="1175" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:123: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_download_file_to_disk" time="0.000"><properties><property name="test_order" value="1176" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:144: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_upload_download_roundtrip" time="0.000"><properties><property name="test_order" value="1177" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:170: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_list_uploaded_files" time="0.000"><properties><property name="test_order" value="1178" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:189: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_delete_uploaded_file" time="0.000"><properties><property name="test_order" value="1179" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:208: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_async_upload_file" time="0.000"><properties><property name="test_order" value="1180" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:226: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_async_download_file" time="0.000"><properties><property name="test_order" value="1181" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:242: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_async_upload_download_roundtrip" time="0.000"><properties><property name="test_order" value="1182" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:261: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_async_concurrent_operations" time="0.000"><properties><property name="test_order" value="1183" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:279: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_file_size_limits" time="0.000"><properties><property name="test_order" value="1184" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:322: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_different_file_types" time="0.000"><properties><property name="test_order" value="1185" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:343: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestFilesIntegration" name="test_error_handling_real_api" time="0.000"><properties><property name="test_order" value="1186" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:380: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration.TestOpenAICompatibleIntegration" name="test_compatible_provider_capability_errors" time="0.000"><properties><property name="test_order" value="1187" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration.py:408: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration_working.TestWorkingFilesIntegration" name="test_upload_file_real_api" time="0.000"><properties><property name="test_order" value="1188" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration_working.py:78: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration_working.TestWorkingFilesIntegration" name="test_upload_file_different_purposes" time="0.000"><properties><property name="test_order" value="1189" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration_working.py:96: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration_working.TestWorkingFilesIntegration" name="test_upload_file_custom_filename" time="0.000"><properties><property name="test_order" value="1190" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration_working.py:110: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration_working.TestWorkingFilesIntegration" name="test_list_uploaded_files" time="0.000"><properties><property name="test_order" value="1191" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration_working.py:124: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration_working.TestWorkingFilesIntegration" name="test_delete_uploaded_file" time="0.000"><properties><property name="test_order" value="1192" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration_working.py:141: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration_working.TestWorkingFilesIntegration" name="test_async_upload_file" time="0.000"><properties><property name="test_order" value="1193" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration_working.py:162: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration_working.TestWorkingFilesIntegration" name="test_async_list_files" time="0.000"><properties><property name="test_order" value="1194" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration_working.py:177: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration_working.TestWorkingFilesIntegration" name="test_async_delete_file" time="0.000"><properties><property name="test_order" value="1195" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration_working.py:188: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration_working.TestWorkingFilesIntegration" name="test_async_concurrent_operations" time="0.000"><properties><property name="test_order" value="1196" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration_working.py:203: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_files_integration_working.TestOpenAICompatibleIntegration" name="test_compatible_provider_capability_errors" time="0.000"><properties><property name="test_order" value="1197" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_files_integration_working.py:236: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_parse_pure_json_object" time="0.003"><properties><property name="test_order" value="1198" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_parse_pure_json_array" time="0.003"><properties><property name="test_order" value="1199" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_parse_json_with_code_fences" time="0.003"><properties><property name="test_order" value="1200" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_parse_json_with_generic_code_fences" time="0.002"><properties><property name="test_order" value="1201" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_parse_json_with_leading_prose" time="0.002"><properties><property name="test_order" value="1202" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_parse_json_with_trailing_prose" time="0.002"><properties><property name="test_order" value="1203" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_parse_json_with_surrounding_prose" time="0.003"><properties><property name="test_order" value="1204" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_parse_json_with_multiple_objects_returns_first" time="0.003"><properties><property name="test_order" value="1205" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_parse_nested_json" time="0.003"><properties><property name="test_order" value="1206" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_parse_json_types" time="0.003"><properties><property name="test_order" value="1207" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_error_empty_text" time="0.003"><properties><property name="test_order" value="1208" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_error_whitespace_only" time="0.002"><properties><property name="test_order" value="1209" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_error_no_json_found" time="0.002"><properties><property name="test_order" value="1210" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_error_malformed_json" time="0.003"><properties><property name="test_order" value="1211" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_error_incomplete_json" time="0.003"><properties><property name="test_order" value="1212" /></properties></testcase><testcase classname="tests.test_json_parsing.TestParseJsonFromText" name="test_preserves_original_error_info" time="0.003"><properties><property name="test_order" value="1213" /></properties></testcase><testcase classname="tests.test_json_parsing.TestCreateRepairPrompt" name="test_repair_prompt_content" time="0.003"><properties><property name="test_order" value="1214" /></properties></testcase><testcase classname="tests.test_json_parsing.TestCreateRepairPrompt" name="test_repair_prompt_format" time="0.003"><properties><property name="test_order" value="1215" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_init_default_parameters" time="0.003"><properties><property name="test_order" value="1216" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_init_custom_parameters" time="0.002"><properties><property name="test_order" value="1217" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_init_validation_errors" time="0.003"><properties><property name="test_order" value="1218" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_empty_string" time="0.003"><properties><property name="test_order" value="1219" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_short_text" time="0.003"><properties><property name="test_order" value="1220" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_exact_chunk_size" time="0.002"><properties><property name="test_order" value="1221" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_simple_split" time="0.003"><properties><property name="test_order" value="1222" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_with_overlap" time="0.003"><properties><property name="test_order" value="1223" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_sentence_boundaries" time="0.003"><properties><property name="test_order" value="1224" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_paragraph_boundaries" time="0.002"><properties><property name="test_order" value="1225" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_multiple_boundaries" time="0.002"><properties><property name="test_order" value="1226" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_very_small_chunks" time="0.003"><properties><property name="test_order" value="1227" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_large_text" time="0.004"><properties><property name="test_order" value="1228" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_metadata" time="0.003"><properties><property name="test_order" value="1229" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_unicode_content" time="0.002"><properties><property name="test_order" value="1230" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_whitespace_handling" time="0.003"><properties><property name="test_order" value="1231" /></properties></testcase><testcase classname="tests.test_knowledge_chunking.TestTextChunker" name="test_chunk_text_edge_cases" time="0.003"><properties><property name="test_order" value="1232" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_init_default_parameters" time="0.003"><properties><property name="test_order" value="1233" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_init_custom_parameters" time="0.003"><properties><property name="test_order" value="1234" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_init_validation_errors" time="0.003"><properties><property name="test_order" value="1235" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_empty_string" time="0.003"><properties><property name="test_order" value="1236" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_whitespace_only" time="0.002"><properties><property name="test_order" value="1237" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_short_text" time="0.002"><properties><property name="test_order" value="1238" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_exact_chunk_size" time="0.002"><properties><property name="test_order" value="1239" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_simple_split" time="0.003"><properties><property name="test_order" value="1240" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_with_overlap" time="0.003"><properties><property name="test_order" value="1241" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_paragraph_boundaries" time="0.003"><properties><property name="test_order" value="1242" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_min_chunk_size_filtering" time="0.003"><properties><property name="test_order" value="1243" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_start_chunk_index" time="0.004"><properties><property name="test_order" value="1244" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_unicode_content" time="0.003"><properties><property name="test_order" value="1245" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_whitespace_normalization" time="0.003"><properties><property name="test_order" value="1246" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_line_endings" time="0.003"><properties><property name="test_order" value="1247" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_very_small_chunks" time="0.003"><properties><property name="test_order" value="1248" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_large_text" time="0.003"><properties><property name="test_order" value="1249" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_normalize_text_method" time="0.003"><properties><property name="test_order" value="1250" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_metadata_completeness" time="0.003"><properties><property name="test_order" value="1251" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_fixed.TestTextChunkerFixed" name="test_chunk_text_edge_cases" time="0.004"><properties><property name="test_order" value="1252" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_init_default_parameters" time="0.003"><properties><property name="test_order" value="1253" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_init_custom_parameters" time="0.002"><properties><property name="test_order" value="1254" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_init_validation_errors" time="0.003"><properties><property name="test_order" value="1255" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_empty_string" time="0.003"><properties><property name="test_order" value="1256" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_whitespace_only" time="0.003"><properties><property name="test_order" value="1257" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_short_text" time="0.003"><properties><property name="test_order" value="1258" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_exact_chunk_size" time="0.002"><properties><property name="test_order" value="1259" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_simple_split" time="0.003"><properties><property name="test_order" value="1260" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_with_overlap" time="0.002"><properties><property name="test_order" value="1261" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_paragraph_boundaries" time="0.002"><properties><property name="test_order" value="1262" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_min_chunk_size_filtering" time="0.003"><properties><property name="test_order" value="1263" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_start_chunk_index" time="0.003"><properties><property name="test_order" value="1264" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_unicode_content" time="0.003"><properties><property name="test_order" value="1265" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_whitespace_normalization" time="0.003"><properties><property name="test_order" value="1266" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_line_endings" time="0.003"><properties><property name="test_order" value="1267" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_very_small_chunks" time="0.003"><properties><property name="test_order" value="1268" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_large_text" time="0.002"><properties><property name="test_order" value="1269" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_normalize_text_method" time="0.003"><properties><property name="test_order" value="1270" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_metadata_completeness" time="0.002"><properties><property name="test_order" value="1271" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_edge_cases" time="0.003"><properties><property name="test_order" value="1272" /></properties></testcase><testcase classname="tests.test_knowledge_chunking_working.TestTextChunkerWorking" name="test_chunk_text_respect_sentence_boundaries" time="0.003"><properties><property name="test_order" value="1273" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestKnowledgeExceptions" name="test_knowledge_error_base_class" time="0.003"><properties><property name="test_order" value="1274" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestKnowledgeExceptions" name="test_knowledge_disabled_error_default" time="0.003"><properties><property name="test_order" value="1275" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestKnowledgeExceptions" name="test_knowledge_disabled_error_custom_message" time="0.003"><properties><property name="test_order" value="1276" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestKnowledgeExceptions" name="test_sqlite_extension_error_default_message" time="0.003"><properties><property name="test_order" value="1277" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestKnowledgeExceptions" name="test_sqlite_extension_error_custom_message" time="0.003"><properties><property name="test_order" value="1278" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestKnowledgeExceptions" name="test_knowledge_index_error_without_cause" time="0.003"><properties><property name="test_order" value="1279" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestKnowledgeExceptions" name="test_knowledge_index_error_with_cause" time="0.003"><properties><property name="test_order" value="1280" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestKnowledgeExceptions" name="test_knowledge_search_error_without_cause" time="0.002"><properties><property name="test_order" value="1281" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestKnowledgeExceptions" name="test_knowledge_search_error_with_cause" time="0.002"><properties><property name="test_order" value="1282" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestKnowledgeExceptions" name="test_knowledge_validation_error_full" time="0.002"><properties><property name="test_order" value="1283" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestKnowledgeExceptions" name="test_knowledge_validation_error_minimal" time="0.059"><properties><property name="test_order" value="1284" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSourceModel" name="test_source_creation_minimal" time="0.003"><properties><property name="test_order" value="1285" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSourceModel" name="test_source_creation_full" time="0.002"><properties><property name="test_order" value="1286" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSourceModel" name="test_file_extension_property" time="0.002"><properties><property name="test_order" value="1287" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSourceModel" name="test_file_extension_no_extension" time="0.003"><properties><property name="test_order" value="1288" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSourceModel" name="test_is_text_file_property" time="0.003"><properties><property name="test_order" value="1289" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSourceModel" name="test_source_creation_basic" time="0.003"><properties><property name="test_order" value="1290" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSourceModel" name="test_source_file_extension_detection" time="0.003"><properties><property name="test_order" value="1291" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSourceModel" name="test_source_is_text_file_detection" time="0.003"><properties><property name="test_order" value="1292" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestChunkModel" name="test_chunk_creation_minimal" time="0.002"><properties><property name="test_order" value="1293" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestChunkModel" name="test_chunk_creation_full" time="0.002"><properties><property name="test_order" value="1294" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestChunkModel" name="test_text_length_property" time="0.002"><properties><property name="test_order" value="1295" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestChunkModel" name="test_has_embedding_property" time="0.003"><properties><property name="test_order" value="1296" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestChunkModel" name="test_embedding_dimension_property" time="0.003"><properties><property name="test_order" value="1297" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSearchHitModel" name="test_search_hit_creation" time="0.003"><properties><property name="test_order" value="1298" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSearchHitModel" name="test_is_high_similarity_property" time="0.003"><properties><property name="test_order" value="1299" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSearchHitModel" name="test_is_medium_similarity_property" time="0.003"><properties><property name="test_order" value="1300" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSearchHitModel" name="test_from_chunk_with_path_string" time="0.003"><properties><property name="test_order" value="1301" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSearchHitModel" name="test_from_chunk_with_path_object" time="0.002"><properties><property name="test_order" value="1302" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestSearchHitModel" name="test_from_chunk_edge_cases" time="0.003"><properties><property name="test_order" value="1303" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestModelValidation" name="test_source_validation_required_fields" time="0.003"><properties><property name="test_order" value="1304" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestModelValidation" name="test_chunk_validation_required_fields" time="0.002"><properties><property name="test_order" value="1305" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestModelValidation" name="test_search_hit_validation_required_fields" time="0.003"><properties><property name="test_order" value="1306" /></properties></testcase><testcase classname="tests.test_knowledge_core.TestModelValidation" name="test_similarity_score_validation" time="0.003"><properties><property name="test_order" value="1307" /></properties></testcase><testcase classname="tests.test_knowledge_direct.TestKnowledgeExceptions" name="test_knowledge_error_base_class" time="0.003"><properties><property name="test_order" value="1308" /></properties></testcase><testcase classname="tests.test_knowledge_direct.TestKnowledgeExceptions" name="test_knowledge_disabled_error_default" time="0.002"><properties><property name="test_order" value="1309" /></properties></testcase><testcase classname="tests.test_knowledge_direct.TestKnowledgeExceptions" name="test_sqlite_extension_error" time="0.002"><properties><property name="test_order" value="1310" /></properties></testcase><testcase classname="tests.test_knowledge_direct.TestKnowledgeExceptions" name="test_knowledge_index_error" time="0.003"><properties><property name="test_order" value="1311" /></properties></testcase><testcase classname="tests.test_knowledge_direct.TestKnowledgeExceptions" name="test_knowledge_search_error" time="0.003"><properties><property name="test_order" value="1312" /></properties></testcase><testcase classname="tests.test_knowledge_direct.TestKnowledgeExceptions" name="test_knowledge_validation_error" time="0.003"><properties><property name="test_order" value="1313" /></properties></testcase><testcase classname="tests.test_knowledge_direct.TestSourceModel" name="test_source_creation_minimal" time="0.002"><properties><property name="test_order" value="1314" /></properties></testcase><testcase classname="tests.test_knowledge_direct.TestSourceModel" name="test_file_extension_property" time="0.003"><properties><property name="test_order" value="1315" /></properties></testcase><testcase classname="tests.test_knowledge_direct.TestSourceModel" name="test_is_text_file_property" time="0.003"><properties><property name="test_order" value="1316" /></properties></testcase><testcase classname="tests.test_knowledge_direct.TestChunkModel" name="test_chunk_creation_minimal" time="0.002"><properties><property name="test_order" value="1317" /></properties></testcase><testcase classname="tests.test_knowledge_direct.TestChunkModel" name="test_text_length_property" time="0.003"><properties><property name="test_order" value="1318" /></properties></testcase><testcase classname="tests.test_knowledge_direct.TestSearchHitModel" name="test_search_hit_creation" time="0.003"><properties><property name="test_order" value="1319" /></properties></testcase><testcase classname="tests.test_knowledge_direct.TestSearchHitModel" name="test_is_high_similarity_property" time="0.003"><properties><property name="test_order" value="1320" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeError" name="test_knowledge_error_inheritance" time="0.002"><properties><property name="test_order" value="1321" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeError" name="test_knowledge_error_creation" time="0.002"><properties><property name="test_order" value="1322" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeDisabledError" name="test_inheritance" time="0.002"><properties><property name="test_order" value="1323" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeDisabledError" name="test_default_message" time="0.003"><properties><property name="test_order" value="1324" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeDisabledError" name="test_custom_message" time="0.002"><properties><property name="test_order" value="1325" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestSqliteExtensionUnavailableError" name="test_inheritance" time="0.003"><properties><property name="test_order" value="1326" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestSqliteExtensionUnavailableError" name="test_default_message" time="0.003"><properties><property name="test_order" value="1327" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestSqliteExtensionUnavailableError" name="test_custom_message" time="0.004"><properties><property name="test_order" value="1328" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeIndexError" name="test_inheritance" time="0.003"><properties><property name="test_order" value="1329" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeIndexError" name="test_error_creation" time="0.003"><properties><property name="test_order" value="1330" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeIndexError" name="test_error_with_cause" time="0.002"><properties><property name="test_order" value="1331" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeSearchError" name="test_inheritance" time="0.003"><properties><property name="test_order" value="1332" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeSearchError" name="test_error_creation" time="0.003"><properties><property name="test_order" value="1333" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeSearchError" name="test_error_with_cause" time="0.003"><properties><property name="test_order" value="1334" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeValidationError" name="test_inheritance" time="0.002"><properties><property name="test_order" value="1335" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeValidationError" name="test_error_creation" time="0.003"><properties><property name="test_order" value="1336" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestKnowledgeValidationError" name="test_error_with_field_and_value" time="0.002"><properties><property name="test_order" value="1337" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestExceptionHierarchy" name="test_all_exceptions_inherit_from_knowledge_error" time="0.002"><properties><property name="test_order" value="1338" /></properties></testcase><testcase classname="tests.test_knowledge_exceptions.TestExceptionHierarchy" name="test_exception_catching" time="0.002"><properties><property name="test_order" value="1339" /></properties></testcase><testcase classname="tests.test_knowledge_imports" name="test_knowledge_exceptions_import" time="0.003"><properties><property name="test_order" value="1340" /></properties></testcase><testcase classname="tests.test_knowledge_imports" name="test_knowledge_models_import" time="0.002"><properties><property name="test_order" value="1341" /></properties></testcase><testcase classname="tests.test_knowledge_imports" name="test_knowledge_backend_import" time="0.003"><properties><property name="test_order" value="1342" /></properties></testcase><testcase classname="tests.test_knowledge_imports" name="test_knowledge_indexer_import" time="0.003"><properties><property name="test_order" value="1343" /></properties></testcase><testcase classname="tests.test_knowledge_imports" name="test_knowledge_search_import" time="0.003"><properties><property name="test_order" value="1344" /></properties></testcase><testcase classname="tests.test_knowledge_imports" name="test_knowledge_sources_import" time="0.002"><properties><property name="test_order" value="1345" /></properties></testcase><testcase classname="tests.test_knowledge_imports" name="test_knowledge_chunking_import" time="0.002"><properties><property name="test_order" value="1346" /></properties></testcase><testcase classname="tests.test_knowledge_imports" name="test_all_knowledge_modules_import" time="0.002"><properties><property name="test_order" value="1347" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_init" time="0.004"><properties><property name="test_order" value="1348" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_init_default_model" time="0.004"><properties><property name="test_order" value="1349" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_index_directory_not_exists" time="0.005"><properties><property name="test_order" value="1350" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_index_directory_not_directory" time="0.005"><properties><property name="test_order" value="1351" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_index_directory_success" time="0.006"><properties><property name="test_order" value="1352" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_index_files_empty_list" time="0.004"><properties><property name="test_order" value="1353" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_index_files_with_force_reindex" time="0.005"><properties><property name="test_order" value="1354" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_index_files_already_indexed" time="0.005"><properties><property name="test_order" value="1355" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_find_files_recursive" time="0.006"><properties><property name="test_order" value="1356" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_find_files_non_recursive" time="0.006"><properties><property name="test_order" value="1357" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_index_file_success" time="0.005"><properties><property name="test_order" value="1358" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_index_file_load_error" time="0.005"><properties><property name="test_order" value="1359" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_index_file_embedding_error" time="0.006"><properties><property name="test_order" value="1360" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_generate_embeddings" time="0.004"><properties><property name="test_order" value="1361" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_generate_embeddings_error" time="0.004"><properties><property name="test_order" value="1362" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_reindex_changed_files" time="0.007"><properties><property name="test_order" value="1363" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_remove_source" time="0.004"><properties><property name="test_order" value="1364" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_get_index_stats" time="0.004"><properties><property name="test_order" value="1365" /></properties></testcase><testcase classname="tests.test_knowledge_indexer.TestKnowledgeIndexer" name="test_integration_full_workflow" time="0.008"><properties><property name="test_order" value="1366" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_init_and_basic_methods" time="0.004"><properties><property name="test_order" value="1367" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_index_directory_validation_errors" time="0.005"><properties><property name="test_order" value="1368" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_index_files_empty_list" time="0.004"><properties><property name="test_order" value="1369" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_index_files_with_content" time="0.006"><properties><property name="test_order" value="1370" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_index_files_already_indexed" time="0.005"><properties><property name="test_order" value="1371" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_find_files_comprehensive" time="0.007"><properties><property name="test_order" value="1372" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_index_file_complete_workflow" time="0.005"><properties><property name="test_order" value="1373" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_index_file_already_exists_same_hash" time="0.005"><properties><property name="test_order" value="1374" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_index_file_already_exists_different_hash" time="0.006"><properties><property name="test_order" value="1375" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_index_file_load_error" time="0.005"><properties><property name="test_order" value="1376" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_index_file_chunking_error" time="0.005"><properties><property name="test_order" value="1377" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_index_file_embedding_error" time="0.006"><properties><property name="test_order" value="1378" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_generate_embeddings_success" time="0.004"><properties><property name="test_order" value="1379" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_generate_embeddings_error" time="0.004"><properties><property name="test_order" value="1380" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_reindex_changed_files" time="0.007"><properties><property name="test_order" value="1381" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_remove_source" time="0.004"><properties><property name="test_order" value="1382" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_get_index_stats" time="0.004"><properties><property name="test_order" value="1383" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_complete.TestKnowledgeIndexerComplete" name="test_all_error_paths_and_edge_cases" time="0.005"><properties><property name="test_order" value="1384" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_integration.TestKnowledgeIndexerIntegration" name="test_full_index_directory_workflow" time="0.007"><properties><property name="test_order" value="1385" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_integration.TestKnowledgeIndexerIntegration" name="test_full_index_files_workflow" time="0.005"><properties><property name="test_order" value="1386" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_integration.TestKnowledgeIndexerIntegration" name="test_index_file_with_all_paths" time="0.005"><properties><property name="test_order" value="1387" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_integration.TestKnowledgeIndexerIntegration" name="test_index_file_already_exists" time="0.005"><properties><property name="test_order" value="1388" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_integration.TestKnowledgeIndexerIntegration" name="test_generate_embeddings_complete" time="0.004"><properties><property name="test_order" value="1389" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_integration.TestKnowledgeIndexerIntegration" name="test_reindex_changed_files_complete" time="0.008"><properties><property name="test_order" value="1390" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_integration.TestKnowledgeIndexerIntegration" name="test_remove_source_complete" time="0.005"><properties><property name="test_order" value="1391" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_integration.TestKnowledgeIndexerIntegration" name="test_get_index_stats_complete" time="0.005"><properties><property name="test_order" value="1392" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_integration.TestKnowledgeIndexerIntegration" name="test_error_handling_paths" time="0.005"><properties><property name="test_order" value="1393" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_integration.TestKnowledgeIndexerIntegration" name="test_find_files_all_scenarios" time="0.007"><properties><property name="test_order" value="1394" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_simple.TestKnowledgeIndexerSimple" name="test_init_coverage" time="0.003"><properties><property name="test_order" value="1395" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_simple.TestKnowledgeIndexerSimple" name="test_index_directory_validation" time="0.004"><properties><property name="test_order" value="1396" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_simple.TestKnowledgeIndexerSimple" name="test_index_files_basic" time="0.003"><properties><property name="test_order" value="1397" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_simple.TestKnowledgeIndexerSimple" name="test_find_files_functionality" time="0.007"><properties><property name="test_order" value="1398" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_simple.TestKnowledgeIndexerSimple" name="test_reindex_changed_files_basic" time="0.005"><properties><property name="test_order" value="1399" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_simple.TestKnowledgeIndexerSimple" name="test_remove_source_method" time="0.004"><properties><property name="test_order" value="1400" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_simple.TestKnowledgeIndexerSimple" name="test_get_index_stats_method" time="0.003"><properties><property name="test_order" value="1401" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_simple.TestKnowledgeIndexerSimple" name="test_index_file_method_signature" time="0.005"><properties><property name="test_order" value="1402" /></properties></testcase><testcase classname="tests.test_knowledge_indexer_simple.TestKnowledgeIndexerSimple" name="test_generate_embeddings_method_signature" time="0.003"><properties><property name="test_order" value="1403" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestSource" name="test_source_creation_minimal" time="0.062"><properties><property name="test_order" value="1404" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestSource" name="test_file_extension_property" time="0.002"><properties><property name="test_order" value="1405" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestSource" name="test_is_text_file_property" time="0.002"><properties><property name="test_order" value="1406" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestChunk" name="test_chunk_creation_minimal" time="0.002"><properties><property name="test_order" value="1407" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestChunk" name="test_chunk_creation_with_embedding" time="0.003"><properties><property name="test_order" value="1408" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestChunk" name="test_text_length_property" time="0.002"><properties><property name="test_order" value="1409" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestChunk" name="test_has_embedding_property" time="0.002"><properties><property name="test_order" value="1410" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestChunk" name="test_embedding_dimension_property" time="0.003"><properties><property name="test_order" value="1411" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestSearchHit" name="test_search_hit_creation" time="0.003"><properties><property name="test_order" value="1412" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestSearchHit" name="test_similarity_score_bounds" time="0.002"><properties><property name="test_order" value="1413" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestModelValidation" name="test_source_validation_errors" time="0.002"><properties><property name="test_order" value="1414" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestModelValidation" name="test_chunk_validation_errors" time="0.002"><properties><property name="test_order" value="1415" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestModelValidation" name="test_search_hit_validation_errors" time="0.003"><properties><property name="test_order" value="1416" /></properties></testcase><testcase classname="tests.test_knowledge_models.TestModelInheritance" name="test_all_models_are_pydantic" time="0.002"><properties><property name="test_order" value="1417" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestKnowledgeExceptions" name="test_knowledge_error_base_class" time="0.003"><properties><property name="test_order" value="1418" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestKnowledgeExceptions" name="test_knowledge_disabled_error_default" time="0.003"><properties><property name="test_order" value="1419" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestKnowledgeExceptions" name="test_sqlite_extension_error" time="0.003"><properties><property name="test_order" value="1420" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestKnowledgeExceptions" name="test_knowledge_index_error" time="0.002"><properties><property name="test_order" value="1421" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestKnowledgeExceptions" name="test_knowledge_search_error" time="0.002"><properties><property name="test_order" value="1422" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestKnowledgeExceptions" name="test_knowledge_validation_error" time="0.002"><properties><property name="test_order" value="1423" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestSourceModel" name="test_source_creation_minimal" time="0.004"><properties><property name="test_order" value="1424" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestSourceModel" name="test_source_creation_full" time="0.003"><properties><property name="test_order" value="1425" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestSourceModel" name="test_file_extension_property" time="0.003"><properties><property name="test_order" value="1426" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestSourceModel" name="test_file_extension_no_extension" time="0.002"><properties><property name="test_order" value="1427" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestSourceModel" name="test_is_text_file_property" time="0.003"><properties><property name="test_order" value="1428" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestChunkModel" name="test_chunk_creation_minimal" time="0.002"><properties><property name="test_order" value="1429" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestChunkModel" name="test_chunk_creation_full" time="0.002"><properties><property name="test_order" value="1430" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestChunkModel" name="test_text_length_property" time="0.002"><properties><property name="test_order" value="1431" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestChunkModel" name="test_has_embedding_property" time="0.003"><properties><property name="test_order" value="1432" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestChunkModel" name="test_embedding_dimension_property" time="0.003"><properties><property name="test_order" value="1433" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestSearchHitModel" name="test_search_hit_creation" time="0.003"><properties><property name="test_order" value="1434" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestSearchHitModel" name="test_is_high_similarity_property" time="0.003"><properties><property name="test_order" value="1435" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestSearchHitModel" name="test_is_medium_similarity_property" time="0.003"><properties><property name="test_order" value="1436" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestSearchHitModel" name="test_from_chunk_with_path_string" time="0.002"><properties><property name="test_order" value="1437" /></properties></testcase><testcase classname="tests.test_knowledge_simple.TestSearchHitModel" name="test_from_chunk_with_path_object" time="0.003"><properties><property name="test_order" value="1438" /></properties></testcase><testcase classname="tests.test_lazy_imports" name="test_core_imports_work" time="0.003"><properties><property name="test_order" value="1439" /></properties></testcase><testcase classname="tests.test_lazy_imports" name="test_lazy_imports_not_loaded_initially" time="0.003"><properties><property name="test_order" value="1440" /></properties></testcase><testcase classname="tests.test_lazy_imports" name="test_lazy_imports_work_on_demand" time="0.018"><properties><property name="test_order" value="1441" /></properties></testcase><testcase classname="tests.test_lazy_imports" name="test_knowledge_import_doesnt_load_heavy_modules" time="0.003"><properties><property name="test_order" value="1442" /></properties></testcase><testcase classname="tests.test_lazy_imports" name="test_type_checking_imports_available" time="0.004"><properties><property name="test_order" value="1443" /></properties></testcase><testcase classname="tests.test_lazy_imports" name="test_missing_attribute_raises_correct_error" time="0.003"><properties><property name="test_order" value="1444" /></properties></testcase><testcase classname="tests.test_live_providers.TestLiveProviders" name="test_openai_live" time="0.000"><properties><property name="test_order" value="1445" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:29: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestLiveProviders" name="test_groq_live" time="0.000"><properties><property name="test_order" value="1446" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:57: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestLiveProviders" name="test_ollama_live" time="0.000"><properties><property name="test_order" value="1447" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:85: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestLiveProviders" name="test_lmstudio_live" time="0.000"><properties><property name="test_order" value="1448" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:113: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestLiveProviders" name="test_textgen_live" time="0.000"><properties><property name="test_order" value="1449" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:144: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestLiveProviders" name="test_fastchat_live" time="0.000"><properties><property name="test_order" value="1450" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:175: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestLiveProviders" name="test_together_live" time="0.000"><properties><property name="test_order" value="1451" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:300: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestLiveProviders" name="test_create_client_function" time="0.000"><properties><property name="test_order" value="1452" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:234: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestLiveProviders" name="test_json_response_format" time="0.000"><properties><property name="test_order" value="1453" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:257: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestLiveProviders" name="test_batch_prompts" time="0.000"><properties><property name="test_order" value="1454" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:278: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestLiveProviders" name="test_openrouter_live" time="0.000"><properties><property name="test_order" value="1455" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:328: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestProviderDiscovery" name="test_discover_ollama_models_live" time="0.000"><properties><property name="test_order" value="1456" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:382: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestProviderDiscovery" name="test_discover_together_models_live" time="0.000"><properties><property name="test_order" value="1457" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:400: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestProviderDiscovery" name="test_discover_openrouter_models_live" time="0.000"><properties><property name="test_order" value="1458" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:423: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestProviderDiscovery" name="test_discover_lmstudio_models_live" time="0.000"><properties><property name="test_order" value="1459" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:446: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestProviderDiscovery" name="test_discover_text_generation_webui_models_live" time="0.000"><properties><property name="test_order" value="1460" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:467: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestProviderDiscovery" name="test_discover_fastchat_models_live" time="0.000"><properties><property name="test_order" value="1461" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:488: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_live_providers.TestValidationLive" name="test_validate_openai_live" time="0.000"><properties><property name="test_order" value="1462" /></properties><skipped type="pytest.skip" message="Integration tests require RUN_LIVE_AI_TESTS=1">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_live_providers.py:522: Integration tests require RUN_LIVE_AI_TESTS=1</skipped></testcase><testcase classname="tests.test_main.TestMain" name="test_main_import" time="0.003"><properties><property name="test_order" value="1463" /></properties></testcase><testcase classname="tests.test_main.TestMain" name="test_main_module_attributes" time="0.004"><properties><property name="test_order" value="1464" /></properties></testcase><testcase classname="tests.test_main.TestMain" name="test_main_execution" time="0.003"><properties><property name="test_order" value="1465" /></properties></testcase><testcase classname="tests.test_main.TestMain" name="test_cli_import" time="0.003"><properties><property name="test_order" value="1466" /></properties></testcase><testcase classname="tests.test_main_integration" name="test_main_uses_real_models" time="0.012"><properties><property name="test_order" value="1467" /></properties></testcase><testcase classname="tests.test_main_integration" name="test_create_client_vs_aiclient_model_difference" time="0.009"><properties><property name="test_order" value="1468" /></properties></testcase><testcase classname="tests.test_metrics.TestMetricType" name="test_metric_type_values" time="0.003"><properties><property name="test_order" value="1469" /></properties></testcase><testcase classname="tests.test_metrics.TestMetricValue" name="test_metric_value_creation" time="0.002"><properties><property name="test_order" value="1470" /></properties></testcase><testcase classname="tests.test_metrics.TestHistogramBucket" name="test_histogram_bucket_creation" time="0.003"><properties><property name="test_order" value="1471" /></properties></testcase><testcase classname="tests.test_metrics.TestMetricsCollector" name="test_collector_initialization" time="0.003"><properties><property name="test_order" value="1472" /></properties></testcase><testcase classname="tests.test_metrics.TestMetricsCollector" name="test_increment_counter" time="0.003"><properties><property name="test_order" value="1473" /></properties></testcase><testcase classname="tests.test_metrics.TestMetricsCollector" name="test_set_gauge" time="0.003"><properties><property name="test_order" value="1474" /></properties></testcase><testcase classname="tests.test_metrics.TestMetricsCollector" name="test_create_histogram_default_buckets" time="0.003"><properties><property name="test_order" value="1475" /></properties></testcase><testcase classname="tests.test_metrics.TestMetricsCollector" name="test_observe_histogram" time="0.003"><properties><property name="test_order" value="1476" /></properties></testcase><testcase classname="tests.test_metrics.TestMetricsCollector" name="test_record_timer" time="0.003"><properties><property name="test_order" value="1477" /></properties></testcase><testcase classname="tests.test_metrics.TestMetricsCollector" name="test_get_all_metrics" time="0.003"><properties><property name="test_order" value="1478" /></properties></testcase><testcase classname="tests.test_metrics.TestMetricsCollector" name="test_reset" time="0.003"><properties><property name="test_order" value="1479" /></properties></testcase><testcase classname="tests.test_metrics.TestPrometheusExporter" name="test_export_empty_metrics" time="0.003"><properties><property name="test_order" value="1480" /></properties></testcase><testcase classname="tests.test_metrics.TestMetricsRegistry" name="test_singleton_pattern" time="0.002"><properties><property name="test_order" value="1481" /></properties></testcase><testcase classname="tests.test_metrics.TestMetricsRegistry" name="test_record_request" time="0.003"><properties><property name="test_order" value="1482" /></properties></testcase><testcase classname="tests.test_metrics.TestMetricsRegistry" name="test_export_methods" time="0.007"><properties><property name="test_order" value="1483" /></properties></testcase><testcase classname="tests.test_metrics.TestTimer" name="test_timer_context_manager" time="0.015"><properties><property name="test_order" value="1484" /></properties></testcase><testcase classname="tests.test_metrics.TestGlobalMetrics" name="test_global_metrics_instance" time="0.003"><properties><property name="test_order" value="1485" /></properties></testcase><testcase classname="tests.test_metrics.TestIntegration" name="test_complete_workflow" time="0.004"><properties><property name="test_order" value="1486" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricType" name="test_metric_type_values" time="0.003"><properties><property name="test_order" value="1487" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricValue" name="test_metric_value_creation" time="0.003"><properties><property name="test_order" value="1488" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestHistogramBucket" name="test_histogram_bucket_creation" time="0.003"><properties><property name="test_order" value="1489" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_init_default" time="0.003"><properties><property name="test_order" value="1490" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_init_custom_max_history" time="0.003"><properties><property name="test_order" value="1491" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_create_counter" time="0.003"><properties><property name="test_order" value="1492" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_create_counter_with_labels" time="0.003"><properties><property name="test_order" value="1493" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_create_gauge" time="0.003"><properties><property name="test_order" value="1494" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_create_histogram" time="0.004"><properties><property name="test_order" value="1495" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_create_histogram_custom_buckets" time="0.003"><properties><property name="test_order" value="1496" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_increment_counter" time="0.003"><properties><property name="test_order" value="1497" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_increment_counter_with_labels" time="0.003"><properties><property name="test_order" value="1498" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_set_gauge" time="0.003"><properties><property name="test_order" value="1499" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_set_gauge_with_labels" time="0.003"><properties><property name="test_order" value="1500" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_observe_histogram" time="0.003"><properties><property name="test_order" value="1501" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_observe_histogram_auto_create" time="0.003"><properties><property name="test_order" value="1502" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_record_timer" time="0.003"><properties><property name="test_order" value="1503" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_timer_context_manager" time="0.015"><properties><property name="test_order" value="1504" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_make_key" time="0.003"><properties><property name="test_order" value="1505" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_get_all_metrics" time="0.003"><properties><property name="test_order" value="1506" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_reset" time="0.003"><properties><property name="test_order" value="1507" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsCollector" name="test_thread_safety" time="0.003"><properties><property name="test_order" value="1508" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestPrometheusExporter" name="test_export_empty_metrics" time="0.003"><properties><property name="test_order" value="1509" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestPrometheusExporter" name="test_export_with_metrics" time="0.003"><properties><property name="test_order" value="1510" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestOpenTelemetryExporter" name="test_export_empty_metrics" time="0.003"><properties><property name="test_order" value="1511" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestOpenTelemetryExporter" name="test_export_with_metrics" time="0.003"><properties><property name="test_order" value="1512" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestJSONExporter" name="test_export_empty_metrics" time="0.004"><properties><property name="test_order" value="1513" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestJSONExporter" name="test_export_with_metrics" time="0.004"><properties><property name="test_order" value="1514" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsRegistry" name="test_singleton_pattern" time="0.003"><properties><property name="test_order" value="1515" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsRegistry" name="test_initialization" time="0.002"><properties><property name="test_order" value="1516" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsRegistry" name="test_record_request" time="0.003"><properties><property name="test_order" value="1517" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsRegistry" name="test_record_request_failure" time="0.003"><properties><property name="test_order" value="1518" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsRegistry" name="test_cache_operations" time="0.003"><properties><property name="test_order" value="1519" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsRegistry" name="test_provider_operations" time="0.002"><properties><property name="test_order" value="1520" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsRegistry" name="test_system_metrics" time="0.002"><properties><property name="test_order" value="1521" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsRegistry" name="test_export_methods" time="0.007"><properties><property name="test_order" value="1522" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsRegistry" name="test_generic_methods" time="0.003"><properties><property name="test_order" value="1523" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsRegistry" name="test_get_all_metrics_dict" time="0.003"><properties><property name="test_order" value="1524" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMetricsRegistry" name="test_reset" time="0.003"><properties><property name="test_order" value="1525" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestTimer" name="test_timer_functionality" time="0.015"><properties><property name="test_order" value="1526" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestTimer" name="test_timer_with_labels" time="0.016"><properties><property name="test_order" value="1527" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMonitorDecorator" name="test_monitor_successful_function" time="0.015"><properties><property name="test_order" value="1528" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMonitorDecorator" name="test_monitor_failing_function" time="0.003"><properties><property name="test_order" value="1529" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestMonitorDecorator" name="test_monitor_with_token_extraction" time="0.003"><properties><property name="test_order" value="1530" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestGlobalMetrics" name="test_global_metrics_instance" time="0.003"><properties><property name="test_order" value="1531" /></properties></testcase><testcase classname="tests.test_metrics_comprehensive.TestGlobalMetrics" name="test_global_metrics_usage" time="0.002"><properties><property name="test_order" value="1532" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestMetricType" name="test_metric_type_values" time="0.002"><properties><property name="test_order" value="1533" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestMetricsCollector" name="test_collector_initialization" time="0.003"><properties><property name="test_order" value="1534" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestMetricsCollector" name="test_increment_counter" time="0.004"><properties><property name="test_order" value="1535" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestMetricsCollector" name="test_set_gauge" time="0.064"><properties><property name="test_order" value="1536" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestMetricsCollector" name="test_create_histogram_default_buckets" time="0.002"><properties><property name="test_order" value="1537" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestMetricsCollector" name="test_observe_histogram" time="0.002"><properties><property name="test_order" value="1538" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestMetricsCollector" name="test_record_timer" time="0.003"><properties><property name="test_order" value="1539" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestMetricsCollector" name="test_reset" time="0.003"><properties><property name="test_order" value="1540" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestPrometheusExporter" name="test_export_empty_metrics" time="0.003"><properties><property name="test_order" value="1541" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestMetricsRegistry" name="test_singleton_pattern" time="0.002"><properties><property name="test_order" value="1542" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestMetricsRegistry" name="test_record_request" time="0.003"><properties><property name="test_order" value="1543" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestMetricsRegistry" name="test_export_methods" time="0.006"><properties><property name="test_order" value="1544" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestGlobalMetrics" name="test_global_metrics_instance" time="0.003"><properties><property name="test_order" value="1545" /></properties></testcase><testcase classname="tests.test_metrics_simple.TestIntegration" name="test_complete_workflow" time="0.007"><properties><property name="test_order" value="1546" /></properties></testcase><testcase classname="tests.test_minimal_install" name="test_minimal_import_without_openai" time="0.006"><properties><property name="test_order" value="1547" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_creation_minimal" time="0.003"><properties><property name="test_order" value="1548" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_creation_all_fields" time="0.003"><properties><property name="test_order" value="1549" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_with_string_response" time="0.003"><properties><property name="test_order" value="1550" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_with_dict_response" time="0.003"><properties><property name="test_order" value="1551" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_with_error" time="0.003"><properties><property name="test_order" value="1552" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_optional_fields_defaults" time="0.003"><properties><property name="test_order" value="1553" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_validation_missing_required_fields" time="0.003"><properties><property name="test_order" value="1554" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_field_types" time="0.003"><properties><property name="test_order" value="1555" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_serialization" time="0.004"><properties><property name="test_order" value="1556" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_serialization_with_dict_response" time="0.003"><properties><property name="test_order" value="1557" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_deserialization" time="0.003"><properties><property name="test_order" value="1558" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_json_serialization" time="0.004"><properties><property name="test_order" value="1559" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_equality" time="0.002"><properties><property name="test_order" value="1560" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_hash" time="0.003"><properties><property name="test_order" value="1561" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_repr" time="0.003"><properties><property name="test_order" value="1562" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_edge_cases" time="0.003"><properties><property name="test_order" value="1563" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_with_complex_dict_response" time="0.003"><properties><property name="test_order" value="1564" /></properties></testcase><testcase classname="tests.test_models.TestAskResult" name="test_ask_result_immutability" time="0.002"><properties><property name="test_order" value="1565" /></properties></testcase><testcase classname="tests.test_network_blocking" name="test_network_blocked_by_default" time="0.003"><properties><property name="test_order" value="1566" /></properties></testcase><testcase classname="tests.test_network_blocking" name="test_network_allowed_with_fixture" time="0.003"><properties><property name="test_order" value="1567" /></properties></testcase><testcase classname="tests.test_network_blocking" name="test_integration_allows_network" time="0.000"><properties><property name="test_order" value="1568" /></properties><skipped type="pytest.skip" message="need --run-integration option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_network_blocking.py:22: need --run-integration option to run</skipped></testcase><testcase classname="tests.test_offline_functionality.TestNoNetworkScenarios" name="test_ai_client_works_without_network" time="1.051"><properties><property name="test_order" value="1569" /></properties></testcase><testcase classname="tests.test_offline_functionality.TestNoNetworkScenarios" name="test_create_client_with_fake_provider_no_network" time="1.014"><properties><property name="test_order" value="1570" /></properties></testcase><testcase classname="tests.test_offline_functionality.TestNoNetworkScenarios" name="test_imports_work_without_internet" time="0.007"><properties><property name="test_order" value="1571" /></properties></testcase><testcase classname="tests.test_offline_functionality.TestNoNetworkScenarios" name="test_settings_validation_without_network" time="0.006"><properties><property name="test_order" value="1572" /></properties></testcase><testcase classname="tests.test_offline_functionality.TestNoNetworkScenarios" name="test_client_works_with_explicit_provider" time="1.051"><properties><property name="test_order" value="1573" /></properties></testcase><testcase classname="tests.test_offline_functionality.TestProviderErrorHandling" name="test_provider_configuration_error_handling" time="0.006"><properties><property name="test_order" value="1574" /></properties></testcase><testcase classname="tests.test_offline_functionality.TestProviderErrorHandling" name="test_missing_api_key_error_handling" time="1.014"><properties><property name="test_order" value="1575" /></properties></testcase><testcase classname="tests.test_offline_functionality.TestProviderErrorHandling" name="test_provider_fallback_mechanism" time="1.013"><properties><property name="test_order" value="1576" /></properties></testcase><testcase classname="tests.test_offline_functionality.TestProviderErrorHandling" name="test_error_propagation_from_provider" time="1.049"><properties><property name="test_order" value="1577" /></properties></testcase><testcase classname="tests.test_offline_functionality.TestProviderErrorHandling" name="test_graceful_degradation_with_missing_features" time="1.046"><properties><property name="test_order" value="1578" /></properties></testcase><testcase classname="tests.test_offline_functionality.TestOfflineConfiguration" name="test_settings_from_dict_offline" time="0.005"><properties><property name="test_order" value="1579" /></properties></testcase><testcase classname="tests.test_offline_functionality.TestOfflineConfiguration" name="test_environment_variable_override_offline" time="0.006"><properties><property name="test_order" value="1580" /></properties></testcase><testcase classname="tests.test_offline_functionality.TestOfflineConfiguration" name="test_client_configuration_offline" time="1.014"><properties><property name="test_order" value="1581" /></properties></testcase><testcase classname="tests.test_openai_client.TestOpenAIClient" name="test_initialization_default" time="0.004"><properties><property name="test_order" value="1582" /></properties><failure message="AssertionError: assert &lt;MagicMock na...='4546314352'&gt; == &lt;MagicMock na...='4517854704'&gt;&#10;  &#10;  Use -v to get more diff">self = &lt;tests.test_openai_client.TestOpenAIClient object at 0x10cc897f0&gt;

    def test_initialization_default(self):
        """Test client initialization with default parameters."""
        with patch('ai_utilities.openai_client.OpenAI') as mock_openai:
            mock_client_instance = MagicMock()
            mock_openai.return_value = mock_client_instance
    
            client = OpenAIClient(api_key="test-key")
    
&gt;           assert client.client == mock_client_instance
E           AssertionError: assert &lt;MagicMock na...='4546314352'&gt; == &lt;MagicMock na...='4517854704'&gt;
E             
E             Use -v to get more diff

tests/test_openai_client.py:22: AssertionError</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClient" name="test_initialization_custom_params" time="0.003"><properties><property name="test_order" value="1583" /></properties><failure message="AssertionError: assert &lt;MagicMock na...='4546314352'&gt; == &lt;MagicMock na...='4527356896'&gt;&#10;  &#10;  Use -v to get more diff">self = &lt;tests.test_openai_client.TestOpenAIClient object at 0x10cc89af0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4527355312'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_initialization_custom_params(self, mock_openai):
        """Test client initialization with custom parameters."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        client = OpenAIClient(
            api_key="custom-key",
            base_url="https://custom.openai.com",
            timeout=60
        )
    
&gt;       assert client.client == mock_client_instance
E       AssertionError: assert &lt;MagicMock na...='4546314352'&gt; == &lt;MagicMock na...='4527356896'&gt;
E         
E         Use -v to get more diff

tests/test_openai_client.py:43: AssertionError</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClient" name="test_initialization_logging" time="0.003"><properties><property name="test_order" value="1584" /></properties></testcase><testcase classname="tests.test_openai_client.TestOpenAIClient" name="test_create_chat_completion_basic" time="0.004"><properties><property name="test_order" value="1585" /></properties><failure message="AssertionError: assert &lt;MagicMock na...='4545990768'&gt; == &lt;MagicMock na...='4542713968'&gt;&#10;  &#10;  Use -v to get more diff">self = &lt;tests.test_openai_client.TestOpenAIClient object at 0x10cc8e130&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4516868400'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_create_chat_completion_basic(self, mock_openai):
        """Test basic chat completion creation."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        # Mock the chat completion response
        mock_response = MagicMock()
        mock_client_instance.chat.completions.create.return_value = mock_response
    
        client = OpenAIClient(api_key="test-key")
    
        messages = [
            {"role": "system", "content": "You are a helpful assistant."},
            {"role": "user", "content": "Hello, world!"}
        ]
    
        result = client.create_chat_completion(
            model="gpt-3.5-turbo",
            messages=messages
        )
    
        # Verify the result
&gt;       assert result == mock_response
E       AssertionError: assert &lt;MagicMock na...='4545990768'&gt; == &lt;MagicMock na...='4542713968'&gt;
E         
E         Use -v to get more diff

tests/test_openai_client.py:85: AssertionError</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClient" name="test_create_chat_completion_with_max_tokens" time="0.004"><properties><property name="test_order" value="1586" /></properties><failure message="AssertionError: assert &lt;MagicMock na...='4545990768'&gt; == &lt;MagicMock na...='4542163984'&gt;&#10;  &#10;  Use -v to get more diff">self = &lt;tests.test_openai_client.TestOpenAIClient object at 0x10cc49cd0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4530384080'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_create_chat_completion_with_max_tokens(self, mock_openai):
        """Test chat completion with max_tokens parameter."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        mock_response = MagicMock()
        mock_client_instance.chat.completions.create.return_value = mock_response
    
        client = OpenAIClient(api_key="test-key")
    
        messages = [{"role": "user", "content": "Test"}]
    
        result = client.create_chat_completion(
            model="gpt-4",
            messages=messages,
            temperature=0.5,
            max_tokens=100
        )
    
&gt;       assert result == mock_response
E       AssertionError: assert &lt;MagicMock na...='4545990768'&gt; == &lt;MagicMock na...='4542163984'&gt;
E         
E         Use -v to get more diff

tests/test_openai_client.py:115: AssertionError</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClient" name="test_create_chat_completion_with_kwargs" time="0.004"><properties><property name="test_order" value="1587" /></properties><failure message="AssertionError: assert &lt;MagicMock na...='4545990768'&gt; == &lt;MagicMock na...='4542359344'&gt;&#10;  &#10;  Use -v to get more diff">self = &lt;tests.test_openai_client.TestOpenAIClient object at 0x10cbd1f70&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4544977264'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_create_chat_completion_with_kwargs(self, mock_openai):
        """Test chat completion with additional kwargs."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        mock_response = MagicMock()
        mock_client_instance.chat.completions.create.return_value = mock_response
    
        client = OpenAIClient(api_key="test-key")
    
        messages = [{"role": "user", "content": "Test"}]
    
        result = client.create_chat_completion(
            model="gpt-3.5-turbo",
            messages=messages,
            top_p=0.9,
            frequency_penalty=0.5,
            presence_penalty=0.5
        )
    
&gt;       assert result == mock_response
E       AssertionError: assert &lt;MagicMock na...='4545990768'&gt; == &lt;MagicMock na...='4542359344'&gt;
E         
E         Use -v to get more diff

tests/test_openai_client.py:146: AssertionError</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClient" name="test_create_chat_completion_logging" time="0.003"><properties><property name="test_order" value="1588" /></properties><failure message="AssertionError: Expected 'create' to have been called once. Called 0 times.">self = &lt;tests.test_openai_client.TestOpenAIClient object at 0x10cc8e400&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4546633792'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_create_chat_completion_logging(self, mock_openai):
        """Test that chat completion logs debug messages."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        mock_response = MagicMock()
        mock_client_instance.chat.completions.create.return_value = mock_response
    
        client = OpenAIClient(api_key="test-key")
    
        client.create_chat_completion(
            model="gpt-3.5-turbo",
            messages=[{"role": "user", "content": "Test"}]
        )
    
        # Just verify the call was made without errors
&gt;       mock_client_instance.chat.completions.create.assert_called_once()

tests/test_openai_client.py:176: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;MagicMock name='OpenAI().chat.completions.create' id='4546509408'&gt;

    def assert_called_once(self):
        """assert that the mock was called only once.
        """
        if not self.call_count == 1:
            msg = ("Expected '%s' to have been called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
&gt;           raise AssertionError(msg)
E           AssertionError: Expected 'create' to have been called once. Called 0 times.

/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py:886: AssertionError</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClient" name="test_create_chat_completion_api_exception" time="0.004"><properties><property name="test_order" value="1589" /></properties><failure message="Failed: DID NOT RAISE &lt;class 'openai.OpenAIError'&gt;">self = &lt;tests.test_openai_client.TestOpenAIClient object at 0x10cc8e700&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4546339312'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_create_chat_completion_api_exception(self, mock_openai):
        """Test handling of OpenAI API exceptions."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        # Mock API exception
        from openai import OpenAIError
        mock_client_instance.chat.completions.create.side_effect = OpenAIError("API Error")
    
        client = OpenAIClient(api_key="test-key")
    
        with pytest.raises(OpenAIError, match="API Error"):
&gt;           client.create_chat_completion(
                model="gpt-3.5-turbo",
                messages=[{"role": "user", "content": "Test"}]
            )
E           Failed: DID NOT RAISE &lt;class 'openai.OpenAIError'&gt;

tests/test_openai_client.py:191: Failed</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClient" name="test_get_models" time="0.005"><properties><property name="test_order" value="1590" /></properties><failure message="AssertionError: assert &lt;MagicMock na...='4547759408'&gt; == &lt;MagicMock na...='4547875120'&gt;&#10;  &#10;  Use -v to get more diff">self = &lt;tests.test_openai_client.TestOpenAIClient object at 0x10cc8ea00&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4547932992'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_get_models(self, mock_openai):
        """Test getting available models."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        # Mock models response
        mock_models = MagicMock()
        mock_client_instance.models.list.return_value = mock_models
    
        client = OpenAIClient(api_key="test-key")
    
        result = client.get_models()
    
&gt;       assert result == mock_models
E       AssertionError: assert &lt;MagicMock na...='4547759408'&gt; == &lt;MagicMock na...='4547875120'&gt;
E         
E         Use -v to get more diff

tests/test_openai_client.py:210: AssertionError</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClient" name="test_get_models_logging" time="0.003"><properties><property name="test_order" value="1591" /></properties><failure message="AssertionError: Expected 'list' to have been called once. Called 0 times.">self = &lt;tests.test_openai_client.TestOpenAIClient object at 0x10cc8ed00&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4530452416'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_get_models_logging(self, mock_openai):
        """Test that get_models logs debug message."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        mock_client_instance.models.list.return_value = MagicMock()
    
        client = OpenAIClient(api_key="test-key")
        client.get_models()
    
        # Just verify the call was made without errors
&gt;       mock_client_instance.models.list.assert_called_once()

tests/test_openai_client.py:225: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;MagicMock name='OpenAI().models.list' id='4545798544'&gt;

    def assert_called_once(self):
        """assert that the mock was called only once.
        """
        if not self.call_count == 1:
            msg = ("Expected '%s' to have been called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
&gt;           raise AssertionError(msg)
E           AssertionError: Expected 'list' to have been called once. Called 0 times.

/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py:886: AssertionError</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClient" name="test_get_models_api_exception" time="0.003"><properties><property name="test_order" value="1592" /></properties><failure message="Failed: DID NOT RAISE &lt;class 'openai.OpenAIError'&gt;">self = &lt;tests.test_openai_client.TestOpenAIClient object at 0x10cc93040&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4545813808'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_get_models_api_exception(self, mock_openai):
        """Test handling of API exceptions in get_models."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        from openai import OpenAIError
        mock_client_instance.models.list.side_effect = OpenAIError("Models API Error")
    
        client = OpenAIClient(api_key="test-key")
    
        with pytest.raises(OpenAIError, match="Models API Error"):
&gt;           client.get_models()
E           Failed: DID NOT RAISE &lt;class 'openai.OpenAIError'&gt;

tests/test_openai_client.py:239: Failed</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClientIntegration" name="test_single_responsibility_principle" time="0.004"><properties><property name="test_order" value="1593" /></properties><failure message="AssertionError: assert &lt;MagicMock name='OpenAI().chat.completions.create()' id='4545990768'&gt; is &lt;MagicMock name='OpenAI().chat.completions.create()' id='4524827888'&gt;">self = &lt;tests.test_openai_client.TestOpenAIClientIntegration object at 0x10cc934c0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4543315632'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_single_responsibility_principle(self, mock_openai):
        """Test that client only handles API communication."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        mock_response = MagicMock()
        mock_client_instance.chat.completions.create.return_value = mock_response
    
        client = OpenAIClient(api_key="test-key")
    
        # Client should not handle rate limiting, response processing, etc.
        # It should just pass through to the underlying OpenAI client
        messages = [{"role": "user", "content": "Test"}]
    
        result = client.create_chat_completion(
            model="gpt-3.5-turbo",
            messages=messages,
            max_tokens=100,
            top_p=0.9
        )
    
        # Should return exactly what the OpenAI client returns
&gt;       assert result is mock_response
E       AssertionError: assert &lt;MagicMock name='OpenAI().chat.completions.create()' id='4545990768'&gt; is &lt;MagicMock name='OpenAI().chat.completions.create()' id='4524827888'&gt;

tests/test_openai_client.py:268: AssertionError</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClientIntegration" name="test_parameter_validation_delegation" time="0.003"><properties><property name="test_order" value="1594" /></properties><failure message="TypeError: 'NoneType' object is not subscriptable">self = &lt;tests.test_openai_client.TestOpenAIClientIntegration object at 0x10cc937c0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4518485824'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_parameter_validation_delegation(self, mock_openai):
        """Test that parameter validation is delegated to OpenAI client."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        client = OpenAIClient(api_key="test-key")
    
        # Client should not validate parameters - let OpenAI handle it
        # This includes things like temperature range, message format, etc.
        client.create_chat_completion(
            model="any-model",
            messages=[{"role": "any", "content": "content"}],
            temperature=5.0,  # Outside normal range
            invalid_param="should_pass_through"
        )
    
        # Should pass all parameters to OpenAI without validation
&gt;       call_kwargs = mock_client_instance.chat.completions.create.call_args[1]
E       TypeError: 'NoneType' object is not subscriptable

tests/test_openai_client.py:294: TypeError</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClientEdgeCases" name="test_empty_messages_list" time="0.004"><properties><property name="test_order" value="1595" /></properties><failure message="AssertionError: assert &lt;MagicMock na...='4545990768'&gt; == &lt;MagicMock na...='4524152336'&gt;&#10;  &#10;  Use -v to get more diff">self = &lt;tests.test_openai_client.TestOpenAIClientEdgeCases object at 0x10cc93c40&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4543096240'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_empty_messages_list(self, mock_openai):
        """Test with empty messages list."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        mock_response = MagicMock()
        mock_client_instance.chat.completions.create.return_value = mock_response
    
        client = OpenAIClient(api_key="test-key")
    
        result = client.create_chat_completion(
            model="gpt-3.5-turbo",
            messages=[]
        )
    
&gt;       assert result == mock_response
E       AssertionError: assert &lt;MagicMock na...='4545990768'&gt; == &lt;MagicMock na...='4524152336'&gt;
E         
E         Use -v to get more diff

tests/test_openai_client.py:318: AssertionError</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClientEdgeCases" name="test_zero_max_tokens" time="0.004"><properties><property name="test_order" value="1596" /></properties><failure message="AssertionError: assert &lt;MagicMock na...='4545990768'&gt; == &lt;MagicMock na...='4532230560'&gt;&#10;  &#10;  Use -v to get more diff">self = &lt;tests.test_openai_client.TestOpenAIClientEdgeCases object at 0x10cc93f40&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4520417648'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_zero_max_tokens(self, mock_openai):
        """Test with max_tokens=0 (should be passed through)."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        mock_response = MagicMock()
        mock_client_instance.chat.completions.create.return_value = mock_response
    
        client = OpenAIClient(api_key="test-key")
    
        result = client.create_chat_completion(
            model="gpt-3.5-turbo",
            messages=[{"role": "user", "content": "Test"}],
            max_tokens=0
        )
    
&gt;       assert result == mock_response
E       AssertionError: assert &lt;MagicMock na...='4545990768'&gt; == &lt;MagicMock na...='4532230560'&gt;
E         
E         Use -v to get more diff

tests/test_openai_client.py:338: AssertionError</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClientEdgeCases" name="test_none_max_tokens" time="0.004"><properties><property name="test_order" value="1597" /></properties><failure message="AssertionError: assert &lt;MagicMock na...='4545990768'&gt; == &lt;MagicMock na...='4545135520'&gt;&#10;  &#10;  Use -v to get more diff">self = &lt;tests.test_openai_client.TestOpenAIClientEdgeCases object at 0x10cc99280&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4547494624'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_none_max_tokens(self, mock_openai):
        """Test with max_tokens=None (should not be included)."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        mock_response = MagicMock()
        mock_client_instance.chat.completions.create.return_value = mock_response
    
        client = OpenAIClient(api_key="test-key")
    
        result = client.create_chat_completion(
            model="gpt-3.5-turbo",
            messages=[{"role": "user", "content": "Test"}],
            max_tokens=None
        )
    
&gt;       assert result == mock_response
E       AssertionError: assert &lt;MagicMock na...='4545990768'&gt; == &lt;MagicMock na...='4545135520'&gt;
E         
E         Use -v to get more diff

tests/test_openai_client.py:361: AssertionError</failure></testcase><testcase classname="tests.test_openai_client.TestOpenAIClientEdgeCases" name="test_large_number_of_kwargs" time="0.003"><properties><property name="test_order" value="1598" /></properties><failure message="TypeError: 'NoneType' object is not subscriptable">self = &lt;tests.test_openai_client.TestOpenAIClientEdgeCases object at 0x10cc99580&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4526229200'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_large_number_of_kwargs(self, mock_openai):
        """Test with many additional parameters."""
        mock_client_instance = MagicMock()
        mock_openai.return_value = mock_client_instance
    
        mock_response = MagicMock()
        mock_client_instance.chat.completions.create.return_value = mock_response
    
        client = OpenAIClient(api_key="test-key")
    
        many_kwargs = {
            f"param_{i}": f"value_{i}" for i in range(20)
        }
    
        client.create_chat_completion(
            model="gpt-3.5-turbo",
            messages=[{"role": "user", "content": "Test"}],
            **many_kwargs
        )
    
        # All parameters should be passed through
&gt;       call_kwargs = mock_client_instance.chat.completions.create.call_args[1]
E       TypeError: 'NoneType' object is not subscriptable

tests/test_openai_client.py:388: TypeError</failure></testcase><testcase classname="tests.test_openai_model.TestOpenAIModel" name="test_initialization" time="0.005"><properties><property name="test_order" value="1599" /></properties></testcase><testcase classname="tests.test_openai_model.TestOpenAIModel" name="test_initialization_different_model" time="0.005"><properties><property name="test_order" value="1600" /></properties></testcase><testcase classname="tests.test_openai_model.TestOpenAIModel" name="test_ask_ai_success_text_format" time="0.005"><properties><property name="test_order" value="1601" /></properties></testcase><testcase classname="tests.test_openai_model.TestOpenAIModel" name="test_ask_ai_success_json_format" time="0.006"><properties><property name="test_order" value="1602" /></properties></testcase><testcase classname="tests.test_openai_model.TestOpenAIModel" name="test_ask_ai_rate_limit_exceeded" time="0.006"><properties><property name="test_order" value="1603" /></properties></testcase><testcase classname="tests.test_openai_model.TestOpenAIModel" name="test_ask_ai_api_error" time="0.005"><properties><property name="test_order" value="1604" /></properties></testcase><testcase classname="tests.test_openai_model.TestOpenAIModelIntegration" name="test_composition_pattern" time="0.005"><properties><property name="test_order" value="1605" /></properties></testcase><testcase classname="tests.test_openai_model.TestOpenAIModelIntegration" name="test_single_responsibility_coordination" time="0.005"><properties><property name="test_order" value="1606" /></properties></testcase><testcase classname="tests.test_openai_model.TestOpenAIModelEdgeCases" name="test_empty_prompt" time="0.005"><properties><property name="test_order" value="1607" /></properties></testcase><testcase classname="tests.test_openai_model.TestOpenAIModelEdgeCases" name="test_large_token_count" time="0.005"><properties><property name="test_order" value="1608" /></properties></testcase><testcase classname="tests.test_openai_model_complete.TestOpenAIModelComplete" name="test_initialization_success" time="0.004"><properties><property name="test_order" value="1609" /></properties></testcase><testcase classname="tests.test_openai_model_complete.TestOpenAIModelComplete" name="test_initialization_with_different_config_values" time="0.004"><properties><property name="test_order" value="1610" /></properties></testcase><testcase classname="tests.test_openai_model_complete.TestOpenAIModelComplete" name="test_ask_ai_rate_limit_exceeded" time="0.005"><properties><property name="test_order" value="1611" /></properties></testcase><testcase classname="tests.test_openai_model_complete.TestOpenAIModelComplete" name="test_ask_ai_successful_text_response" time="0.004"><properties><property name="test_order" value="1612" /></properties></testcase><testcase classname="tests.test_openai_model_complete.TestOpenAIModelComplete" name="test_ask_ai_successful_json_response" time="0.004"><properties><property name="test_order" value="1613" /></properties></testcase><testcase classname="tests.test_openai_model_complete.TestOpenAIModelComplete" name="test_ask_ai_with_empty_response" time="0.005"><properties><property name="test_order" value="1614" /></properties></testcase><testcase classname="tests.test_openai_model_complete.TestOpenAIModelComplete" name="test_ask_ai_with_whitespace_response" time="0.004"><properties><property name="test_order" value="1615" /></properties></testcase><testcase classname="tests.test_openai_model_complete.TestOpenAIModelComplete" name="test_ask_ai_with_different_token_counts" time="0.004"><properties><property name="test_order" value="1616" /></properties></testcase><testcase classname="tests.test_openai_model_complete.TestOpenAIModelComplete" name="test_debug_logging_on_initialization" time="0.005"><properties><property name="test_order" value="1617" /></properties></testcase><testcase classname="tests.test_openai_model_complete.TestOpenAIModelComplete" name="test_model_attribute_set_correctly" time="0.004"><properties><property name="test_order" value="1618" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_initialization_success" time="0.007"><properties><property name="test_order" value="1619" /></properties><failure message="AssertionError: Expected 'OpenAI' to be called once. Called 0 times.">self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10ccf28e0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4549691136'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_initialization_success(self, mock_openai):
        """Test successful initialization of OpenAIProvider."""
        provider = OpenAIProvider(self.mock_settings)
    
        # Verify OpenAI client is initialized with correct parameters
&gt;       mock_openai.assert_called_once_with(
            api_key="test-api-key",
            base_url="https://api.openai.com/v1",
            timeout=30
        )

tests/test_openai_provider_complete.py:35: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;MagicMock name='OpenAI' id='4549691136'&gt;, args = (), kwargs = {'api_key': 'test-api-key', 'base_url': 'https://api.openai.com/v1', 'timeout': 30}
msg = "Expected 'OpenAI' to be called once. Called 0 times."

    def assert_called_once_with(self, /, *args, **kwargs):
        """assert that the mock was called exactly once and that that call was
        with the specified arguments."""
        if not self.call_count == 1:
            msg = ("Expected '%s' to be called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
&gt;           raise AssertionError(msg)
E           AssertionError: Expected 'OpenAI' to be called once. Called 0 times.

/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py:918: AssertionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_initialization_with_custom_settings" time="0.007"><properties><property name="test_order" value="1620" /></properties><failure message="AssertionError: Expected 'OpenAI' to be called once. Called 0 times.">self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10ccf2c10&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4544827200'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_initialization_with_custom_settings(self, mock_openai):
        """Test initialization with custom settings."""
        custom_settings = Mock()
        custom_settings.api_key = "custom-key"
        custom_settings.base_url = "https://custom.base.url"
        custom_settings.timeout = 60
        custom_settings.model = "gpt-4"
        custom_settings.temperature = 0.5
        custom_settings.max_tokens = 2000
    
        provider = OpenAIProvider(custom_settings)
    
&gt;       mock_openai.assert_called_once_with(
            api_key="custom-key",
            base_url="https://custom.base.url",
            timeout=60
        )

tests/test_openai_provider_complete.py:57: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;MagicMock name='OpenAI' id='4544827200'&gt;, args = (), kwargs = {'api_key': 'custom-key', 'base_url': 'https://custom.base.url', 'timeout': 60}
msg = "Expected 'OpenAI' to be called once. Called 0 times."

    def assert_called_once_with(self, /, *args, **kwargs):
        """assert that the mock was called exactly once and that that call was
        with the specified arguments."""
        if not self.call_count == 1:
            msg = ("Expected '%s' to be called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
&gt;           raise AssertionError(msg)
E           AssertionError: Expected 'OpenAI' to be called once. Called 0 times.

/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py:918: AssertionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_text_response" time="1.356"><properties><property name="test_order" value="1621" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10ec4c220&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...'user', 'content': 'Test prompt'}], 'model': 'gpt-3.5-turbo', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10ccf2f40&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4528440416'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_text_response(self, mock_openai):
        """Test ask method with text response."""
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = "Test response"
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.ask("Test prompt")

tests/test_openai_provider_complete.py:78: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10ec4c220&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...'user', 'content': 'Test prompt'}], 'model': 'gpt-3.5-turbo', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_json_response_gpt4" time="1.274"><properties><property name="test_order" value="1622" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10e12fdf0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...'model': 'gpt-4', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=16, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10ccf82b0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4523910720'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_json_response_gpt4(self, mock_openai):
        """Test ask method with JSON response using GPT-4."""
        # Update settings to GPT-4
        self.mock_settings.model = "gpt-4"
    
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = '{"key": "value"}'
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.ask("Test prompt", return_format="json")

tests/test_openai_provider_complete.py:106: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10e12fdf0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...'model': 'gpt-4', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_json_response_gpt35_turbo" time="1.507"><properties><property name="test_order" value="1623" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10dbb60d0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo... 'gpt-3.5-turbo', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=17, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10ccf85e0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4545008736'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_json_response_gpt35_turbo(self, mock_openai):
        """Test ask method with JSON response using GPT-3.5-turbo."""
        # Update settings to GPT-3.5-turbo
        self.mock_settings.model = "gpt-3.5-turbo"
    
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = '{"result": "success"}'
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.ask("Test prompt", return_format="json")

tests/test_openai_provider_complete.py:135: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10dbb60d0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo... 'gpt-3.5-turbo', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_json_response_claude" time="1.400"><properties><property name="test_order" value="1624" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10d488670&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...claude-3-sonnet', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10ccf86d0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4529604256'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_json_response_claude(self, mock_openai):
        """Test ask method with JSON response using Claude."""
        # Update settings to Claude
        self.mock_settings.model = "claude-3-sonnet"
    
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = '{"data": "test"}'
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.ask("Test prompt", return_format="json")

tests/test_openai_provider_complete.py:164: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10d488670&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...claude-3-sonnet', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_json_response_o1_models" time="1.430"><properties><property name="test_order" value="1625" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10df1e4c0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...l': 'o1-preview', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=16, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10ccf8a00&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4527940272'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_json_response_o1_models(self, mock_openai):
        """Test ask method with JSON response using O1 models."""
        # Update settings to O1
        self.mock_settings.model = "o1-preview"
    
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = '{"output": "result"}'
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.ask("Test prompt", return_format="json")

tests/test_openai_provider_complete.py:193: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10df1e4c0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...l': 'o1-preview', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_json_response_o1_mini" time="1.492"><properties><property name="test_order" value="1626" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10f137610&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...odel': 'o1-mini', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10ccf8d30&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4531665312'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_json_response_o1_mini(self, mock_openai):
        """Test ask method with JSON response using O1-mini."""
        # Update settings to O1-mini
        self.mock_settings.model = "o1-mini"
    
        # Mock OpenAI client response
        mock_client = Mock()
        mock_choice = Mock()
        mock_choice.message.content = '{"mini": "response"}'
        mock_response = Mock()
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.ask("Test prompt", return_format="json")

tests/test_openai_provider_complete.py:222: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10f137610&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...odel': 'o1-mini', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_json_response_custom_model_with_json" time="1.202"><properties><property name="test_order" value="1627" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10d409dc0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...stom-json-model', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=17, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10ccfd0a0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4546761872'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_json_response_custom_model_with_json(self, mock_openai):
        """Test ask method with JSON response using custom model with 'json' in name."""
        # Update settings to custom model
        self.mock_settings.model = "custom-json-model"
    
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = '{"custom": "json"}'
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.ask("Test prompt", return_format="json")

tests/test_openai_provider_complete.py:251: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10d409dc0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...stom-json-model', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_json_response_non_openai_provider" time="1.368"><properties><property name="test_order" value="1628" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10f2e96d0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo... 'gpt-3.5-turbo', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10ccfd3d0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4522436496'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_json_response_non_openai_provider(self, mock_openai):
        """Test ask method with JSON response for non-OpenAI provider."""
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = '{"provider": "custom"}'
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
    
        # Mock the provider_name property to return a non-OpenAI name
        with patch.object(type(provider), 'provider_name', new_callable=lambda: property(lambda self: "custom_provider")):
&gt;           result = provider.ask("Test prompt", return_format="json")

tests/test_openai_provider_complete.py:280: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10f2e96d0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo... 'gpt-3.5-turbo', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_json_response_unsupported_model" time="1.210"><properties><property name="test_order" value="1629" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10d9c1280&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...er', 'content': 'Test prompt'}], 'model': 'text-davinci-003', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=16, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10ccfd700&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4543449552'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_json_response_unsupported_model(self, mock_openai):
        """Test ask method with JSON response using unsupported model."""
        # Update settings to unsupported model
        self.mock_settings.model = "text-davinci-003"
    
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = 'Here is some text with {"json": "content"} embedded'
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.ask("Test prompt", return_format="json")

tests/test_openai_provider_complete.py:309: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10d9c1280&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...er', 'content': 'Test prompt'}], 'model': 'text-davinci-003', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_json_response_invalid_json_in_native_mode" time="1.376"><properties><property name="test_order" value="1630" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10ddf61f0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...'model': 'gpt-4', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=17, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10ccfda30&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4541467616'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_json_response_invalid_json_in_native_mode(self, mock_openai):
        """Test ask method with invalid JSON in native JSON mode."""
        # Update settings to GPT-4 for JSON mode
        self.mock_settings.model = "gpt-4"
    
        # Mock OpenAI client response with invalid JSON
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = "This is not valid JSON"
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.ask("Test prompt", return_format="json")

tests/test_openai_provider_complete.py:338: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10ddf61f0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...'model': 'gpt-4', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_json_response_no_json_found" time="1.290"><properties><property name="test_order" value="1631" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10dcdb0a0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...er', 'content': 'Test prompt'}], 'model': 'text-davinci-003', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10ccfdd60&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4544261232'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_json_response_no_json_found(self, mock_openai):
        """Test ask method with no JSON found in text."""
        # Update settings to unsupported model
        self.mock_settings.model = "text-davinci-003"
    
        # Mock OpenAI client response with no JSON
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = "This is plain text with no JSON"
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.ask("Test prompt", return_format="json")

tests/test_openai_provider_complete.py:359: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10dcdb0a0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...er', 'content': 'Test prompt'}], 'model': 'text-davinci-003', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_with_custom_parameters" time="1.320"><properties><property name="test_order" value="1632" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10d300f70&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...{'role': 'user', 'content': 'Test prompt'}], 'model': 'gpt-4', 'max_tokens': 500, 'temperature': 0.5}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=16, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10cd030d0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4525508112'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_with_custom_parameters(self, mock_openai):
        """Test ask method with custom parameters."""
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = "Custom response"
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.ask(
            "Test prompt",
            model="gpt-4",
            temperature=0.5,
            max_tokens=500,
            return_format="text"
        )

tests/test_openai_provider_complete.py:377: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10d300f70&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...{'role': 'user', 'content': 'Test prompt'}], 'model': 'gpt-4', 'max_tokens': 500, 'temperature': 0.5}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_many_text_responses" time="1.317"><properties><property name="test_order" value="1633" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10d650040&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...': 'user', 'content': 'Prompt 1'}], 'model': 'gpt-3.5-turbo', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=17, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10cd03400&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4532214608'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_many_text_responses(self, mock_openai):
        """Test ask_many method with text responses."""
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = "Response"
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
        prompts = ["Prompt 1", "Prompt 2", "Prompt 3"]
&gt;       results = provider.ask_many(prompts)

tests/test_openai_provider_complete.py:409: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:71: in ask_many
    return [self._ask_single(prompt, return_format, **kwargs) for prompt in prompts]
src/ai_utilities/providers/openai_provider.py:71: in &lt;listcomp&gt;
    return [self._ask_single(prompt, return_format, **kwargs) for prompt in prompts]
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10d650040&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...': 'user', 'content': 'Prompt 1'}], 'model': 'gpt-3.5-turbo', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_many_json_responses" time="1.315"><properties><property name="test_order" value="1634" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10eae47f0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...'model': 'gpt-4', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10cd03730&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4530444416'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_many_json_responses(self, mock_openai):
        """Test ask_many method with JSON responses."""
        # Update settings to GPT-4 for JSON mode
        self.mock_settings.model = "gpt-4"
    
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = '{"result": "success"}'
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
        prompts = ["JSON Prompt 1", "JSON Prompt 2"]
&gt;       results = provider.ask_many(prompts, return_format="json")

tests/test_openai_provider_complete.py:432: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:71: in ask_many
    return [self._ask_single(prompt, return_format, **kwargs) for prompt in prompts]
src/ai_utilities/providers/openai_provider.py:71: in &lt;listcomp&gt;
    return [self._ask_single(prompt, return_format, **kwargs) for prompt in prompts]
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10eae47f0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...'model': 'gpt-4', 'max_tokens': 1000, 'response_format': {'type': 'json_object'}, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_ask_batch_method" time="1.340"><properties><property name="test_order" value="1635" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10e21f670&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...e': 'user', 'content': 'Batch 1'}], 'model': 'gpt-3.5-turbo', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=16, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10cd03a60&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4546356272'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_batch_method(self, mock_openai):
        """Test _ask_batch method directly."""
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = "Batch response"
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
        prompts = ["Batch 1", "Batch 2"]
&gt;       results = provider._ask_batch(prompts)

tests/test_openai_provider_complete.py:452: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:127: in _ask_batch
    result = self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10e21f670&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...e': 'user', 'content': 'Batch 1'}], 'model': 'gpt-3.5-turbo', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_extract_json_valid_json" time="0.007"><properties><property name="test_order" value="1636" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_extract_json_multiple_json_objects" time="0.007"><properties><property name="test_order" value="1637" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_extract_json_invalid_json" time="0.007"><properties><property name="test_order" value="1638" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_extract_json_no_json" time="0.007"><properties><property name="test_order" value="1639" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_extract_json_empty_string" time="0.008"><properties><property name="test_order" value="1640" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_upload_file_success" time="1.341"><properties><property name="test_order" value="1641" /></properties><failure message="ai_utilities.providers.provider_exceptions.FileTransferError: upload failed for provider 'openai': Connection error.">self = &lt;openai.OpenAI object at 0x10f2832b0&gt;, cast_to = &lt;class 'openai.types.file_object.FileObject'&gt;
options = FinalRequestOptions(method='post', url='/files', params={}, headers={'Content-Type': 'multipart/form-data'}, max_retri...a5a2-09af62bf35c0', post_parser=NOT_GIVEN, follow_redirects=None, json_data={'purpose': 'assistants'}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=18, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;ai_utilities.providers.openai_provider.OpenAIProvider object at 0x10f283910&gt;, path = PosixPath('/var/folders/pb/0g20f0ts1ydc5c1x7pd3fmg00000gn/T/tmpb737sdt7.txt')

    def upload_file(
        self, path: Path, *, purpose: str = "assistants", filename: Optional[str] = None, mime_type: Optional[str] = None
    ) -&gt; UploadedFile:
        """Upload a file to OpenAI.
    
        Args:
            path: Path to the file to upload
            purpose: Purpose of the upload (e.g., "assistants", "fine-tune")
            filename: Optional custom filename (defaults to path.name)
            mime_type: Optional MIME type (auto-detected if None)
    
        Returns:
            UploadedFile with metadata about the uploaded file
    
        Raises:
            FileTransferError: If upload fails
        """
        try:
            # Validate input
            if not path.exists():
                raise ValueError(f"File does not exist: {path}")
            if not path.is_file():
                raise ValueError(f"Path is not a file: {path}")
    
            # Determine filename and mime type
            upload_filename = filename or path.name
            upload_mime_type = (
                mime_type or mimetypes.guess_type(str(path))[0] or "application/octet-stream"
            )
    
            # Upload file using OpenAI SDK
            with open(path, "rb") as file:
&gt;               response = self.client.files.create(
                    file=(upload_filename, file, upload_mime_type),
                    purpose=purpose
                )

src/ai_utilities/providers/openai_provider.py:176: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/openai/resources/files.py:122: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10f2832b0&gt;, cast_to = &lt;class 'openai.types.file_object.FileObject'&gt;
options = FinalRequestOptions(method='post', url='/files', params={}, headers={'Content-Type': 'multipart/form-data'}, max_retri...a5a2-09af62bf35c0', post_parser=NOT_GIVEN, follow_redirects=None, json_data={'purpose': 'assistants'}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10cd091f0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4548413472'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_upload_file_success(self, mock_openai):
        """Test successful file upload."""
        # Mock file response
        mock_file_response = Mock()
        mock_file_response.id = "file-123"
        mock_file_response.filename = "test.txt"
        mock_file_response.bytes = 1024
        mock_file_response.purpose = "assistants"
        mock_file_response.created_at = "2024-01-01T00:00:00Z"
    
        # Mock OpenAI client
        mock_client = Mock()
        mock_client.files.create.return_value = mock_file_response
        mock_openai.return_value = mock_client
    
        # Create test file
        test_file = Path("/tmp/test.txt")
    
        # Create a real temporary file for testing
        import tempfile
        with tempfile.NamedTemporaryFile(mode='w', suffix='.txt', delete=False) as temp_file:
            temp_file.write("test content")
            temp_file_path = Path(temp_file.name)
    
        try:
            # Mock the path methods to use our temp file
            with patch.object(Path, 'exists') as mock_exists, \
                 patch.object(Path, 'is_file') as mock_is_file:
                mock_exists.return_value = True
                mock_is_file.return_value = True
    
                provider = OpenAIProvider(self.mock_settings)
&gt;               result = provider.upload_file(temp_file_path)

tests/test_openai_provider_complete.py:544: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;ai_utilities.providers.openai_provider.OpenAIProvider object at 0x10f283910&gt;, path = PosixPath('/var/folders/pb/0g20f0ts1ydc5c1x7pd3fmg00000gn/T/tmpb737sdt7.txt')

    def upload_file(
        self, path: Path, *, purpose: str = "assistants", filename: Optional[str] = None, mime_type: Optional[str] = None
    ) -&gt; UploadedFile:
        """Upload a file to OpenAI.
    
        Args:
            path: Path to the file to upload
            purpose: Purpose of the upload (e.g., "assistants", "fine-tune")
            filename: Optional custom filename (defaults to path.name)
            mime_type: Optional MIME type (auto-detected if None)
    
        Returns:
            UploadedFile with metadata about the uploaded file
    
        Raises:
            FileTransferError: If upload fails
        """
        try:
            # Validate input
            if not path.exists():
                raise ValueError(f"File does not exist: {path}")
            if not path.is_file():
                raise ValueError(f"Path is not a file: {path}")
    
            # Determine filename and mime type
            upload_filename = filename or path.name
            upload_mime_type = (
                mime_type or mimetypes.guess_type(str(path))[0] or "application/octet-stream"
            )
    
            # Upload file using OpenAI SDK
            with open(path, "rb") as file:
                response = self.client.files.create(
                    file=(upload_filename, file, upload_mime_type),
                    purpose=purpose
                )
    
            # Convert to our UploadedFile model
            return UploadedFile(
                file_id=response.id,
                filename=response.filename,
                bytes=response.bytes,
                provider="openai",
                purpose=response.purpose,
                created_at=(
                    datetime.fromisoformat(response.created_at.replace("Z", "+00:00"))
                    if isinstance(response.created_at, str) and response.created_at
                    else datetime.fromtimestamp(response.created_at)
                    if isinstance(response.created_at, (int, float)) and response.created_at
                    else None
                )
            )
    
        except (Exception) as e:
            # Don't wrap validation errors - let them propagate
            if isinstance(e, ValueError) and ("File does not exist" in str(e) or "Path is not a file" in str(e)):
                raise
&gt;           raise FileTransferError("upload", "openai", e) from e
E           ai_utilities.providers.provider_exceptions.FileTransferError: upload failed for provider 'openai': Connection error.

src/ai_utilities/providers/openai_provider.py:201: FileTransferError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_upload_file_with_custom_parameters" time="1.289"><properties><property name="test_order" value="1642" /></properties><failure message="ai_utilities.providers.provider_exceptions.FileTransferError: upload failed for provider 'openai': Connection error.">self = &lt;openai.OpenAI object at 0x10d5f13d0&gt;, cast_to = &lt;class 'openai.types.file_object.FileObject'&gt;
options = FinalRequestOptions(method='post', url='/files', params={}, headers={'Content-Type': 'multipart/form-data'}, max_retri...-afbd-adf31d798a72', post_parser=NOT_GIVEN, follow_redirects=None, json_data={'purpose': 'fine-tune'}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=16, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;ai_utilities.providers.openai_provider.OpenAIProvider object at 0x10d5f1e50&gt;, path = PosixPath('/var/folders/pb/0g20f0ts1ydc5c1x7pd3fmg00000gn/T/tmpvre11j5d.pdf')

    def upload_file(
        self, path: Path, *, purpose: str = "assistants", filename: Optional[str] = None, mime_type: Optional[str] = None
    ) -&gt; UploadedFile:
        """Upload a file to OpenAI.
    
        Args:
            path: Path to the file to upload
            purpose: Purpose of the upload (e.g., "assistants", "fine-tune")
            filename: Optional custom filename (defaults to path.name)
            mime_type: Optional MIME type (auto-detected if None)
    
        Returns:
            UploadedFile with metadata about the uploaded file
    
        Raises:
            FileTransferError: If upload fails
        """
        try:
            # Validate input
            if not path.exists():
                raise ValueError(f"File does not exist: {path}")
            if not path.is_file():
                raise ValueError(f"Path is not a file: {path}")
    
            # Determine filename and mime type
            upload_filename = filename or path.name
            upload_mime_type = (
                mime_type or mimetypes.guess_type(str(path))[0] or "application/octet-stream"
            )
    
            # Upload file using OpenAI SDK
            with open(path, "rb") as file:
&gt;               response = self.client.files.create(
                    file=(upload_filename, file, upload_mime_type),
                    purpose=purpose
                )

src/ai_utilities/providers/openai_provider.py:176: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/openai/resources/files.py:122: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10d5f13d0&gt;, cast_to = &lt;class 'openai.types.file_object.FileObject'&gt;
options = FinalRequestOptions(method='post', url='/files', params={}, headers={'Content-Type': 'multipart/form-data'}, max_retri...-afbd-adf31d798a72', post_parser=NOT_GIVEN, follow_redirects=None, json_data={'purpose': 'fine-tune'}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10cd09880&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4544019616'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_upload_file_with_custom_parameters(self, mock_openai):
        """Test file upload with custom parameters."""
        # Mock file response
        mock_file_response = Mock()
        mock_file_response.id = "file-456"
        mock_file_response.filename = "custom.pdf"
        mock_file_response.bytes = 2048
        mock_file_response.purpose = "fine-tune"
        mock_file_response.created_at = 1704067200  # Unix timestamp
    
        # Mock OpenAI client
        mock_client = Mock()
        mock_client.files.create.return_value = mock_file_response
        mock_openai.return_value = mock_client
    
        # Create a real temporary file for testing
        import tempfile
        with tempfile.NamedTemporaryFile(mode='w', suffix='.pdf', delete=False) as temp_file:
            temp_file.write("pdf content")
            temp_file_path = Path(temp_file.name)
    
        try:
            # Mock the path methods to use our temp file
            with patch.object(Path, 'exists') as mock_exists, \
                 patch.object(Path, 'is_file') as mock_is_file:
                mock_exists.return_value = True
                mock_is_file.return_value = True
    
                provider = OpenAIProvider(self.mock_settings)
&gt;               result = provider.upload_file(
                    temp_file_path,
                    purpose="fine-tune",
                    filename="custom.pdf",
                    mime_type="application/pdf"
                )

tests/test_openai_provider_complete.py:589: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;ai_utilities.providers.openai_provider.OpenAIProvider object at 0x10d5f1e50&gt;, path = PosixPath('/var/folders/pb/0g20f0ts1ydc5c1x7pd3fmg00000gn/T/tmpvre11j5d.pdf')

    def upload_file(
        self, path: Path, *, purpose: str = "assistants", filename: Optional[str] = None, mime_type: Optional[str] = None
    ) -&gt; UploadedFile:
        """Upload a file to OpenAI.
    
        Args:
            path: Path to the file to upload
            purpose: Purpose of the upload (e.g., "assistants", "fine-tune")
            filename: Optional custom filename (defaults to path.name)
            mime_type: Optional MIME type (auto-detected if None)
    
        Returns:
            UploadedFile with metadata about the uploaded file
    
        Raises:
            FileTransferError: If upload fails
        """
        try:
            # Validate input
            if not path.exists():
                raise ValueError(f"File does not exist: {path}")
            if not path.is_file():
                raise ValueError(f"Path is not a file: {path}")
    
            # Determine filename and mime type
            upload_filename = filename or path.name
            upload_mime_type = (
                mime_type or mimetypes.guess_type(str(path))[0] or "application/octet-stream"
            )
    
            # Upload file using OpenAI SDK
            with open(path, "rb") as file:
                response = self.client.files.create(
                    file=(upload_filename, file, upload_mime_type),
                    purpose=purpose
                )
    
            # Convert to our UploadedFile model
            return UploadedFile(
                file_id=response.id,
                filename=response.filename,
                bytes=response.bytes,
                provider="openai",
                purpose=response.purpose,
                created_at=(
                    datetime.fromisoformat(response.created_at.replace("Z", "+00:00"))
                    if isinstance(response.created_at, str) and response.created_at
                    else datetime.fromtimestamp(response.created_at)
                    if isinstance(response.created_at, (int, float)) and response.created_at
                    else None
                )
            )
    
        except (Exception) as e:
            # Don't wrap validation errors - let them propagate
            if isinstance(e, ValueError) and ("File does not exist" in str(e) or "Path is not a file" in str(e)):
                raise
&gt;           raise FileTransferError("upload", "openai", e) from e
E           ai_utilities.providers.provider_exceptions.FileTransferError: upload failed for provider 'openai': Connection error.

src/ai_utilities/providers/openai_provider.py:201: FileTransferError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_upload_file_not_a_file" time="0.007"><properties><property name="test_order" value="1643" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_upload_file_api_error" time="1.324"><properties><property name="test_order" value="1644" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_download_file_success" time="1.290"><properties><property name="test_order" value="1645" /></properties><failure message="ai_utilities.providers.provider_exceptions.FileTransferError: download failed for provider 'openai': Connection error.">self = &lt;openai.OpenAI object at 0x10eb0bb80&gt;, cast_to = &lt;class 'openai._legacy_response.HttpxBinaryResponseContent'&gt;
options = FinalRequestOptions(method='get', url='/files/file-123/content', params={}, headers={'Accept': 'application/binary'}, ...GIVEN, files=None, idempotency_key=None, post_parser=NOT_GIVEN, follow_redirects=None, json_data=None, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;ai_utilities.providers.openai_provider.OpenAIProvider object at 0x10eb0b310&gt;, file_id = 'file-123'

    def download_file(self, file_id: str) -&gt; bytes:
        """Download file content from OpenAI.
    
        Args:
            file_id: ID of the file to download
    
        Returns:
            File content as bytes
    
        Raises:
            FileTransferError: If download fails
        """
        try:
            if not file_id:
                raise ValueError("file_id cannot be empty")
    
            # Download file content using OpenAI SDK
&gt;           response = self.client.files.content(file_id)

src/ai_utilities/providers/openai_provider.py:220: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/openai/resources/files.py:285: in content
    return self._get(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1205: in get
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10eb0bb80&gt;, cast_to = &lt;class 'openai._legacy_response.HttpxBinaryResponseContent'&gt;
options = FinalRequestOptions(method='get', url='/files/file-123/content', params={}, headers={'Accept': 'application/binary'}, ...GIVEN, files=None, idempotency_key=None, post_parser=NOT_GIVEN, follow_redirects=None, json_data=None, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10cd0e250&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4541467136'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_download_file_success(self, mock_openai):
        """Test successful file download."""
        # Mock file content response
        mock_content_response = Mock()
        mock_content_response.content = b"file content"
    
        # Mock OpenAI client
        mock_client = Mock()
        mock_client.files.content.return_value = mock_content_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.download_file("file-123")

tests/test_openai_provider_complete.py:659: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;ai_utilities.providers.openai_provider.OpenAIProvider object at 0x10eb0b310&gt;, file_id = 'file-123'

    def download_file(self, file_id: str) -&gt; bytes:
        """Download file content from OpenAI.
    
        Args:
            file_id: ID of the file to download
    
        Returns:
            File content as bytes
    
        Raises:
            FileTransferError: If download fails
        """
        try:
            if not file_id:
                raise ValueError("file_id cannot be empty")
    
            # Download file content using OpenAI SDK
            response = self.client.files.content(file_id)
    
            # Return the content as bytes
            return response.content
    
        except (Exception) as e:
            # Don't wrap validation errors - let them propagate
            if isinstance(e, ValueError) and "file_id cannot be empty" in str(e):
                raise
&gt;           raise FileTransferError("download", "openai", e) from e
E           ai_utilities.providers.provider_exceptions.FileTransferError: download failed for provider 'openai': Connection error.

src/ai_utilities/providers/openai_provider.py:229: FileTransferError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_download_file_empty_id" time="0.007"><properties><property name="test_order" value="1646" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_download_file_api_error" time="1.246"><properties><property name="test_order" value="1647" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_generate_image_success" time="1.261"><properties><property name="test_order" value="1648" /></properties><failure message="ai_utilities.providers.provider_exceptions.FileTransferError: image generation failed for provider 'openai': Connection error.">self = &lt;openai.OpenAI object at 0x10d5e75e0&gt;, cast_to = &lt;class 'openai.types.images_response.ImagesResponse'&gt;
options = FinalRequestOptions(method='post', url='/images/generations', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, tim...ompt': 'A beautiful sunset', 'model': 'dall-e-3', 'n': 1, 'quality': 'standard', 'size': '1024x1024'}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=16, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;ai_utilities.providers.openai_provider.OpenAIProvider object at 0x10d5e7250&gt;, prompt = 'A beautiful sunset'

    def generate_image(
        self, prompt: str, *, size: Literal["256x256", "512x512", "1024x1024", "1792x1024", "1024x1792"] = "1024x1024",
        quality: Literal["standard", "hd"] = "standard", n: int = 1
    ) -&gt; List[str]:
        """Generate images using OpenAI's DALL-E.
    
        Args:
            prompt: Description of the image to generate
            size: Image size (e.g., "1024x1024", "1792x1024", "1024x1792")
            quality: Image quality ("standard" or "hd")
            n: Number of images to generate (1-10)
    
        Returns:
            List of image URLs
    
        Raises:
            FileTransferError: If image generation fails
        """
        try:
            if not prompt:
                raise ValueError("prompt cannot be empty")
    
            if n &lt; 1 or n &gt; 10:
                raise ValueError("n must be between 1 and 10")
    
            # Generate images using OpenAI SDK
&gt;           response = self.client.images.generate(
                model="dall-e-3",
                prompt=prompt,
                size=size,
                quality=quality,
                n=n
            )

src/ai_utilities/providers/openai_provider.py:257: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/images.py:888: in generate
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10d5e75e0&gt;, cast_to = &lt;class 'openai.types.images_response.ImagesResponse'&gt;
options = FinalRequestOptions(method='post', url='/images/generations', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, tim...ompt': 'A beautiful sunset', 'model': 'dall-e-3', 'n': 1, 'quality': 'standard', 'size': '1024x1024'}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10cd0ebe0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4521206496'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_generate_image_success(self, mock_openai):
        """Test successful image generation."""
        # Mock image response
        mock_image_response = Mock()
        mock_image = Mock()
        mock_image.url = "https://example.com/image1.png"
        mock_image_response.data = [mock_image]
    
        # Mock OpenAI client
        mock_client = Mock()
        mock_client.images.generate.return_value = mock_image_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.generate_image("A beautiful sunset")

tests/test_openai_provider_complete.py:708: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;ai_utilities.providers.openai_provider.OpenAIProvider object at 0x10d5e7250&gt;, prompt = 'A beautiful sunset'

    def generate_image(
        self, prompt: str, *, size: Literal["256x256", "512x512", "1024x1024", "1792x1024", "1024x1792"] = "1024x1024",
        quality: Literal["standard", "hd"] = "standard", n: int = 1
    ) -&gt; List[str]:
        """Generate images using OpenAI's DALL-E.
    
        Args:
            prompt: Description of the image to generate
            size: Image size (e.g., "1024x1024", "1792x1024", "1024x1792")
            quality: Image quality ("standard" or "hd")
            n: Number of images to generate (1-10)
    
        Returns:
            List of image URLs
    
        Raises:
            FileTransferError: If image generation fails
        """
        try:
            if not prompt:
                raise ValueError("prompt cannot be empty")
    
            if n &lt; 1 or n &gt; 10:
                raise ValueError("n must be between 1 and 10")
    
            # Generate images using OpenAI SDK
            response = self.client.images.generate(
                model="dall-e-3",
                prompt=prompt,
                size=size,
                quality=quality,
                n=n
            )
    
            # Extract URLs from response
            image_urls = [image.url for image in response.data]
            return image_urls
    
        except (Exception) as e:
            # Don't wrap validation errors - let them propagate
            if isinstance(e, ValueError) and ("prompt cannot be empty" in str(e) or "n must be between 1 and 10" in str(e)):
                raise
&gt;           raise FileTransferError("image generation", "openai", e) from e
E           ai_utilities.providers.provider_exceptions.FileTransferError: image generation failed for provider 'openai': Connection error.

src/ai_utilities/providers/openai_provider.py:273: FileTransferError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_generate_image_multiple_images" time="1.380"><properties><property name="test_order" value="1649" /></properties><failure message="ai_utilities.providers.provider_exceptions.FileTransferError: image generation failed for provider 'openai': Connection error.">self = &lt;openai.OpenAI object at 0x10d8ec850&gt;, cast_to = &lt;class 'openai.types.images_response.ImagesResponse'&gt;
options = FinalRequestOptions(method='post', url='/images/generations', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, tim...ata={'prompt': 'Three cats', 'model': 'dall-e-3', 'n': 3, 'quality': 'standard', 'size': '1024x1024'}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=17, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;ai_utilities.providers.openai_provider.OpenAIProvider object at 0x10d8ecbe0&gt;, prompt = 'Three cats'

    def generate_image(
        self, prompt: str, *, size: Literal["256x256", "512x512", "1024x1024", "1792x1024", "1024x1792"] = "1024x1024",
        quality: Literal["standard", "hd"] = "standard", n: int = 1
    ) -&gt; List[str]:
        """Generate images using OpenAI's DALL-E.
    
        Args:
            prompt: Description of the image to generate
            size: Image size (e.g., "1024x1024", "1792x1024", "1024x1792")
            quality: Image quality ("standard" or "hd")
            n: Number of images to generate (1-10)
    
        Returns:
            List of image URLs
    
        Raises:
            FileTransferError: If image generation fails
        """
        try:
            if not prompt:
                raise ValueError("prompt cannot be empty")
    
            if n &lt; 1 or n &gt; 10:
                raise ValueError("n must be between 1 and 10")
    
            # Generate images using OpenAI SDK
&gt;           response = self.client.images.generate(
                model="dall-e-3",
                prompt=prompt,
                size=size,
                quality=quality,
                n=n
            )

src/ai_utilities/providers/openai_provider.py:257: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/images.py:888: in generate
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10d8ec850&gt;, cast_to = &lt;class 'openai.types.images_response.ImagesResponse'&gt;
options = FinalRequestOptions(method='post', url='/images/generations', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, tim...ata={'prompt': 'Three cats', 'model': 'dall-e-3', 'n': 3, 'quality': 'standard', 'size': '1024x1024'}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10cd0ef10&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4549225584'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_generate_image_multiple_images(self, mock_openai):
        """Test image generation with multiple images."""
        # Mock image response
        mock_image_response = Mock()
        mock_images = [Mock(url=f"https://example.com/image{i}.png") for i in range(3)]
        mock_image_response.data = mock_images
    
        # Mock OpenAI client
        mock_client = Mock()
        mock_client.images.generate.return_value = mock_image_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.generate_image("Three cats", n=3)

tests/test_openai_provider_complete.py:736: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;ai_utilities.providers.openai_provider.OpenAIProvider object at 0x10d8ecbe0&gt;, prompt = 'Three cats'

    def generate_image(
        self, prompt: str, *, size: Literal["256x256", "512x512", "1024x1024", "1792x1024", "1024x1792"] = "1024x1024",
        quality: Literal["standard", "hd"] = "standard", n: int = 1
    ) -&gt; List[str]:
        """Generate images using OpenAI's DALL-E.
    
        Args:
            prompt: Description of the image to generate
            size: Image size (e.g., "1024x1024", "1792x1024", "1024x1792")
            quality: Image quality ("standard" or "hd")
            n: Number of images to generate (1-10)
    
        Returns:
            List of image URLs
    
        Raises:
            FileTransferError: If image generation fails
        """
        try:
            if not prompt:
                raise ValueError("prompt cannot be empty")
    
            if n &lt; 1 or n &gt; 10:
                raise ValueError("n must be between 1 and 10")
    
            # Generate images using OpenAI SDK
            response = self.client.images.generate(
                model="dall-e-3",
                prompt=prompt,
                size=size,
                quality=quality,
                n=n
            )
    
            # Extract URLs from response
            image_urls = [image.url for image in response.data]
            return image_urls
    
        except (Exception) as e:
            # Don't wrap validation errors - let them propagate
            if isinstance(e, ValueError) and ("prompt cannot be empty" in str(e) or "n must be between 1 and 10" in str(e)):
                raise
&gt;           raise FileTransferError("image generation", "openai", e) from e
E           ai_utilities.providers.provider_exceptions.FileTransferError: image generation failed for provider 'openai': Connection error.

src/ai_utilities/providers/openai_provider.py:273: FileTransferError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_generate_image_custom_parameters" time="1.201"><properties><property name="test_order" value="1650" /></properties><failure message="ai_utilities.providers.provider_exceptions.FileTransferError: image generation failed for provider 'openai': Connection error.">self = &lt;openai.OpenAI object at 0x10ec79370&gt;, cast_to = &lt;class 'openai.types.images_response.ImagesResponse'&gt;
options = FinalRequestOptions(method='post', url='/images/generations', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, tim..., json_data={'prompt': 'HD image', 'model': 'dall-e-3', 'n': 2, 'quality': 'hd', 'size': '1792x1024'}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;ai_utilities.providers.openai_provider.OpenAIProvider object at 0x10ec79580&gt;, prompt = 'HD image'

    def generate_image(
        self, prompt: str, *, size: Literal["256x256", "512x512", "1024x1024", "1792x1024", "1024x1792"] = "1024x1024",
        quality: Literal["standard", "hd"] = "standard", n: int = 1
    ) -&gt; List[str]:
        """Generate images using OpenAI's DALL-E.
    
        Args:
            prompt: Description of the image to generate
            size: Image size (e.g., "1024x1024", "1792x1024", "1024x1792")
            quality: Image quality ("standard" or "hd")
            n: Number of images to generate (1-10)
    
        Returns:
            List of image URLs
    
        Raises:
            FileTransferError: If image generation fails
        """
        try:
            if not prompt:
                raise ValueError("prompt cannot be empty")
    
            if n &lt; 1 or n &gt; 10:
                raise ValueError("n must be between 1 and 10")
    
            # Generate images using OpenAI SDK
&gt;           response = self.client.images.generate(
                model="dall-e-3",
                prompt=prompt,
                size=size,
                quality=quality,
                n=n
            )

src/ai_utilities/providers/openai_provider.py:257: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/images.py:888: in generate
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10ec79370&gt;, cast_to = &lt;class 'openai.types.images_response.ImagesResponse'&gt;
options = FinalRequestOptions(method='post', url='/images/generations', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, tim..., json_data={'prompt': 'HD image', 'model': 'dall-e-3', 'n': 2, 'quality': 'hd', 'size': '1792x1024'}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10cd13280&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4542682688'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_generate_image_custom_parameters(self, mock_openai):
        """Test image generation with custom parameters."""
        # Mock image response
        mock_image_response = Mock()
        mock_image = Mock()
        mock_image.url = "https://example.com/custom.png"
        mock_image_response.data = [mock_image]
    
        # Mock OpenAI client
        mock_client = Mock()
        mock_client.images.generate.return_value = mock_image_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.generate_image(
            "HD image",
            size="1792x1024",
            quality="hd",
            n=2
        )

tests/test_openai_provider_complete.py:768: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;ai_utilities.providers.openai_provider.OpenAIProvider object at 0x10ec79580&gt;, prompt = 'HD image'

    def generate_image(
        self, prompt: str, *, size: Literal["256x256", "512x512", "1024x1024", "1792x1024", "1024x1792"] = "1024x1024",
        quality: Literal["standard", "hd"] = "standard", n: int = 1
    ) -&gt; List[str]:
        """Generate images using OpenAI's DALL-E.
    
        Args:
            prompt: Description of the image to generate
            size: Image size (e.g., "1024x1024", "1792x1024", "1024x1792")
            quality: Image quality ("standard" or "hd")
            n: Number of images to generate (1-10)
    
        Returns:
            List of image URLs
    
        Raises:
            FileTransferError: If image generation fails
        """
        try:
            if not prompt:
                raise ValueError("prompt cannot be empty")
    
            if n &lt; 1 or n &gt; 10:
                raise ValueError("n must be between 1 and 10")
    
            # Generate images using OpenAI SDK
            response = self.client.images.generate(
                model="dall-e-3",
                prompt=prompt,
                size=size,
                quality=quality,
                n=n
            )
    
            # Extract URLs from response
            image_urls = [image.url for image in response.data]
            return image_urls
    
        except (Exception) as e:
            # Don't wrap validation errors - let them propagate
            if isinstance(e, ValueError) and ("prompt cannot be empty" in str(e) or "n must be between 1 and 10" in str(e)):
                raise
&gt;           raise FileTransferError("image generation", "openai", e) from e
E           ai_utilities.providers.provider_exceptions.FileTransferError: image generation failed for provider 'openai': Connection error.

src/ai_utilities/providers/openai_provider.py:273: FileTransferError</failure></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_generate_image_empty_prompt" time="0.007"><properties><property name="test_order" value="1651" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_generate_image_invalid_n" time="0.007"><properties><property name="test_order" value="1652" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_generate_image_api_error" time="1.324"><properties><property name="test_order" value="1653" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_provider_name_property" time="0.009"><properties><property name="test_order" value="1654" /></properties></testcase><testcase classname="tests.test_openai_provider_complete.TestOpenAIProviderComplete" name="test_empty_response_content" time="1.374"><properties><property name="test_order" value="1655" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10de24100&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...'user', 'content': 'Test prompt'}], 'model': 'gpt-3.5-turbo', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=16, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_complete.TestOpenAIProviderComplete object at 0x10cd192b0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4532399312'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_empty_response_content(self, mock_openai):
        """Test handling of empty response content."""
        # Mock OpenAI client response with None content
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = None
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.ask("Test prompt")

tests/test_openai_provider_complete.py:850: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10de24100&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...'user', 'content': 'Test prompt'}], 'model': 'gpt-3.5-turbo', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_final.TestOpenAIProviderFinal" name="test_ask_json_response_unsupported_model_line_107" time="1.218"><properties><property name="test_order" value="1656" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10f308ee0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...er', 'content': 'Test prompt'}], 'model': 'text-davinci-003', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_final.TestOpenAIProviderFinal object at 0x10ccfd7f0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4525690304'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_ask_json_response_unsupported_model_line_107(self, mock_openai):
        """Test ask method with JSON response using unsupported model - covers line 107."""
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = 'Here is some text with {"json": "content"} embedded'
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
&gt;       result = provider.ask("Test prompt", return_format="json")

tests/test_openai_provider_final.py:37: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10f308ee0&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...er', 'content': 'Test prompt'}], 'model': 'text-davinci-003', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_openai_provider_final.TestOpenAIProviderFinal" name="test_provider_name_property_exists" time="0.007"><properties><property name="test_order" value="1657" /></properties></testcase><testcase classname="tests.test_openai_provider_line107.TestOpenAIProviderLine107" name="test_line107_json_extraction_path" time="1.312"><properties><property name="test_order" value="1658" /></properties><failure message="openai.APIConnectionError: Connection error.">self = &lt;openai.OpenAI object at 0x10f0c9910&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...er', 'content': 'Test prompt'}], 'model': 'text-davinci-003', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
&gt;               response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:982: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../../Library/Python/3.9/lib/python/site-packages/httpx/_transports/default.py:250: in handle_request
    resp = self._pool.handle_request(req)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request
    raise exc from None
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request
    response = connection.handle_request(
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:101: in handle_request
    raise exc
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:78: in handle_request
    stream = self._connect(request)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_sync/connection.py:124: in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
../../Library/Python/3.9/lib/python/site-packages/httpcore/_backends/sync.py:208: in connect_tcp
    sock = socket.create_connection(
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py:831: in create_connection
    sock.connect(sa)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;socket.socket fd=17, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 0)&gt;, args = (('172.66.0.243', 443),), kwargs = {}

    def blocked_connect(self, *args, **kwargs):
&gt;       raise RuntimeError("Network connections blocked by default. Use --allow-network or --run-integration to enable.")
E       RuntimeError: Network connections blocked by default. Use --allow-network or --run-integration to enable.

tests/conftest.py:100: RuntimeError

The above exception was the direct cause of the following exception:

self = &lt;tests.test_openai_provider_line107.TestOpenAIProviderLine107 object at 0x10cd1f220&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4528737920'&gt;

    @patch('ai_utilities.providers.openai_provider.OpenAI')
    def test_line107_json_extraction_path(self, mock_openai):
        """Test that line 107 is executed - JSON extraction for unsupported models."""
        # Mock OpenAI client response
        mock_client = Mock()
        mock_response = Mock()
        mock_choice = Mock()
        mock_choice.message.content = 'Response with {"key": "value"} embedded'
        mock_response.choices = [mock_choice]
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        provider = OpenAIProvider(self.mock_settings)
    
        # This should execute line 107: return self._extract_json(result)
&gt;       result = provider.ask("Test prompt", return_format="json")

tests/test_openai_provider_line107.py:39: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/providers/openai_provider.py:58: in ask
    return self._ask_single(prompt, return_format, **kwargs)
src/ai_utilities/providers/openai_provider.py:102: in _ask_single
    response: ChatCompletion = self.client.chat.completions.create(
../../Library/Python/3.9/lib/python/site-packages/openai/_utils/_utils.py:286: in wrapper
    return func(*args, **kwargs)
../../Library/Python/3.9/lib/python/site-packages/openai/resources/chat/completions/completions.py:1192: in create
    return self._post(
../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1259: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;openai.OpenAI object at 0x10f0c9910&gt;, cast_to = &lt;class 'openai.types.chat.chat_completion.ChatCompletion'&gt;
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...er', 'content': 'Test prompt'}], 'model': 'text-davinci-003', 'max_tokens': 1000, 'temperature': 0.7}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -&gt; ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)
    
        # create a copy of the options we were given so that if the
        # options are mutated later &amp; we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()
    
        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)
    
        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)
    
            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)
    
            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth
    
            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects
    
            log.debug("Sending HTTP Request: %s %s", request.method, request.url)
    
            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)
    
                if remaining_retries &gt; 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue
    
                log.debug("Raising connection error")
&gt;               raise APIConnectionError(request=request) from err
E               openai.APIConnectionError: Connection error.

../../Library/Python/3.9/lib/python/site-packages/openai/_base_client.py:1014: APIConnectionError</failure></testcase><testcase classname="tests.test_progress_indicator" name="test_progress_indicator_enabled_by_default" time="0.005"><properties><property name="test_order" value="1659" /></properties></testcase><testcase classname="tests.test_progress_indicator" name="test_progress_indicator_can_be_disabled" time="0.006"><properties><property name="test_order" value="1660" /></properties></testcase><testcase classname="tests.test_progress_indicator" name="test_progress_indicator_context_manager" time="1.012"><properties><property name="test_order" value="1661" /></properties></testcase><testcase classname="tests.test_progress_indicator" name="test_progress_indicator_disabled" time="0.112"><properties><property name="test_order" value="1662" /></properties></testcase><testcase classname="tests.test_progress_indicator" name="test_ai_client_with_progress_indicator" time="1.051"><properties><property name="test_order" value="1663" /></properties></testcase><testcase classname="tests.test_progress_indicator" name="test_ai_client_without_progress_indicator" time="0.045"><properties><property name="test_order" value="1664" /></properties></testcase><testcase classname="tests.test_progress_indicator" name="test_progress_indicator_timing_format" time="1.014"><properties><property name="test_order" value="1665" /></properties></testcase><testcase classname="tests.test_progress_indicator" name="test_progress_indicator_displays_time" time="1.013"><properties><property name="test_order" value="1666" /></properties></testcase><testcase classname="tests.test_progress_indicator" name="test_progress_indicator_enable_disable" time="0.005"><properties><property name="test_order" value="1667" /></properties></testcase><testcase classname="tests.test_progress_indicator" name="test_ask_many_uses_progress_indicator" time="1.049"><properties><property name="test_order" value="1668" /></properties></testcase><testcase classname="tests.test_progress_indicator" name="test_ask_json_uses_progress_indicator" time="1.051"><properties><property name="test_order" value="1669" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_init_default_parameters" time="0.003"><properties><property name="test_order" value="1670" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_init_custom_parameters" time="0.003"><properties><property name="test_order" value="1671" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_context_manager_disabled" time="0.003"><properties><property name="test_order" value="1672" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_context_manager_enabled_start" time="0.004"><properties><property name="test_order" value="1673" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_context_manager_enabled_stop" time="0.005"><properties><property name="test_order" value="1674" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_context_manager_no_start_time" time="0.003"><properties><property name="test_order" value="1675" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_update_display_basic" time="0.004"><properties><property name="test_order" value="1676" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_update_display_time_formatting" time="0.004"><properties><property name="test_order" value="1677" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_update_display_stop_event" time="0.003"><properties><property name="test_order" value="1678" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_update_display_sleep_interval" time="0.004"><properties><property name="test_order" value="1679" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_disable_method" time="0.002"><properties><property name="test_order" value="1680" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_enable_method" time="0.002"><properties><property name="test_order" value="1681" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_toggle_methods" time="0.002"><properties><property name="test_order" value="1682" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_context_manager_thread_cleanup" time="0.004"><properties><property name="test_order" value="1683" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_completion_message_formatting" time="0.004"><properties><property name="test_order" value="1684" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_line_clearing_on_completion" time="0.004"><properties><property name="test_order" value="1685" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_thread_safety" time="0.003"><properties><property name="test_order" value="1686" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_real_time_progression" time="0.004"><properties><property name="test_order" value="1687" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_error_handling_in_context" time="1.012"><properties><property name="test_order" value="1688" /></properties></testcase><testcase classname="tests.test_progress_indicator_comprehensive.TestProgressIndicator" name="test_concurrent_indicators" time="0.016"><properties><property name="test_order" value="1689" /></properties></testcase><testcase classname="tests.test_provider_factory.TestProviderFactory" name="test_create_openai_provider_default" time="0.005"><properties><property name="test_order" value="1690" /></properties></testcase><testcase classname="tests.test_provider_factory.TestProviderFactory" name="test_create_openai_provider_explicit" time="0.005"><properties><property name="test_order" value="1691" /></properties></testcase><testcase classname="tests.test_provider_factory.TestProviderFactory" name="test_create_openai_compatible_provider" time="0.011"><properties><property name="test_order" value="1692" /></properties></testcase><testcase classname="tests.test_provider_factory.TestProviderFactory" name="test_openai_compatible_with_request_timeout_s" time="0.009"><properties><property name="test_order" value="1693" /></properties></testcase><testcase classname="tests.test_provider_factory.TestProviderFactory" name="test_openai_compatible_with_extra_headers" time="0.009"><properties><property name="test_order" value="1694" /></properties></testcase><testcase classname="tests.test_provider_factory.TestProviderFactory" name="test_openai_provider_missing_api_key" time="0.005"><properties><property name="test_order" value="1695" /></properties></testcase><testcase classname="tests.test_provider_factory.TestProviderFactory" name="test_openai_compatible_missing_base_url" time="0.006"><properties><property name="test_order" value="1696" /></properties></testcase><testcase classname="tests.test_provider_factory.TestProviderFactory" name="test_unknown_provider" time="0.005"><properties><property name="test_order" value="1697" /></properties></testcase><testcase classname="tests.test_provider_factory.TestOpenAICompatibleProvider" name="test_initialization_with_base_url" time="0.003"><properties><property name="test_order" value="1698" /></properties></testcase><testcase classname="tests.test_provider_factory.TestOpenAICompatibleProvider" name="test_initialization_with_extra_headers" time="0.003"><properties><property name="test_order" value="1699" /></properties></testcase><testcase classname="tests.test_provider_factory.TestOpenAICompatibleProvider" name="test_ask_text_mode" time="0.004"><properties><property name="test_order" value="1700" /></properties></testcase><testcase classname="tests.test_provider_factory.TestOpenAICompatibleProvider" name="test_ask_json_mode_with_warning" time="0.004"><properties><property name="test_order" value="1701" /></properties></testcase><testcase classname="tests.test_provider_factory.TestOpenAICompatibleProvider" name="test_ask_json_mode_parse_error" time="0.005"><properties><property name="test_order" value="1702" /></properties></testcase><testcase classname="tests.test_provider_factory.TestOpenAICompatibleProvider" name="test_ask_many" time="0.003"><properties><property name="test_order" value="1703" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestProviderProtocol" name="test_fake_provider_text_format" time="0.003"><properties><property name="test_order" value="1704" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestProviderProtocol" name="test_fake_provider_json_format" time="0.003"><properties><property name="test_order" value="1705" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestProviderProtocol" name="test_fake_provider_many_text_format" time="0.004"><properties><property name="test_order" value="1706" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestProviderProtocol" name="test_fake_provider_many_json_format" time="0.003"><properties><property name="test_order" value="1707" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestProviderProtocol" name="test_kwargs_forwarding_fake_provider" time="0.002"><properties><property name="test_order" value="1708" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestProviderProtocol" name="test_kwargs_forwarding_fake_provider_many" time="0.002"><properties><property name="test_order" value="1709" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestAiClientIntegration" name="test_ai_client_text_format" time="1.013"><properties><property name="test_order" value="1710" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestAiClientIntegration" name="test_ai_client_json_format" time="1.017"><properties><property name="test_order" value="1711" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestAiClientIntegration" name="test_ai_client_many_json_format" time="1.015"><properties><property name="test_order" value="1712" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestAiClientIntegration" name="test_ai_client_kwargs_forwarding" time="1.014"><properties><property name="test_order" value="1713" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestAiClientIntegration" name="test_ai_client_many_kwargs_forwarding" time="1.016"><properties><property name="test_order" value="1714" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestRetryBehavior" name="test_ask_many_no_retry" time="1.015"><properties><property name="test_order" value="1715" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestRetryBehavior" name="test_ask_many_with_retry_retries" time="2.019"><properties><property name="test_order" value="1716" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestConcurrencyValidation" name="test_invalid_concurrency_zero" time="0.006"><properties><property name="test_order" value="1717" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestAsyncProviderProtocol" name="test_async_client_json_format" time="0.006"><properties><property name="test_order" value="1718" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestAsyncProviderProtocol" name="test_async_client_kwargs_forwarding" time="0.005"><properties><property name="test_order" value="1719" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestCancellationFriendliness" name="test_cancellation_stops_background_tasks" time="0.173"><properties><property name="test_order" value="1720" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestFailFastCorrectness" name="test_fail_fast_stops_remaining_prompts" time="1.014"><properties><property name="test_order" value="1721" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestPartialFailure" name="test_ask_many_partial_failure" time="1.016"><properties><property name="test_order" value="1722" /></properties></testcase><testcase classname="tests.test_provider_protocol.TestEnvironmentIsolation" name="test_os_environ_unchanged_with_override_env" time="0.006"><properties><property name="test_order" value="1723" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_default_provider_is_openai" time="0.005"><properties><property name="test_order" value="1724" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_explicit_provider_setting" time="0.005"><properties><property name="test_order" value="1725" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_provider_environment_variable" time="0.006"><properties><property name="test_order" value="1726" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_base_url_environment_variable" time="0.005"><properties><property name="test_order" value="1727" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_request_timeout_s_environment_variable" time="0.005"><properties><property name="test_order" value="1728" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_extra_headers_environment_variable" time="0.005"><properties><property name="test_order" value="1729" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_extra_headers_invalid_json" time="0.006"><properties><property name="test_order" value="1730" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_openai_compatible_settings_validation" time="0.005"><properties><property name="test_order" value="1731" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_openai_settings_validation" time="0.005"><properties><property name="test_order" value="1732" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_provider_field_validation" time="0.010"><properties><property name="test_order" value="1733" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_timeout_and_request_timeout_s_interaction" time="0.008"><properties><property name="test_order" value="1734" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_extra_headers_optional" time="0.008"><properties><property name="test_order" value="1735" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_api_key_optional_for_compatible_provider" time="0.005"><properties><property name="test_order" value="1736" /></properties></testcase><testcase classname="tests.test_provider_settings.TestProviderSettings" name="test_settings_with_all_fields" time="0.005"><properties><property name="test_order" value="1737" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactory" name="test_create_openai_provider_default" time="0.006"><properties><property name="test_order" value="1738" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactory" name="test_create_openai_provider_explicit" time="0.005"><properties><property name="test_order" value="1739" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactory" name="test_create_openai_compatible_provider" time="0.009"><properties><property name="test_order" value="1740" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactory" name="test_create_groq_provider" time="0.009"><properties><property name="test_order" value="1741" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactory" name="test_create_together_provider" time="0.010"><properties><property name="test_order" value="1742" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactory" name="test_create_openrouter_provider" time="0.009"><properties><property name="test_order" value="1743" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactory" name="test_create_ollama_provider" time="0.009"><properties><property name="test_order" value="1744" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryErrors" name="test_unknown_provider_error" time="0.005"><properties><property name="test_order" value="1745" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryErrors" name="test_missing_api_key_error" time="0.006"><properties><property name="test_order" value="1746" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryErrors" name="test_invalid_base_url_error" time="0.010"><properties><property name="test_order" value="1747" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryErrors" name="test_missing_model_error" time="0.005"><properties><property name="test_order" value="1748" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderConfiguration" name="test_provider_inherits_settings" time="0.005"><properties><property name="test_order" value="1749" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderConfiguration" name="test_provider_default_values" time="0.006"><properties><property name="test_order" value="1750" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderConfiguration" name="test_provider_specific_base_urls" time="0.012"><properties><property name="test_order" value="1751" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryEdgeCases" name="test_provider_factory_with_none_settings" time="0.003"><properties><property name="test_order" value="1752" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryEdgeCases" name="test_provider_factory_with_minimal_settings" time="0.005"><properties><property name="test_order" value="1753" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryEdgeCases" name="test_provider_factory_case_sensitivity" time="0.006"><properties><property name="test_order" value="1754" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryEdgeCases" name="test_provider_factory_whitespace_handling" time="0.005"><properties><property name="test_order" value="1755" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryIntegration" name="test_provider_with_fake_client" time="0.005"><properties><property name="test_order" value="1756" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryIntegration" name="test_provider_override_with_fake_provider" time="1.014"><properties><property name="test_order" value="1757" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryIntegration" name="test_provider_error_propagation" time="1.011"><properties><property name="test_order" value="1758" /></properties><failure message="Failed: DID NOT RAISE &lt;class 'Exception'&gt;">self = &lt;tests.test_providers_comprehensive.TestProviderFactoryIntegration object at 0x10cdc4be0&gt;, isolated_env = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x10f888eb0&gt;

    def test_provider_error_propagation(self, isolated_env):
        """Test that provider errors are properly propagated."""
        settings = AiSettings(
            provider="openai",
            api_key="invalid-key",
            _env_file=None
        )
    
        provider = create_provider(settings)
        client = AiClient(settings=settings, provider=provider)
    
        # Should raise error when trying to use invalid credentials
        # The exact error type depends on implementation
        with pytest.raises(Exception):
&gt;           client.ask("test")
E           Failed: DID NOT RAISE &lt;class 'Exception'&gt;

tests/test_providers_comprehensive.py:372: Failed</failure></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryConsistency" name="test_provider_factory_deterministic" time="0.005"><properties><property name="test_order" value="1759" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryConsistency" name="test_provider_factory_isolation" time="0.008"><properties><property name="test_order" value="1760" /></properties></testcase><testcase classname="tests.test_providers_comprehensive.TestProviderFactoryConsistency" name="test_provider_factory_thread_safety" time="0.006"><properties><property name="test_order" value="1761" /></properties></testcase><testcase classname="tests.test_providers_contract.TestOpenAIProvider" name="test_provider_name_returns_str" time="0.009"><properties><property name="test_order" value="1762" /></properties></testcase><testcase classname="tests.test_providers_contract.TestOpenAIProvider" name="test_ask_text_returns_str" time="0.006"><properties><property name="test_order" value="1763" /></properties></testcase><testcase classname="tests.test_providers_contract.TestOpenAIProvider" name="test_ask_json_returns_dict_when_json_mode_supported" time="0.006"><properties><property name="test_order" value="1764" /></properties></testcase><testcase classname="tests.test_providers_contract.TestOpenAIProvider" name="test_ask_many_returns_list" time="0.005"><properties><property name="test_order" value="1765" /></properties></testcase><testcase classname="tests.test_providers_contract.TestOpenAIProvider" name="test_capability_dependent_methods_raise_provider_capability_error" time="0.012"><properties><property name="test_order" value="1766" /></properties></testcase><testcase classname="tests.test_providers_contract.TestOpenAIProvider" name="test_injection_of_fake_client_works" time="0.006"><properties><property name="test_order" value="1767" /></properties></testcase><testcase classname="tests.test_providers_contract.TestOpenAICompatibleProvider" name="test_provider_name_returns_str" time="0.008"><properties><property name="test_order" value="1768" /></properties></testcase><testcase classname="tests.test_providers_contract.TestOpenAICompatibleProvider" name="test_requires_base_url" time="0.003"><properties><property name="test_order" value="1769" /></properties></testcase><testcase classname="tests.test_providers_contract.TestOpenAICompatibleProvider" name="test_accepts_base_url" time="0.007"><properties><property name="test_order" value="1770" /></properties></testcase><testcase classname="tests.test_providers_contract.TestOpenAICompatibleProvider" name="test_capability_dependent_methods_raise_provider_capability_error" time="0.006"><properties><property name="test_order" value="1771" /></properties></testcase><testcase classname="tests.test_providers_contract.TestProviderContracts" name="test_all_providers_have_provider_name" time="0.014"><properties><property name="test_order" value="1772" /></properties></testcase><testcase classname="tests.test_providers_contract.TestProviderContracts" name="test_all_providers_implement_base_interface" time="0.012"><properties><property name="test_order" value="1773" /></properties></testcase><testcase classname="tests.test_providers_contract.TestProviderContracts" name="test_all_providers_support_ask_text" time="0.012"><properties><property name="test_order" value="1774" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_full_module_import_structure" time="0.003"><properties><property name="test_order" value="1775" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_lazy_openai_provider_complete_lifecycle" time="0.003"><properties><property name="test_order" value="1776" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_openai_provider_lazy_loading_with_real_imports" time="0.002"><properties><property name="test_order" value="1777" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_provider_factory_integration" time="0.002"><properties><property name="test_order" value="1778" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_exception_hierarchy_complete" time="0.003"><properties><property name="test_order" value="1779" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_base_provider_abstract_interface" time="0.003"><properties><property name="test_order" value="1780" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_openai_compatible_provider_complete_interface" time="0.072"><properties><property name="test_order" value="1781" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_provider_capabilities_complete" time="0.002"><properties><property name="test_order" value="1782" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_lazy_provider_error_propagation_complete" time="0.002"><properties><property name="test_order" value="1783" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_multiple_lazy_provider_access_patterns" time="0.002"><properties><property name="test_order" value="1784" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_module_reload_behavior" time="0.004"><properties><property name="test_order" value="1785" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_concurrent_module_access" time="0.003"><properties><property name="test_order" value="1786" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_memory_efficiency_lazy_loading" time="0.002"><properties><property name="test_order" value="1787" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_provider_module_completeness" time="0.002"><properties><property name="test_order" value="1788" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_integration_with_actual_provider_modules" time="0.003"><properties><property name="test_order" value="1789" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_error_message_quality" time="0.002"><properties><property name="test_order" value="1790" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_lazy_provider_with_complex_attributes" time="0.002"><properties><property name="test_order" value="1791" /></properties></testcase><testcase classname="tests.test_providers_init_comprehensive.TestProvidersInitCompleteIntegration" name="test_provider_module_documentation" time="0.002"><properties><property name="test_order" value="1792" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitImports" name="test_base_provider_import" time="0.003"><properties><property name="test_order" value="1793" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitImports" name="test_openai_compatible_provider_import" time="0.002"><properties><property name="test_order" value="1794" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitImports" name="test_create_provider_import" time="0.002"><properties><property name="test_order" value="1795" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitImports" name="test_provider_capabilities_import" time="0.003"><properties><property name="test_order" value="1796" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitImports" name="test_provider_exceptions_import" time="0.003"><properties><property name="test_order" value="1797" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitImports" name="test_all_exports" time="0.002"><properties><property name="test_order" value="1798" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestOpenAIProviderDirect" name="test_openai_provider_class_available" time="0.003"><properties><property name="test_order" value="1799" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestOpenAIProviderDirect" name="test_openai_provider_import_error" time="0.002"><properties><property name="test_order" value="1800" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestOpenAIProviderDirect" name="test_openai_provider_basic_attributes" time="0.003"><properties><property name="test_order" value="1801" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestOpenAIProviderDirect" name="test_openai_provider_instantiation" time="0.003"><properties><property name="test_order" value="1802" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitIntegration" name="test_provider_creation_import" time="0.002"><properties><property name="test_order" value="1803" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitIntegration" name="test_provider_creation_with_compatible" time="0.003"><properties><property name="test_order" value="1804" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitIntegration" name="test_exception_hierarchy" time="0.003"><properties><property name="test_order" value="1805" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitIntegration" name="test_provider_capabilities_usage" time="0.002"><properties><property name="test_order" value="1806" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitIntegration" name="test_base_provider_as_abstract" time="0.002"><properties><property name="test_order" value="1807" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitIntegration" name="test_openai_compatible_provider_instantiation" time="0.003"><properties><property name="test_order" value="1808" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitEdgeCases" name="test_multiple_openai_provider_access" time="0.003"><properties><property name="test_order" value="1809" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitEdgeCases" name="test_openai_provider_error_handling" time="0.002"><properties><property name="test_order" value="1810" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitEdgeCases" name="test_openai_provider_with_mock" time="0.003"><properties><property name="test_order" value="1811" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitEdgeCases" name="test_import_error_message_format" time="0.003"><properties><property name="test_order" value="1812" /></properties></testcase><testcase classname="tests.test_providers_init_coverage.TestProvidersInitEdgeCases" name="test_all_list_completeness" time="0.003"><properties><property name="test_order" value="1813" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_openai_provider_direct_import" time="0.002"><properties><property name="test_order" value="1814" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_openai_provider_class_behavior" time="0.002"><properties><property name="test_order" value="1815" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_providers_init_module_attributes" time="0.002"><properties><property name="test_order" value="1816" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_openai_provider_error_propagation" time="0.003"><properties><property name="test_order" value="1817" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_openai_provider_multiple_accesses" time="0.003"><properties><property name="test_order" value="1818" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_providers_exception_instantiation" time="0.003"><properties><property name="test_order" value="1819" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_provider_capabilities_class" time="0.002"><properties><property name="test_order" value="1820" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_base_provider_abstract_methods" time="0.003"><properties><property name="test_order" value="1821" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_openai_compatible_provider_structure" time="0.002"><properties><property name="test_order" value="1822" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_create_provider_error_handling" time="0.003"><properties><property name="test_order" value="1823" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_missing_optional_dependency_error_details" time="0.002"><properties><property name="test_order" value="1824" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_provider_capability_error_details" time="0.003"><properties><property name="test_order" value="1825" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_provider_configuration_error_details" time="0.002"><properties><property name="test_order" value="1826" /></properties></testcase><testcase classname="tests.test_providers_init_final" name="test_file_transfer_error_details" time="0.002"><properties><property name="test_order" value="1827" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_imports" time="0.002"><properties><property name="test_order" value="1828" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_all_exports" time="0.003"><properties><property name="test_order" value="1829" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_openai_provider_direct_import" time="0.002"><properties><property name="test_order" value="1830" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_openai_provider_import_error" time="0.002"><properties><property name="test_order" value="1831" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_openai_provider_class_attributes" time="0.003"><properties><property name="test_order" value="1832" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_openai_provider_instantiation" time="0.003"><properties><property name="test_order" value="1833" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_openai_provider_nonexistent_attribute" time="0.003"><properties><property name="test_order" value="1834" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_exception_hierarchy" time="0.003"><properties><property name="test_order" value="1835" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_provider_capabilities" time="0.002"><properties><property name="test_order" value="1836" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_base_provider_is_abstract" time="0.003"><properties><property name="test_order" value="1837" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_openai_compatible_provider" time="0.002"><properties><property name="test_order" value="1838" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_create_provider_function" time="0.002"><properties><property name="test_order" value="1839" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_openai_provider_multiple_access" time="0.003"><properties><property name="test_order" value="1840" /></properties></testcase><testcase classname="tests.test_providers_init_simple" name="test_openai_provider_consistency" time="0.004"><properties><property name="test_order" value="1841" /></properties></testcase><testcase classname="tests.test_public_api" name="test_stable_public_api" time="0.003"><properties><property name="test_order" value="1842" /></properties></testcase><testcase classname="tests.test_public_api" name="test_additional_exports_exist_for_compatibility" time="0.007"><properties><property name="test_order" value="1843" /></properties></testcase><testcase classname="tests.test_public_api" name="test_api_imports_work_correctly" time="0.003"><properties><property name="test_order" value="1844" /></properties></testcase><testcase classname="tests.test_public_api" name="test_no_internal_leaks" time="0.003"><properties><property name="test_order" value="1845" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitInfo" name="test_rate_limit_info_creation" time="0.002"><properties><property name="test_order" value="1846" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitInfo" name="test_to_model_config_normal_values" time="0.003"><properties><property name="test_order" value="1847" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitInfo" name="test_to_model_config_clamped_values" time="0.003"><properties><property name="test_order" value="1848" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitInfo" name="test_to_model_config_minimum_values" time="0.003"><properties><property name="test_order" value="1849" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_initialization" time="0.004"><properties><property name="test_order" value="1850" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_initialization_default_cache_dir" time="0.003"><properties><property name="test_order" value="1851" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_initialization_cache_dir_creation_failure" time="0.004"><properties><property name="test_order" value="1852" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_load_from_cache_no_file" time="0.004"><properties><property name="test_order" value="1853" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_load_from_cache_file_access_error" time="0.004"><properties><property name="test_order" value="1854" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_load_from_cache_expired" time="0.006"><properties><property name="test_order" value="1855" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_load_from_cache_valid" time="0.006"><properties><property name="test_order" value="1856" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_load_from_cache_json_error" time="0.006"><properties><property name="test_order" value="1857" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_save_to_cache" time="0.006"><properties><property name="test_order" value="1858" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_save_to_cache_file_error" time="0.004"><properties><property name="test_order" value="1859" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_get_rate_limits_from_cache" time="0.005"><properties><property name="test_order" value="1860" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_get_rate_limits_force_refresh" time="0.005"><properties><property name="test_order" value="1861" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_get_rate_limits_cache_miss" time="0.005"><properties><property name="test_order" value="1862" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_get_model_rate_limit_found" time="0.004"><properties><property name="test_order" value="1863" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_get_model_rate_limit_not_found" time="0.004"><properties><property name="test_order" value="1864" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcher" name="test_get_model_rate_limit_force_refresh" time="0.005"><properties><property name="test_order" value="1865" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcherIntegration" name="test_full_workflow" time="0.007"><properties><property name="test_order" value="1866" /></properties></testcase><testcase classname="tests.test_rate_limit_fetcher.TestRateLimitFetcherIntegration" name="test_cache_persistence" time="0.006"><properties><property name="test_order" value="1867" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitInfo" name="test_rate_limit_info_creation" time="0.003"><properties><property name="test_order" value="1868" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitInfo" name="test_to_model_config" time="0.003"><properties><property name="test_order" value="1869" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_initialization" time="0.004"><properties><property name="test_order" value="1870" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_initialization_default_cache_dir" time="0.003"><properties><property name="test_order" value="1871" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_get_rate_limits_first_time" time="0.005"><properties><property name="test_order" value="1872" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_get_rate_limits_from_cache" time="0.006"><properties><property name="test_order" value="1873" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_get_rate_limits_cache_expired" time="0.006"><properties><property name="test_order" value="1874" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_get_rate_limits_force_refresh" time="0.007"><properties><property name="test_order" value="1875" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_get_model_rate_limit" time="0.008"><properties><property name="test_order" value="1876" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_fetch_from_response_headers" time="0.004"><properties><property name="test_order" value="1877" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_fetch_from_response_headers_invalid_headers" time="0.004"><properties><property name="test_order" value="1878" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_get_known_rate_limits" time="0.003"><properties><property name="test_order" value="1879" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_clear_cache" time="0.006"><properties><property name="test_order" value="1880" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_get_cache_status_no_cache" time="0.003"><properties><property name="test_order" value="1881" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_get_cache_status_with_cache" time="0.005"><properties><property name="test_order" value="1882" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcher" name="test_cache_age_calculation" time="0.006"><properties><property name="test_order" value="1883" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherErrorHandling" name="test_corrupted_cache_file" time="0.006"><properties><property name="test_order" value="1884" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherErrorHandling" name="test_api_call_failure" time="0.005"><properties><property name="test_order" value="1885" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherErrorHandling" name="test_cache_directory_creation_failure" time="0.005"><properties><property name="test_order" value="1886" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherErrorHandling" name="test_cache_save_failure" time="0.005"><properties><property name="test_order" value="1887" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherErrorHandling" name="test_get_model_rate_limit" time="0.005"><properties><property name="test_order" value="1888" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherErrorHandling" name="test_get_model_rate_limit_force_refresh" time="0.080"><properties><property name="test_order" value="1889" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherErrorHandling" name="test_clear_cache" time="0.006"><properties><property name="test_order" value="1890" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherErrorHandling" name="test_get_cache_status" time="0.005"><properties><property name="test_order" value="1891" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherErrorHandling" name="test_cache_expiration" time="0.006"><properties><property name="test_order" value="1892" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherErrorHandling" name="test_to_model_config_value_clamping" time="0.003"><properties><property name="test_order" value="1893" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherErrorHandling" name="test_cache_file_permissions_error" time="0.005"><properties><property name="test_order" value="1894" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherErrorHandling" name="test_concurrent_cache_access" time="0.006"><properties><property name="test_order" value="1895" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherIntegration" name="test_end_to_end_workflow" time="0.006"><properties><property name="test_order" value="1896" /></properties></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherIntegration" name="test_model_config_conversion_workflow" time="0.006"><properties><property name="test_order" value="1897" /></properties><failure message="pydantic_core._pydantic_core.ValidationError: 2 validation errors for ModelConfig&#10;tokens_per_minute&#10;  Input should be greater than or equal to 1000 [type=greater_than_equal, input_value=1, input_type=int]&#10;    For further information visit https://errors.pydantic.dev/2.12/v/greater_than_equal&#10;tokens_per_day&#10;  Input should be greater than or equal to 10000 [type=greater_than_equal, input_value=720, input_type=int]&#10;    For further information visit https://errors.pydantic.dev/2.12/v/greater_than_equal">self = &lt;tests.test_rate_limit_fetching.TestRateLimitFetcherIntegration object at 0x10ce85f70&gt;

    def test_model_config_conversion_workflow(self):
        """Test conversion to ModelConfig workflow."""
        fetcher = RateLimitFetcher(api_key=self.api_key, cache_dir=self.temp_dir)
    
        # Get rate limits
        limits = fetcher.get_rate_limits()
    
        # Convert to ModelConfig
        model_configs = {}
        for model_name, limit_info in limits.items():
&gt;           model_configs[model_name] = limit_info.to_model_config()

tests/test_rate_limit_fetching.py:632: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = RateLimitInfo(model_name='gpt-3.5-turbo', requests_per_minute=1, tokens_per_minute=1, tokens_per_day=720, last_updated=datetime.datetime(2026, 1, 18, 20, 53, 28, 364100))

    def to_model_config(self) -&gt; ModelConfig:
        """Convert to ModelConfig instance."""
        # Clamp values to ModelConfig constraints
        max_requests_per_minute = 10000
        max_tokens_per_minute = 2000000
        max_tokens_per_day = 50000000
    
&gt;       return ModelConfig(
            requests_per_minute=min(self.requests_per_minute, max_requests_per_minute),
            tokens_per_minute=min(self.tokens_per_minute, max_tokens_per_minute),
            tokens_per_day=min(self.tokens_per_day, max_tokens_per_day)
        )
E       pydantic_core._pydantic_core.ValidationError: 2 validation errors for ModelConfig
E       tokens_per_minute
E         Input should be greater than or equal to 1000 [type=greater_than_equal, input_value=1, input_type=int]
E           For further information visit https://errors.pydantic.dev/2.12/v/greater_than_equal
E       tokens_per_day
E         Input should be greater than or equal to 10000 [type=greater_than_equal, input_value=720, input_type=int]
E           For further information visit https://errors.pydantic.dev/2.12/v/greater_than_equal

src/ai_utilities/rate_limit_fetcher.py:35: ValidationError</failure></testcase><testcase classname="tests.test_rate_limit_fetching.TestRateLimitFetcherIntegration" name="test_cache_expiration_workflow" time="0.008"><properties><property name="test_order" value="1898" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_initialization" time="0.007"><properties><property name="test_order" value="1899" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_load_stats_no_file" time="0.007"><properties><property name="test_order" value="1900" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_load_stats_existing_file" time="0.007"><properties><property name="test_order" value="1901" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_load_stats_invalid_json" time="0.006"><properties><property name="test_order" value="1902" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_save_stats" time="0.006"><properties><property name="test_order" value="1903" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_save_stats_custom_data" time="0.007"><properties><property name="test_order" value="1904" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_reset_daily_usage" time="0.018"><properties><property name="test_order" value="1905" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_check_reset_same_day" time="0.005"><properties><property name="test_order" value="1906" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_check_reset_new_day" time="0.005"><properties><property name="test_order" value="1907" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_can_proceed_within_limits" time="0.005"><properties><property name="test_order" value="1908" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_can_proceed_exceeds_rpm" time="0.006"><properties><property name="test_order" value="1909" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_can_proceed_exceeds_tpm" time="0.005"><properties><property name="test_order" value="1910" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_can_proceed_exceeds_tpd" time="0.004"><properties><property name="test_order" value="1911" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_can_proceed_zero_tokens" time="0.005"><properties><property name="test_order" value="1912" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_record_usage" time="0.005"><properties><property name="test_order" value="1913" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_reset_minute_counters" time="0.004"><properties><property name="test_order" value="1914" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_thread_safety_can_proceed" time="0.004"><properties><property name="test_order" value="1915" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_thread_safety_record_usage" time="0.013"><properties><property name="test_order" value="1916" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_start_reset_timer" time="0.111"><properties><property name="test_order" value="1917" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiter" name="test_integration_workflow" time="0.012"><properties><property name="test_order" value="1918" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiterEdgeCases" name="test_zero_limits" time="0.005"><properties><property name="test_order" value="1919" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiterEdgeCases" name="test_negative_tokens" time="0.007"><properties><property name="test_order" value="1920" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiterEdgeCases" name="test_large_token_count" time="0.008"><properties><property name="test_order" value="1921" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiterEdgeCases" name="test_file_permission_error_on_save" time="0.005"><properties><property name="test_order" value="1922" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiterEdgeCases" name="test_file_permission_error_on_load" time="0.006"><properties><property name="test_order" value="1923" /></properties></testcase><testcase classname="tests.test_rate_limiter.TestRateLimiterEdgeCases" name="test_concurrent_can_proceed_and_record" time="0.009"><properties><property name="test_order" value="1924" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_json_valid_json" time="0.003"><properties><property name="test_order" value="1925" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_json_nested_json" time="0.003"><properties><property name="test_order" value="1926" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_json_no_json" time="0.003"><properties><property name="test_order" value="1927" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_json_invalid_json" time="0.004"><properties><property name="test_order" value="1928" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_json_multiple_json_objects" time="0.002"><properties><property name="test_order" value="1929" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_json_empty_response" time="0.003"><properties><property name="test_order" value="1930" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_json_only_braces" time="0.003"><properties><property name="test_order" value="1931" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_json_with_newlines" time="0.003"><properties><property name="test_order" value="1932" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_is_valid_json_true" time="0.003"><properties><property name="test_order" value="1933" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_is_valid_json_false" time="0.003"><properties><property name="test_order" value="1934" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_is_valid_json_empty_string" time="0.002"><properties><property name="test_order" value="1935" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_is_valid_json_plain_text" time="0.003"><properties><property name="test_order" value="1936" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_is_valid_json_partial_json" time="0.003"><properties><property name="test_order" value="1937" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_is_valid_json_with_extra_text" time="0.002"><properties><property name="test_order" value="1938" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_clean_text_basic" time="0.002"><properties><property name="test_order" value="1939" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_clean_text_with_newlines" time="0.003"><properties><property name="test_order" value="1940" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_clean_text_already_clean" time="0.003"><properties><property name="test_order" value="1941" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_clean_text_empty_string" time="0.003"><properties><property name="test_order" value="1942" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_clean_text_only_whitespace" time="0.003"><properties><property name="test_order" value="1943" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_clean_text_preserve_content" time="0.003"><properties><property name="test_order" value="1944" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_format_response_text" time="0.002"><properties><property name="test_order" value="1945" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_format_response_json" time="0.002"><properties><property name="test_order" value="1946" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_format_response_default_format" time="0.002"><properties><property name="test_order" value="1947" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_format_response_json_no_json" time="0.003"><properties><property name="test_order" value="1948" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_format_response_other_format" time="0.003"><properties><property name="test_order" value="1949" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_code_blocks_no_language" time="0.003"><properties><property name="test_order" value="1950" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_code_blocks_with_language" time="0.003"><properties><property name="test_order" value="1951" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_code_blocks_no_code_blocks" time="0.004"><properties><property name="test_order" value="1952" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_code_blocks_empty_response" time="0.002"><properties><property name="test_order" value="1953" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_code_blocks_nested_backticks" time="0.002"><properties><property name="test_order" value="1954" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_code_blocks_multiline" time="0.003"><properties><property name="test_order" value="1955" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessor" name="test_extract_code_blocks_case_sensitive" time="0.003"><properties><property name="test_order" value="1956" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessorIntegration" name="test_full_workflow_json_response" time="0.003"><properties><property name="test_order" value="1957" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessorIntegration" name="test_full_workflow_text_response" time="0.002"><properties><property name="test_order" value="1958" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessorIntegration" name="test_full_workflow_code_extraction" time="0.002"><properties><property name="test_order" value="1959" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessorIntegration" name="test_complex_response_processing" time="0.003"><properties><property name="test_order" value="1960" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessorEdgeCases" name="test_extract_json_malformed_braces" time="0.003"><properties><property name="test_order" value="1961" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessorEdgeCases" name="test_extract_json_very_large_response" time="0.003"><properties><property name="test_order" value="1962" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessorEdgeCases" name="test_clean_text_unicode_characters" time="0.003"><properties><property name="test_order" value="1963" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessorEdgeCases" name="test_extract_code_blocks_incomplete_blocks" time="0.004"><properties><property name="test_order" value="1964" /></properties></testcase><testcase classname="tests.test_response_processor.TestResponseProcessorEdgeCases" name="test_logging_behavior" time="0.003"><properties><property name="test_order" value="1965" /></properties></testcase><testcase classname="tests.test_settings" name="test_ai_settings_defaults" time="0.005"><properties><property name="test_order" value="1966" /></properties></testcase><testcase classname="tests.test_settings" name="test_ai_settings_from_env_vars" time="0.005"><properties><property name="test_order" value="1967" /></properties></testcase><testcase classname="tests.test_settings" name="test_ai_settings_explicit_override_env" time="0.006"><properties><property name="test_order" value="1968" /></properties></testcase><testcase classname="tests.test_settings" name="test_ai_settings_validation" time="0.015"><properties><property name="test_order" value="1969" /></properties></testcase><testcase classname="tests.test_settings" name="test_ai_settings_from_ini" time="0.008"><properties><property name="test_order" value="1970" /></properties></testcase><testcase classname="tests.test_settings" name="test_ai_settings_from_ini_missing_file" time="0.003"><properties><property name="test_order" value="1971" /></properties></testcase><testcase classname="tests.test_settings" name="test_ai_settings_from_ini_with_env_placeholder" time="0.008"><properties><property name="test_order" value="1972" /></properties></testcase><testcase classname="tests.test_settings" name="test_ai_client_uses_env_vars" time="0.044"><properties><property name="test_order" value="1973" /></properties></testcase><testcase classname="tests.test_settings" name="test_ai_client_explicit_settings_override_env" time="0.005"><properties><property name="test_order" value="1974" /></properties></testcase><testcase classname="tests.test_settings" name="test_ai_client_no_config_file_access" time="0.006"><properties><property name="test_order" value="1975" /></properties></testcase><testcase classname="tests.test_settings" name="test_ai_settings_extra_fields_ignored" time="0.006"><properties><property name="test_order" value="1976" /></properties></testcase><testcase classname="tests.test_settings" name="test_ai_settings_from_toml_style_fallback" time="0.007"><properties><property name="test_order" value="1977" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsDefaults" name="test_ai_settings_defaults" time="0.005"><properties><property name="test_order" value="1978" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsDefaults" name="test_ai_settings_model_validator" time="0.006"><properties><property name="test_order" value="1979" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsEnvironmentVariables" name="test_ai_settings_from_env_vars" time="0.006"><properties><property name="test_order" value="1980" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsEnvironmentVariables" name="test_ai_settings_explicit_override_env" time="0.005"><properties><property name="test_order" value="1981" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsEnvironmentVariables" name="test_ai_settings_env_precedence" time="0.008"><properties><property name="test_order" value="1982" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsEnvironmentVariables" name="test_ai_settings_env_var_type_conversion" time="0.005"><properties><property name="test_order" value="1983" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsValidation" name="test_ai_settings_validation_temperature" time="0.011"><properties><property name="test_order" value="1984" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsValidation" name="test_ai_settings_validation_max_tokens" time="0.010"><properties><property name="test_order" value="1985" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsValidation" name="test_ai_settings_validation_timeout" time="0.010"><properties><property name="test_order" value="1986" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsValidation" name="test_ai_settings_validation_provider" time="0.017"><properties><property name="test_order" value="1987" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsDotEnv" name="test_ai_settings_from_dotenv_file" time="0.011"><properties><property name="test_order" value="1988" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsDotEnv" name="test_ai_settings_dotenv_precedence" time="0.008"><properties><property name="test_order" value="1989" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsDotEnv" name="test_ai_settings_missing_dotenv_file" time="0.005"><properties><property name="test_order" value="1990" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsErrorHandling" name="test_missing_required_config" time="0.005"><properties><property name="test_order" value="1991" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsErrorHandling" name="test_invalid_model_name" time="0.006"><properties><property name="test_order" value="1992" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsErrorHandling" name="test_invalid_base_url" time="0.005"><properties><property name="test_order" value="1993" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsEdgeCases" name="test_empty_string_env_vars" time="0.005"><properties><property name="test_order" value="1994" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsEdgeCases" name="test_whitespace_env_vars" time="0.005"><properties><property name="test_order" value="1995" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsEdgeCases" name="test_very_long_env_vars" time="0.006"><properties><property name="test_order" value="1996" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsEdgeCases" name="test_special_characters_in_env_vars" time="0.005"><properties><property name="test_order" value="1997" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsIntegration" name="test_settings_with_client" time="0.005"><properties><property name="test_order" value="1998" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsIntegration" name="test_settings_isolation_between_instances" time="0.007"><properties><property name="test_order" value="1999" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsIntegration" name="test_settings_immutability_after_creation" time="0.006"><properties><property name="test_order" value="2000" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsConfigurationPrecedence" name="test_full_precedence_order" time="0.008"><properties><property name="test_order" value="2001" /></properties></testcase><testcase classname="tests.test_settings_comprehensive.TestAiSettingsConfigurationPrecedence" name="test_partial_configuration_sources" time="0.005"><properties><property name="test_order" value="2002" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_defaults_fallback" time="0.005"><properties><property name="test_order" value="2003" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_os_environ_overrides_defaults" time="0.006"><properties><property name="test_order" value="2004" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_override_env_overrides_os_environ" time="0.008"><properties><property name="test_order" value="2005" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_init_kwargs_override_all" time="0.005"><properties><property name="test_order" value="2006" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_nested_override_env_merges_and_restores" time="0.010"><properties><property name="test_order" value="2007" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_mapping_max_tokens" time="0.008"><properties><property name="test_order" value="2008" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_mapping_update_check_days" time="0.005"><properties><property name="test_order" value="2009" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_non_specified_override_key_ignored" time="0.005"><properties><property name="test_order" value="2010" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_type_conversion_override_env" time="0.007"><properties><property name="test_order" value="2011" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_error_behavior_invalid_override_values" time="0.003"><properties><property name="test_order" value="2012" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_async_safety_ai_settings_boundary" time="0.073"><properties><property name="test_order" value="2013" /></properties><skipped type="pytest.skip" message="need --run-slow option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_settings_precedence.py:190: need --run-slow option to run</skipped></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_thread_safety_ai_settings_boundary" time="0.000"><properties><property name="test_order" value="2014" /></properties><skipped type="pytest.skip" message="need --run-slow option to run">/Users/steffenrasmussen/PycharmProjects/ai_utilities/tests/test_settings_precedence.py:214: need --run-slow option to run</skipped></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_create_isolated_deprecation_behavior" time="0.005"><properties><property name="test_order" value="2015" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_explicit_precedence_chain" time="0.012"><properties><property name="test_order" value="2016" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestAiSettingsPrecedence" name="test_comprehensive_mapping_coverage" time="0.015"><properties><property name="test_order" value="2017" /></properties></testcase><testcase classname="tests.test_settings_precedence.TestEnvironmentIsolation" name="test_os_environ_unchanged_during_override_env" time="0.006"><properties><property name="test_order" value="2018" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupMode" name="test_setup_mode_values" time="0.002"><properties><property name="test_order" value="2019" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupMode" name="test_setup_mode_creation" time="0.003"><properties><property name="test_order" value="2020" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupResult" name="test_setup_result_creation" time="0.003"><properties><property name="test_order" value="2021" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupResult" name="test_setup_result_with_optional_fields" time="0.003"><properties><property name="test_order" value="2022" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_wizard_initialization" time="0.003"><properties><property name="test_order" value="2023" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_is_interactive_true" time="0.003"><properties><property name="test_order" value="2024" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_is_interactive_false" time="0.003"><properties><property name="test_order" value="2025" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_prompt_with_default" time="0.003"><properties><property name="test_order" value="2026" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_prompt_without_default" time="0.003"><properties><property name="test_order" value="2027" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_prompt_keyboard_interrupt" time="0.003"><properties><property name="test_order" value="2028" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_prompt_eof_error" time="0.003"><properties><property name="test_order" value="2029" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_prompt_choice_with_default" time="0.004"><properties><property name="test_order" value="2030" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_prompt_choice_invalid_then_valid" time="0.003"><properties><property name="test_order" value="2031" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_select_mode_with_provided_mode" time="0.002"><properties><property name="test_order" value="2032" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_select_mode_non_interactive" time="0.003"><properties><property name="test_order" value="2033" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_select_provider_normal_mode" time="0.003"><properties><property name="test_order" value="2034" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_select_provider_enhanced_mode" time="0.003"><properties><property name="test_order" value="2035" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_run_wizard_non_interactive_no_mode" time="0.003"><properties><property name="test_order" value="2036" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_run_wizard_non_interactive_with_mode" time="0.003"><properties><property name="test_order" value="2037" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_run_wizard_non_interactive_env_var_fallback" time="0.004"><properties><property name="test_order" value="2038" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_run_wizard_non_interactive_no_api_key" time="0.003"><properties><property name="test_order" value="2039" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_run_wizard_dry_run" time="0.004"><properties><property name="test_order" value="2040" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_run_wizard_write_dotenv" time="0.007"><properties><property name="test_order" value="2041" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_write_dotenv_creation" time="0.005"><properties><property name="test_order" value="2042" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_build_dotenv_content_openai" time="0.003"><properties><property name="test_order" value="2043" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_build_dotenv_content_custom_base_url" time="0.003"><properties><property name="test_order" value="2044" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizard" name="test_build_dotenv_content_no_api_key" time="0.003"><properties><property name="test_order" value="2045" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestRunSetupWizard" name="test_run_setup_wizard_function" time="0.003"><properties><property name="test_order" value="2046" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestRunSetupWizard" name="test_run_setup_wizard_parameters_passed_through" time="0.003"><properties><property name="test_order" value="2047" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizardEdgeCases" name="test_provider_config_structure" time="0.003"><properties><property name="test_order" value="2048" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizardEdgeCases" name="test_openai_compatible_provider_config" time="0.003"><properties><property name="test_order" value="2049" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizardEdgeCases" name="test_ollama_provider_config" time="0.002"><properties><property name="test_order" value="2050" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizardEdgeCases" name="test_setup_mode_string_conversion" time="0.003"><properties><property name="test_order" value="2051" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizardEdgeCases" name="test_prompt_choice_empty_choices" time="0.003"><properties><property name="test_order" value="2052" /></properties></testcase><testcase classname="tests.test_setup_wizard.TestSetupWizardEdgeCases" name="test_prompt_choice_single_choice" time="0.003"><properties><property name="test_order" value="2053" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardBasic" name="test_setup_wizard_initialization" time="0.003"><properties><property name="test_order" value="2054" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardBasic" name="test_setup_result_dataclass" time="0.002"><properties><property name="test_order" value="2055" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardBasic" name="test_run_setup_wizard_convenience_function" time="0.003"><properties><property name="test_order" value="2056" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardModes" name="test_normal_mode_configuration" time="0.003"><properties><property name="test_order" value="2057" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardModes" name="test_enhanced_mode_configuration" time="0.003"><properties><property name="test_order" value="2058" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardModes" name="test_improved_mode_configuration" time="0.003"><properties><property name="test_order" value="2059" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardModes" name="test_mode_without_api_key" time="0.004"><properties><property name="test_order" value="2060" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardModes" name="test_non_interactive_without_mode" time="0.003"><properties><property name="test_order" value="2061" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardProviders" name="test_provider_configuration_structure" time="0.003"><properties><property name="test_order" value="2062" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardProviders" name="test_openai_provider_config" time="0.002"><properties><property name="test_order" value="2063" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardProviders" name="test_groq_provider_config" time="0.003"><properties><property name="test_order" value="2064" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardProviders" name="test_together_provider_config" time="0.002"><properties><property name="test_order" value="2065" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardProviders" name="test_provider_api_key_priority" time="0.004"><properties><property name="test_order" value="2066" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardFileOperations" name="test_dotenv_file_creation" time="0.006"><properties><property name="test_order" value="2067" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardFileOperations" name="test_dotenv_file_update_preserves_existing" time="0.007"><properties><property name="test_order" value="2068" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardFileOperations" name="test_dotenv_file_permissions_error" time="0.003"><properties><property name="test_order" value="2069" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardFileOperations" name="test_dotenv_directory_creation" time="0.005"><properties><property name="test_order" value="2070" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardFileOperations" name="test_dry_run_does_not_write_file" time="0.003"><properties><property name="test_order" value="2071" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardEnvironmentDetection" name="test_environment_variable_detection" time="0.004"><properties><property name="test_order" value="2072" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardEnvironmentDetection" name="test_environment_variable_validation" time="0.003"><properties><property name="test_order" value="2073" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardEnvironmentDetection" name="test_environment_variable_whitespace_handling" time="0.003"><properties><property name="test_order" value="2074" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardEnvironmentDetection" name="test_multiple_api_keys_priority" time="0.003"><properties><property name="test_order" value="2075" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardErrorHandling" name="test_invalid_dotenv_path" time="0.004"><properties><property name="test_order" value="2076" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardErrorHandling" name="test_corrupted_existing_dotenv" time="0.005"><properties><property name="test_order" value="2077" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardErrorHandling" name="test_unicode_in_dotenv_file" time="0.006"><properties><property name="test_order" value="2078" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardErrorHandling" name="test_very_long_dotenv_file" time="0.010"><properties><property name="test_order" value="2079" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardOutputFormatting" name="test_dotenv_line_formatting" time="0.004"><properties><property name="test_order" value="2080" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardOutputFormatting" name="test_dotenv_comment_generation" time="0.003"><properties><property name="test_order" value="2081" /></properties></testcase><testcase classname="tests.test_setup_wizard_comprehensive.TestSetupWizardOutputFormatting" name="test_configuration_order" time="0.003"><properties><property name="test_order" value="2082" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestOpenAIClient" name="test_initialization" time="0.003"><properties><property name="test_order" value="2083" /></properties><failure message="AttributeError: 'OpenAIClient' object has no attribute 'api_key'">self = &lt;tests.test_single_responsibility_refactoring.TestOpenAIClient object at 0x10cfa4550&gt;

    def test_initialization(self):
        """Test OpenAIClient initialization."""
        client = OpenAIClient(api_key="test-key")
        assert client.client is not None
&gt;       assert client.api_key == "test-key"
E       AttributeError: 'OpenAIClient' object has no attribute 'api_key'

tests/test_single_responsibility_refactoring.py:31: AttributeError</failure></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestOpenAIClient" name="test_initialization_with_custom_base_url" time="0.003"><properties><property name="test_order" value="2084" /></properties><failure message="AttributeError: 'OpenAIClient' object has no attribute 'api_key'">self = &lt;tests.test_single_responsibility_refactoring.TestOpenAIClient object at 0x10cfa4880&gt;

    def test_initialization_with_custom_base_url(self):
        """Test OpenAIClient initialization with custom base URL."""
        client = OpenAIClient(
            api_key="test-key",
            base_url="https://custom.openai.com/v1",
            timeout=60
        )
&gt;       assert client.api_key == "test-key"
E       AttributeError: 'OpenAIClient' object has no attribute 'api_key'

tests/test_single_responsibility_refactoring.py:40: AttributeError</failure></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestOpenAIClient" name="test_create_chat_completion" time="0.003"><properties><property name="test_order" value="2085" /></properties><failure message="AssertionError: Expected 'create' to be called once. Called 0 times.">self = &lt;tests.test_single_responsibility_refactoring.TestOpenAIClient object at 0x10cfa4b80&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4546389664'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_create_chat_completion(self, mock_openai):
        """Test chat completion creation."""
        # Mock the OpenAI response
        mock_response = Mock()
        mock_response.choices = [Mock()]
        mock_response.choices[0].message.content = "Test response"
    
        mock_client = Mock()
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        client = OpenAIClient(api_key="test-key")
        response = client.create_chat_completion(
            model="test-model-1",
            messages=[{"role": "user", "content": "Hello"}],
            temperature=0.5
        )
    
        # Verify the API was called correctly
&gt;       mock_client.chat.completions.create.assert_called_once_with(
            model="test-model-1",
            messages=[{"role": "user", "content": "Hello"}],
            temperature=0.5
        )

tests/test_single_responsibility_refactoring.py:64: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;Mock name='OpenAI().chat.completions.create' id='4557474400'&gt;, args = (), kwargs = {'messages': [{'content': 'Hello', 'role': 'user'}], 'model': 'test-model-1', 'temperature': 0.5}
msg = "Expected 'create' to be called once. Called 0 times."

    def assert_called_once_with(self, /, *args, **kwargs):
        """assert that the mock was called exactly once and that that call was
        with the specified arguments."""
        if not self.call_count == 1:
            msg = ("Expected '%s' to be called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
&gt;           raise AssertionError(msg)
E           AssertionError: Expected 'create' to be called once. Called 0 times.

/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py:918: AssertionError</failure></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestOpenAIClient" name="test_get_models" time="0.003"><properties><property name="test_order" value="2086" /></properties><failure message="AssertionError: Expected 'list' to have been called once. Called 0 times.">self = &lt;tests.test_single_responsibility_refactoring.TestOpenAIClient object at 0x10cfa4e80&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4543765136'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_get_models(self, mock_openai):
        """Test model listing."""
        mock_models = Mock()
        mock_client = Mock()
        mock_client.models.list.return_value = mock_models
        mock_openai.return_value = mock_client
    
        client = OpenAIClient(api_key="test-key")
        models = client.get_models()
    
&gt;       mock_client.models.list.assert_called_once()

tests/test_single_responsibility_refactoring.py:82: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;Mock name='OpenAI().models.list' id='4553496464'&gt;

    def assert_called_once(self):
        """assert that the mock was called only once.
        """
        if not self.call_count == 1:
            msg = ("Expected '%s' to have been called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
&gt;           raise AssertionError(msg)
E           AssertionError: Expected 'list' to have been called once. Called 0 times.

/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py:886: AssertionError</failure></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestResponseProcessor" name="test_extract_json_valid" time="0.003"><properties><property name="test_order" value="2087" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestResponseProcessor" name="test_extract_json_invalid" time="0.002"><properties><property name="test_order" value="2088" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestResponseProcessor" name="test_extract_json_partial" time="0.003"><properties><property name="test_order" value="2089" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestResponseProcessor" name="test_is_valid_json_true" time="0.003"><properties><property name="test_order" value="2090" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestResponseProcessor" name="test_is_valid_json_false" time="0.075"><properties><property name="test_order" value="2091" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestResponseProcessor" name="test_clean_text" time="0.003"><properties><property name="test_order" value="2092" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestResponseProcessor" name="test_format_response_text" time="0.002"><properties><property name="test_order" value="2093" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestResponseProcessor" name="test_format_response_json" time="0.002"><properties><property name="test_order" value="2094" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestResponseProcessor" name="test_extract_code_blocks" time="0.003"><properties><property name="test_order" value="2095" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestTokenCounter" name="test_count_tokens_word_method" time="0.002"><properties><property name="test_order" value="2096" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestTokenCounter" name="test_count_tokens_char_method" time="0.003"><properties><property name="test_order" value="2097" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestTokenCounter" name="test_count_tokens_combined_method" time="0.003"><properties><property name="test_order" value="2098" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestTokenCounter" name="test_count_empty_text" time="0.003"><properties><property name="test_order" value="2099" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestTokenCounter" name="test_count_invalid_method" time="0.002"><properties><property name="test_order" value="2100" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestTokenCounter" name="test_count_message_tokens" time="0.002"><properties><property name="test_order" value="2101" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestTokenCounter" name="test_estimate_response_tokens" time="0.002"><properties><property name="test_order" value="2102" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestTokenCounter" name="test_count_tokens_for_model" time="0.003"><properties><property name="test_order" value="2103" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestTokenCounter" name="test_count_tokens_unknown_model" time="0.003"><properties><property name="test_order" value="2104" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestOpenAIModelRefactoring" name="test_composition_initialization" time="0.004"><properties><property name="test_order" value="2105" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestOpenAIModelRefactoring" name="test_ask_ai_composition_flow" time="0.004"><properties><property name="test_order" value="2106" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestOpenAIModelRefactoring" name="test_ask_ai_rate_limit_exceeded" time="0.005"><properties><property name="test_order" value="2107" /></properties></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestOpenAIModelRefactoring" name="test_clean_response_deprecation_warning" time="0.003"><properties><property name="test_order" value="2108" /></properties><failure message="AttributeError: type object 'OpenAIModel' has no attribute 'clean_response'">self = &lt;tests.test_single_responsibility_refactoring.TestOpenAIModelRefactoring object at 0x10cfbf310&gt;, caplog = &lt;_pytest.logging.LogCaptureFixture object at 0x10f509a30&gt;

    def test_clean_response_deprecation_warning(self, caplog):
        """Test that clean_response shows deprecation warning."""
        caplog.set_level('WARNING')  # Ensure we capture warnings
    
        with patch('ai_utilities.openai_model.ResponseProcessor') as mock_processor:
            mock_processor.extract_json.return_value = '{"test": "data"}'
    
            # Call as static method
&gt;           result = OpenAIModel.clean_response('{"test": "data"}')
E           AttributeError: type object 'OpenAIModel' has no attribute 'clean_response'

tests/test_single_responsibility_refactoring.py:365: AttributeError</failure></testcase><testcase classname="tests.test_single_responsibility_refactoring.TestComponentIntegration" name="test_end_to_end_workflow" time="0.006"><properties><property name="test_order" value="2109" /></properties><failure message="TypeError: the JSON object must be str, bytes or bytearray, not MagicMock">self = &lt;tests.test_single_responsibility_refactoring.TestComponentIntegration object at 0x10cfbf7c0&gt;, mock_openai = &lt;MagicMock name='OpenAI' id='4557292544'&gt;

    @patch('ai_utilities.openai_client.OpenAI')
    def test_end_to_end_workflow(self, mock_openai):
        """Test end-to-end workflow with all components."""
        # Mock OpenAI response
        mock_response = Mock()
        mock_response.choices = [Mock()]
        mock_response.choices[0].message.content = "  {\"answer\": \"test\"}  "
        mock_client = Mock()
        mock_client.chat.completions.create.return_value = mock_response
        mock_openai.return_value = mock_client
    
        # Create components
        api_client = OpenAIClient(api_key="test-key")
        processor = ResponseProcessor()
        counter = TokenCounter()
    
        # Simulate workflow
        prompt = "What is 2+2?"
        tokens = counter.count_tokens_for_model(prompt, "test-model-1")
    
        # API call
        response = api_client.create_chat_completion(
            model="test-model-1",
            messages=[{"role": "user", "content": prompt}]
        )
    
        # Process response
        raw_text = response.choices[0].message.content.strip()
&gt;       formatted_response = processor.format_response(raw_text, "json")

tests/test_single_responsibility_refactoring.py:402: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/response_processor.py:102: in format_response
    return ResponseProcessor.extract_json(response)
src/ai_utilities/response_processor.py:45: in extract_json
    if ResponseProcessor.is_valid_json(json_candidate):
src/ai_utilities/response_processor.py:64: in is_valid_json
    json.loads(text)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

s = &lt;MagicMock name='OpenAI().chat.completions.create().choices.__getitem__().message.content.strip().__getitem__()' id='4531545760'&gt;, cls = None, object_hook = None, parse_float = None, parse_int = None
parse_constant = None, object_pairs_hook = None, kw = {}

    def loads(s, *, cls=None, object_hook=None, parse_float=None,
            parse_int=None, parse_constant=None, object_pairs_hook=None, **kw):
        """Deserialize ``s`` (a ``str``, ``bytes`` or ``bytearray`` instance
        containing a JSON document) to a Python object.
    
        ``object_hook`` is an optional function that will be called with the
        result of any object literal decode (a ``dict``). The return value of
        ``object_hook`` will be used instead of the ``dict``. This feature
        can be used to implement custom decoders (e.g. JSON-RPC class hinting).
    
        ``object_pairs_hook`` is an optional function that will be called with the
        result of any object literal decoded with an ordered list of pairs.  The
        return value of ``object_pairs_hook`` will be used instead of the ``dict``.
        This feature can be used to implement custom decoders.  If ``object_hook``
        is also defined, the ``object_pairs_hook`` takes priority.
    
        ``parse_float``, if specified, will be called with the string
        of every JSON float to be decoded. By default this is equivalent to
        float(num_str). This can be used to use another datatype or parser
        for JSON floats (e.g. decimal.Decimal).
    
        ``parse_int``, if specified, will be called with the string
        of every JSON int to be decoded. By default this is equivalent to
        int(num_str). This can be used to use another datatype or parser
        for JSON integers (e.g. float).
    
        ``parse_constant``, if specified, will be called with one of the
        following strings: -Infinity, Infinity, NaN.
        This can be used to raise an exception if invalid JSON numbers
        are encountered.
    
        To use a custom ``JSONDecoder`` subclass, specify it with the ``cls``
        kwarg; otherwise ``JSONDecoder`` is used.
        """
        if isinstance(s, str):
            if s.startswith('\ufeff'):
                raise JSONDecodeError("Unexpected UTF-8 BOM (decode using utf-8-sig)",
                                      s, 0)
        else:
            if not isinstance(s, (bytes, bytearray)):
&gt;               raise TypeError(f'the JSON object must be str, bytes or bytearray, '
                                f'not {s.__class__.__name__}')
E               TypeError: the JSON object must be str, bytes or bytearray, not MagicMock

/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/__init__.py:339: TypeError</failure></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_ai_settings_update_check_days_default" time="0.005"><properties><property name="test_order" value="2110" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_ai_settings_update_check_days_from_env" time="0.005"><properties><property name="test_order" value="2111" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_ai_settings_update_check_days_explicit" time="0.005"><properties><property name="test_order" value="2112" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_ai_settings_update_check_days_validation" time="0.013"><properties><property name="test_order" value="2113" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_should_check_for_updates_no_cache" time="0.003"><properties><property name="test_order" value="2114" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_should_check_for_updates_old_cache" time="0.006"><properties><property name="test_order" value="2115" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_should_check_for_updates_recent_cache" time="0.005"><properties><property name="test_order" value="2116" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_check_for_updates_cached_result" time="0.006"><properties><property name="test_order" value="2117" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_smart_setup_missing_api_key" time="0.003"><properties><property name="test_order" value="2118" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_smart_setup_with_api_key" time="0.008"><properties><property name="test_order" value="2119" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_ai_client_initialization_with_provider" time="0.044"><properties><property name="test_order" value="2120" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_ai_client_check_for_updates" time="0.048"><properties><property name="test_order" value="2121" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_ai_client_check_for_updates_force" time="0.048"><properties><property name="test_order" value="2122" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_ai_client_check_for_updates_no_api_key" time="0.045"><properties><property name="test_order" value="2123" /></properties><failure message="AssertionError: assert 'error' in {'cached': True, 'current_models': ['babbage-002', 'chatgpt-4o-latest', 'chatgpt-image-latest', 'codex-mini-latest', 'dall-e-2', 'dall-e-3', ...], 'has_updates': True, 'last_check': '2025-12-28T10:02:01.437983', ...}">self = &lt;tests.test_smart_setup.TestSmartSetup object at 0x10cfd22b0&gt;

    def test_ai_client_check_for_updates_no_api_key(self):
        """Test AiClient.check_for_updates when no API key is configured."""
        fake_provider = FakeProvider()
        client = AiClient(provider=fake_provider)
    
        result = client.check_for_updates()
    
&gt;       assert 'error' in result
E       AssertionError: assert 'error' in {'cached': True, 'current_models': ['babbage-002', 'chatgpt-4o-latest', 'chatgpt-image-latest', 'codex-mini-latest', 'dall-e-2', 'dall-e-3', ...], 'has_updates': True, 'last_check': '2025-12-28T10:02:01.437983', ...}

tests/test_smart_setup.py:181: AssertionError</failure></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_ai_client_reconfigure" time="0.046"><properties><property name="test_order" value="2124" /></properties></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_validate_model_availability" time="2.696"><properties><property name="test_order" value="2125" /></properties><failure message="assert True is False">self = &lt;tests.test_smart_setup.TestSmartSetup object at 0x10cfcc2e0&gt;

    def test_validate_model_availability(self):
        """Test dynamic model validation."""
        # Test with mock API
        with patch('openai.OpenAI') as mock_openai:
            mock_client = MagicMock()
            mock_models = MagicMock()
            mock_models.data = [
                MagicMock(id="test-model-1"),
                MagicMock(id="test-model-2"),
                MagicMock(id="test-model-1o")
            ]
            mock_client.models.list.return_value = mock_models
            mock_openai.return_value = mock_client
    
            # Test existing model
            result = AiSettings.validate_model_availability("test-key", "test-model-1")
            assert result is True
    
            # Test non-existing model
            result = AiSettings.validate_model_availability("test-key", "gpt-5")
&gt;           assert result is False
E           assert True is False

tests/test_smart_setup.py:219: AssertionError</failure></testcase><testcase classname="tests.test_smart_setup.TestSmartSetup" name="test_cache_file_structure" time="0.005"><properties><property name="test_order" value="2126" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestSqliteCacheBasics" name="test_sqlite_cache_roundtrip_get_set_namespaced" time="0.043"><properties><property name="test_order" value="2127" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestSqliteCacheBasics" name="test_sqlite_cache_clear_only_namespace" time="0.048"><properties><property name="test_order" value="2128" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestSqliteCacheBasics" name="test_sqlite_cache_persists_across_instances_same_namespace" time="0.027"><properties><property name="test_order" value="2129" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestSqliteCacheBasics" name="test_sqlite_cache_ttl_expiry_namespace_scoped" time="1.203"><properties><property name="test_order" value="2130" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestSqliteCacheBasics" name="test_sqlite_cache_prunes_lru_per_namespace" time="0.258"><properties><property name="test_order" value="2131" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestSqliteCacheBasics" name="test_sqlite_cache_json_serialization" time="0.030"><properties><property name="test_order" value="2132" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestSqliteCacheBasics" name="test_sqlite_cache_non_serializable_error" time="0.009"><properties><property name="test_order" value="2133" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestNamespaceHelpers" name="test_sanitize_namespace" time="0.003"><properties><property name="test_order" value="2134" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestNamespaceHelpers" name="test_default_namespace" time="0.006"><properties><property name="test_order" value="2135" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestNamespaceHelpers" name="test_default_namespace_under_pytest" time="0.003"><properties><property name="test_order" value="2136" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestNamespaceHelpers" name="test_running_under_pytest" time="0.003"><properties><property name="test_order" value="2137" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestAiClientSqliteIntegration" name="test_aiclient_uses_sqlite_cache_with_namespace" time="4.048"><properties><property name="test_order" value="2138" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestAiClientSqliteIntegration" name="test_aiclient_sqlite_disabled_by_default_in_pytest_without_path" time="2.024"><properties><property name="test_order" value="2139" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestAiClientSqliteIntegration" name="test_aiclient_sqlite_enabled_with_explicit_path_in_pytest" time="2.029"><properties><property name="test_order" value="2140" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestAiClientSqliteIntegration" name="test_aiclient_sqlite_with_custom_settings" time="0.014"><properties><property name="test_order" value="2141" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestAiClientSqliteIntegration" name="test_aiclient_cache_settings_excluded_from_provider_params" time="1.024"><properties><property name="test_order" value="2142" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestSqliteCacheEdgeCases" name="test_clear_all_namespaces" time="0.037"><properties><property name="test_order" value="2143" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestSqliteCacheEdgeCases" name="test_database_creation_with_parent_dirs" time="0.021"><properties><property name="test_order" value="2144" /></properties></testcase><testcase classname="tests.test_sqlite_cache.TestSqliteCacheEdgeCases" name="test_corrupted_data_handling" time="0.021"><properties><property name="test_order" value="2145" /></properties></testcase><testcase classname="tests.test_ssl_check.TestSSLBackendCheck" name="test_get_ssl_backend_info" time="0.003"><properties><property name="test_order" value="2146" /></properties></testcase><testcase classname="tests.test_ssl_check.TestSSLBackendCheck" name="test_check_ssl_backend" time="0.002"><properties><property name="test_order" value="2147" /></properties></testcase><testcase classname="tests.test_ssl_check.TestSSLBackendCheck" name="test_emit_ssl_compatibility_warning_libressl" time="0.003"><properties><property name="test_order" value="2148" /></properties></testcase><testcase classname="tests.test_ssl_check.TestSSLBackendCheck" name="test_emit_ssl_compatibility_warning_openssl" time="0.004"><properties><property name="test_order" value="2149" /></properties></testcase><testcase classname="tests.test_ssl_check.TestSSLBackendCheck" name="test_require_ssl_backend" time="0.003"><properties><property name="test_order" value="2150" /></properties></testcase><testcase classname="tests.test_ssl_check.TestSSLBackendCheck" name="test_warning_can_be_filtered" time="0.003"><properties><property name="test_order" value="2151" /></properties></testcase><testcase classname="tests.test_ssl_check.TestSSLBackendCheck" name="test_warning_emitted_once_per_process" time="0.002"><properties><property name="test_order" value="2152" /></properties></testcase><testcase classname="tests.test_ssl_check.TestSSLBackendCheck" name="test_real_libressl_detection" time="0.003"><properties><property name="test_order" value="2153" /></properties></testcase><testcase classname="tests.test_ssl_check.TestSSLBackendCheck" name="test_real_openssl_detection" time="0.003"><properties><property name="test_order" value="2154" /></properties></testcase><testcase classname="tests.test_ssl_check.TestSSLBackendCheck" name="test_custom_warning_class_hierarchy" time="0.002"><properties><property name="test_order" value="2155" /></properties></testcase><testcase classname="tests.test_test_mode_guards" name="test_mode_guard" time="0.003"><properties><property name="test_order" value="2156" /></properties></testcase><testcase classname="tests.test_test_mode_guards" name="test_is_test_mode_detects_pytest" time="0.003"><properties><property name="test_order" value="2157" /></properties></testcase><testcase classname="tests.test_test_mode_guards" name="test_test_mode_guard_context" time="0.002"><properties><property name="test_order" value="2158" /></properties></testcase><testcase classname="tests.test_test_mode_guards" name="test_nested_override_warning" time="0.002"><properties><property name="test_order" value="2159" /></properties></testcase><testcase classname="tests.test_test_mode_guards" name="test_safe_env_warns_about_direct_access" time="0.002"><properties><property name="test_order" value="2160" /></properties></testcase><testcase classname="tests.test_test_mode_guards" name="test_safe_env_respects_overrides" time="0.004"><properties><property name="test_order" value="2161" /></properties></testcase><testcase classname="tests.test_test_mode_guards" name="test_no_warning_for_non_nested_overrides" time="0.003"><properties><property name="test_order" value="2162" /></properties></testcase><testcase classname="tests.test_test_mode_guards" name="test_no_warning_for_different_keys" time="0.003"><properties><property name="test_order" value="2163" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_global_state_for_tests_success" time="0.004"><properties><property name="test_order" value="2164" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_global_state_for_tests_with_exceptions" time="0.004"><properties><property name="test_order" value="2165" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_global_state_for_tests_partial_exceptions" time="0.004"><properties><property name="test_order" value="2166" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_ai_settings_cache_with_model_config" time="0.003"><properties><property name="test_order" value="2167" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_ai_settings_cache_without_model_config" time="0.004"><properties><property name="test_order" value="2168" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_ai_settings_cache_without_cached_settings" time="0.003"><properties><property name="test_order" value="2169" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_ai_settings_cache_no_attributes" time="0.003"><properties><property name="test_order" value="2170" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_ai_settings_cache_with_exception" time="0.003"><properties><property name="test_order" value="2171" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_provider_factory_state_success" time="0.003"><properties><property name="test_order" value="2172" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_provider_factory_state_no_instance" time="0.003"><properties><property name="test_order" value="2173" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_provider_factory_state_no_cache" time="0.003"><properties><property name="test_order" value="2174" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_provider_factory_state_no_attributes" time="0.003"><properties><property name="test_order" value="2175" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_provider_factory_state_import_error" time="0.003"><properties><property name="test_order" value="2176" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_provider_factory_state_with_exception" time="0.003"><properties><property name="test_order" value="2177" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_config_resolver_caches_success" time="0.003"><properties><property name="test_order" value="2178" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_config_resolver_caches_no_config_cache" time="0.003"><properties><property name="test_order" value="2179" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_config_resolver_caches_no_env_cache" time="0.003"><properties><property name="test_order" value="2180" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_config_resolver_caches_no_attributes" time="0.003"><properties><property name="test_order" value="2181" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_config_resolver_caches_import_error" time="0.003"><properties><property name="test_order" value="2182" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_config_resolver_caches_with_exception" time="0.003"><properties><property name="test_order" value="2183" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_contextvar_state_success" time="0.003"><properties><property name="test_order" value="2184" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_contextvar_state_import_error" time="0.003"><properties><property name="test_order" value="2185" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_contextvar_state_with_exception" time="0.003"><properties><property name="test_order" value="2186" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_get_current_global_state_with_ai_env_vars" time="0.003"><properties><property name="test_order" value="2187" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_get_current_global_state_no_ai_env_vars" time="0.004"><properties><property name="test_order" value="2188" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_get_current_global_state_import_error" time="0.003"><properties><property name="test_order" value="2189" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_get_current_global_state_with_exception" time="0.003"><properties><property name="test_order" value="2190" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_get_current_global_state_empty_environment" time="0.003"><properties><property name="test_order" value="2191" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_get_current_global_state_many_ai_vars" time="0.003"><properties><property name="test_order" value="2192" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_global_state_multiple_calls" time="0.004"><properties><property name="test_order" value="2193" /></properties></testcase><testcase classname="tests.test_test_reset_complete.TestTestResetComplete" name="test_reset_functions_isolated_behavior" time="0.003"><properties><property name="test_order" value="2194" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_global_state_for_tests_success" time="0.005"><properties><property name="test_order" value="2195" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_global_state_for_tests_with_exceptions" time="0.003"><properties><property name="test_order" value="2196" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_ai_settings_cache_with_model_config" time="0.004"><properties><property name="test_order" value="2197" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_ai_settings_cache_without_model_config" time="0.003"><properties><property name="test_order" value="2198" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_ai_settings_cache_no_attributes" time="0.003"><properties><property name="test_order" value="2199" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_ai_settings_cache_with_exception" time="0.003"><properties><property name="test_order" value="2200" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_provider_factory_state_success" time="0.004"><properties><property name="test_order" value="2201" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_provider_factory_state_no_instance" time="0.003"><properties><property name="test_order" value="2202" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_provider_factory_state_import_error" time="0.003"><properties><property name="test_order" value="2203" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_config_resolver_caches_success" time="0.003"><properties><property name="test_order" value="2204" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_config_resolver_caches_import_error" time="0.003"><properties><property name="test_order" value="2205" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_contextvar_state_success" time="0.003"><properties><property name="test_order" value="2206" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_contextvar_state_import_error" time="0.003"><properties><property name="test_order" value="2207" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_get_current_global_state_with_ai_env_vars" time="0.003"><properties><property name="test_order" value="2208" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_get_current_global_state_no_ai_env_vars" time="0.083"><properties><property name="test_order" value="2209" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_get_current_global_state_import_error" time="0.003"><properties><property name="test_order" value="2210" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_get_current_global_state_empty_environment" time="0.003"><properties><property name="test_order" value="2211" /></properties></testcase><testcase classname="tests.test_test_reset_complete_fixed.TestTestResetComplete" name="test_reset_global_state_multiple_calls" time="0.004"><properties><property name="test_order" value="2212" /></properties></testcase><testcase classname="tests.test_timeout_configuration.TestTimeoutConfiguration" name="test_default_timeout_in_settings" time="0.006"><properties><property name="test_order" value="2213" /></properties></testcase><testcase classname="tests.test_timeout_configuration.TestTimeoutConfiguration" name="test_custom_timeout_in_settings" time="0.005"><properties><property name="test_order" value="2214" /></properties></testcase><testcase classname="tests.test_timeout_configuration.TestTimeoutConfiguration" name="test_timeout_passed_to_openai_client" time="0.005"><properties><property name="test_order" value="2215" /></properties></testcase><testcase classname="tests.test_timeout_configuration.TestTimeoutConfiguration" name="test_environment_timeout_override" time="0.006"><properties><property name="test_order" value="2216" /></properties></testcase><testcase classname="tests.test_timeout_configuration.TestTimeoutConfiguration" name="test_request_timeout_s_override" time="0.006"><properties><property name="test_order" value="2217" /></properties></testcase><testcase classname="tests.test_timeout_configuration.TestTimeoutConfiguration" name="test_timeout_validation" time="0.010"><properties><property name="test_order" value="2218" /></properties></testcase><testcase classname="tests.test_timeout_configuration.TestTimeoutConfiguration" name="test_timeout_is_integer" time="0.008"><properties><property name="test_order" value="2219" /></properties></testcase><testcase classname="tests.test_timeout_configuration.TestTimeoutConfiguration" name="test_openai_compatible_provider_timeout" time="0.006"><properties><property name="test_order" value="2220" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_class_constants" time="0.003"><properties><property name="test_order" value="2221" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_tokens_empty_text" time="0.003"><properties><property name="test_order" value="2222" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_tokens_word_method" time="0.003"><properties><property name="test_order" value="2223" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_tokens_char_method" time="0.003"><properties><property name="test_order" value="2224" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_tokens_combined_method" time="0.002"><properties><property name="test_order" value="2225" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_tokens_invalid_method" time="0.003"><properties><property name="test_order" value="2226" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_tokens_default_method" time="0.003"><properties><property name="test_order" value="2227" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_message_tokens_empty_list" time="0.003"><properties><property name="test_order" value="2228" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_message_tokens_single_message" time="0.002"><properties><property name="test_order" value="2229" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_message_tokens_multiple_messages" time="0.002"><properties><property name="test_order" value="2230" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_message_tokens_missing_fields" time="0.002"><properties><property name="test_order" value="2231" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_by_words" time="0.003"><properties><property name="test_order" value="2232" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_by_chars" time="0.002"><properties><property name="test_order" value="2233" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_combined" time="0.003"><properties><property name="test_order" value="2234" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_estimate_response_tokens_default" time="0.003"><properties><property name="test_order" value="2235" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_estimate_response_tokens_custom_factor" time="0.004"><properties><property name="test_order" value="2236" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_estimate_response_tokens_zero_prompt" time="0.003"><properties><property name="test_order" value="2237" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_tokens_for_model_default" time="0.002"><properties><property name="test_order" value="2238" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_tokens_for_model_known_models" time="0.003"><properties><property name="test_order" value="2239" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_count_tokens_for_model_gpt35" time="0.003"><properties><property name="test_order" value="2240" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_edge_cases" time="0.003"><properties><property name="test_order" value="2241" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_consistency_across_methods" time="0.002"><properties><property name="test_order" value="2242" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_message_token_calculation_breakdown" time="0.002"><properties><property name="test_order" value="2243" /></properties></testcase><testcase classname="tests.test_token_counter.TestTokenCounter" name="test_model_adjustment_factors" time="0.003"><properties><property name="test_order" value="2244" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_class_constants" time="0.002"><properties><property name="test_order" value="2245" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_empty_string" time="0.002"><properties><property name="test_order" value="2246" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_word_method" time="0.003"><properties><property name="test_order" value="2247" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_char_method" time="0.003"><properties><property name="test_order" value="2248" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_combined_method" time="0.002"><properties><property name="test_order" value="2249" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_default_method" time="0.002"><properties><property name="test_order" value="2250" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_invalid_method" time="0.002"><properties><property name="test_order" value="2251" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_by_words_helper" time="0.003"><properties><property name="test_order" value="2252" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_by_chars_helper" time="0.002"><properties><property name="test_order" value="2253" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_combined_helper" time="0.002"><properties><property name="test_order" value="2254" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_message_tokens_empty_list" time="0.003"><properties><property name="test_order" value="2255" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_message_tokens_single_message" time="0.003"><properties><property name="test_order" value="2256" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_message_tokens_multiple_messages" time="0.003"><properties><property name="test_order" value="2257" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_message_tokens_missing_fields" time="0.003"><properties><property name="test_order" value="2258" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_message_tokens_different_methods" time="0.002"><properties><property name="test_order" value="2259" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_message_tokens_logging" time="0.004"><properties><property name="test_order" value="2260" /></properties><failure message="AssertionError: Expected 'debug' to have been called once. Called 0 times.">self = &lt;tests.test_token_counter_comprehensive.TestTokenCounter object at 0x10d09eeb0&gt;

    def test_count_message_tokens_logging(self):
        """Test that message token counting logs appropriately."""
        with patch('ai_utilities.token_counter.logger') as mock_logger:
            messages = [{"role": "user", "content": "Hello"}]
    
            TokenCounter.count_message_tokens(messages, "word")
    
            # Should log debug message
&gt;           mock_logger.debug.assert_called_once()

tests/test_token_counter_comprehensive.py:186: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;MagicMock name='logger.debug' id='4554345680'&gt;

    def assert_called_once(self):
        """assert that the mock was called only once.
        """
        if not self.call_count == 1:
            msg = ("Expected '%s' to have been called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
&gt;           raise AssertionError(msg)
E           AssertionError: Expected 'debug' to have been called once. Called 0 times.

/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py:886: AssertionError</failure></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_estimate_response_tokens_basic" time="0.003"><properties><property name="test_order" value="2261" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_estimate_response_tokens_logging" time="0.003"><properties><property name="test_order" value="2262" /></properties><failure message="AssertionError: Expected 'debug' to have been called once. Called 0 times.">self = &lt;tests.test_token_counter_comprehensive.TestTokenCounter object at 0x10d0a1550&gt;

    def test_estimate_response_tokens_logging(self):
        """Test that response estimation logs appropriately."""
        with patch('ai_utilities.token_counter.logger') as mock_logger:
            TokenCounter.estimate_response_tokens(100, 1.5)
    
            # Should log debug message
&gt;           mock_logger.debug.assert_called_once()

tests/test_token_counter_comprehensive.py:210: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;MagicMock name='logger.debug' id='4501177776'&gt;

    def assert_called_once(self):
        """assert that the mock was called only once.
        """
        if not self.call_count == 1:
            msg = ("Expected '%s' to have been called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
&gt;           raise AssertionError(msg)
E           AssertionError: Expected 'debug' to have been called once. Called 0 times.

/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py:886: AssertionError</failure></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_for_model_basic" time="0.003"><properties><property name="test_order" value="2263" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_for_model_logging" time="0.003"><properties><property name="test_order" value="2264" /></properties><failure message="AssertionError: Expected 'debug' to have been called once. Called 0 times.">self = &lt;tests.test_token_counter_comprehensive.TestTokenCounter object at 0x10d0a1b80&gt;, mock_logger = &lt;MagicMock name='logger' id='4518544144'&gt;

    @patch('ai_utilities.token_counter.logger')
    def test_count_tokens_for_model_logging(self, mock_logger):
        """Test that model-specific counting logs appropriately."""
        text = "test"
        model = "test-model-1"
    
        TokenCounter.count_tokens_for_model(text, model)
    
        # Should log debug message
&gt;       mock_logger.debug.assert_called_once()

tests/test_token_counter_comprehensive.py:290: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;MagicMock name='logger.debug' id='4518546064'&gt;

    def assert_called_once(self):
        """assert that the mock was called only once.
        """
        if not self.call_count == 1:
            msg = ("Expected '%s' to have been called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
&gt;           raise AssertionError(msg)
E           AssertionError: Expected 'debug' to have been called once. Called 0 times.

/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/unittest/mock.py:886: AssertionError</failure></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_for_model_known_models" time="0.003"><properties><property name="test_order" value="2265" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_for_model_case_sensitivity" time="0.002"><properties><property name="test_order" value="2266" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_unicode_text" time="0.003"><properties><property name="test_order" value="2267" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_very_long_text" time="0.002"><properties><property name="test_order" value="2268" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_special_characters" time="0.002"><properties><property name="test_order" value="2269" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_whitespace_variations" time="0.002"><properties><property name="test_order" value="2270" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_count_tokens_performance_considerations" time="0.003"><properties><property name="test_order" value="2271" /></properties></testcase><testcase classname="tests.test_token_counter_comprehensive.TestTokenCounter" name="test_edge_cases_empty_and_none" time="0.003"><properties><property name="test_order" value="2272" /></properties></testcase><testcase classname="tests.test_type_signatures.TestTypeSignatures" name="test_ask_returns_str_for_text_format" time="1.050"><properties><property name="test_order" value="2273" /></properties></testcase><testcase classname="tests.test_type_signatures.TestTypeSignatures" name="test_ask_returns_dict_for_json_format" time="1.053"><properties><property name="test_order" value="2274" /></properties></testcase><testcase classname="tests.test_type_signatures.TestTypeSignatures" name="test_ask_returns_list_for_multiple_prompts_text" time="1.056"><properties><property name="test_order" value="2275" /></properties></testcase><testcase classname="tests.test_type_signatures.TestTypeSignatures" name="test_ask_returns_list_for_multiple_prompts_json" time="1.059"><properties><property name="test_order" value="2276" /></properties></testcase><testcase classname="tests.test_type_signatures.TestTypeSignatures" name="test_ask_json_returns_dict_or_list" time="1.064"><properties><property name="test_order" value="2277" /></properties></testcase><testcase classname="tests.test_type_signatures.TestParameterFiltering" name="test_internal_fields_excluded_from_provider_kwargs" time="1.021"><properties><property name="test_order" value="2278" /></properties></testcase><testcase classname="tests.test_type_signatures.TestParameterFiltering" name="test_user_kwargs_override_settings" time="1.020"><properties><property name="test_order" value="2279" /></properties></testcase><testcase classname="tests.test_type_signatures.TestParameterFiltering" name="test_none_values_excluded" time="1.011"><properties><property name="test_order" value="2280" /></properties></testcase><testcase classname="tests.test_type_signatures.TestAsyncTypeSignatures" name="test_async_ask_returns_str_for_text_format" time="0.009"><properties><property name="test_order" value="2281" /></properties></testcase><testcase classname="tests.test_type_signatures.TestAsyncTypeSignatures" name="test_async_ask_returns_dict_for_json_format" time="0.008"><properties><property name="test_order" value="2282" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestUsageScope" name="test_usage_scope_values" time="0.004"><properties><property name="test_order" value="2283" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestUsageScope" name="test_usage_scope_creation" time="0.002"><properties><property name="test_order" value="2284" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestUsageStats" name="test_usage_stats_defaults" time="0.003"><properties><property name="test_order" value="2285" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestUsageStats" name="test_usage_stats_with_values" time="0.003"><properties><property name="test_order" value="2286" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestUsageStats" name="test_usage_stats_serialization" time="0.004"><properties><property name="test_order" value="2287" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_tracker_initialization_per_client" time="0.005"><properties><property name="test_order" value="2288" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_tracker_initialization_auto_generate_client_id" time="0.004"><properties><property name="test_order" value="2289" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_tracker_initialization_per_process" time="0.005"><properties><property name="test_order" value="2290" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_tracker_initialization_global" time="0.006"><properties><property name="test_order" value="2291" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_generate_stats_file_path" time="0.011"><properties><property name="test_order" value="2292" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_generate_client_id" time="0.005"><properties><property name="test_order" value="2293" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_get_shared_file_lock" time="0.003"><properties><property name="test_order" value="2294" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_record_usage" time="0.010"><properties><property name="test_order" value="2295" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_record_usage_zero_tokens" time="0.007"><properties><property name="test_order" value="2296" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_get_stats" time="0.004"><properties><property name="test_order" value="2297" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_reset_stats" time="0.007"><properties><property name="test_order" value="2298" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_print_summary" time="0.008"><properties><property name="test_order" value="2299" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_get_aggregated_stats" time="0.012"><properties><property name="test_order" value="2300" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_get_aggregated_stats_empty_directory" time="0.007"><properties><property name="test_order" value="2301" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_get_aggregated_stats_corrupted_files" time="0.012"><properties><property name="test_order" value="2302" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_thread_safety_record_usage" time="0.092"><properties><property name="test_order" value="2303" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_thread_safety_get_stats" time="0.014"><properties><property name="test_order" value="2304" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_file_creation_and_permissions" time="0.005"><properties><property name="test_order" value="2305" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_load_stats_corrupted_file" time="0.005"><properties><property name="test_order" value="2306" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_reset_if_new_day" time="0.008"><properties><property name="test_order" value="2307" /></properties><failure message="AssertionError: assert 100 == 0&#10; +  where 100 = UsageStats(tokens_used_today=100, requests_today=1, last_reset='2026-01-18', total_tokens=100, total_requests=1, client_id='client_775e17af_1768766033', process_id=None).tokens_used_today">self = &lt;tests.test_usage_tracker.TestThreadSafeUsageTracker object at 0x10d0e4dc0&gt;

    def test_reset_if_new_day(self):
        """Test daily reset functionality."""
        with tempfile.TemporaryDirectory() as temp_dir:
            stats_file = Path(temp_dir) / "test_stats.json"
            tracker = ThreadSafeUsageTracker(stats_file=stats_file)
    
            # Record usage today
            tracker.record_usage(tokens_used=100)
            stats = tracker.get_stats()
            assert stats.tokens_used_today == 100
    
            # Mock date change to tomorrow
            from datetime import date
            original_today = date.today
            tomorrow = date.fromordinal(original_today().toordinal() + 1)
    
            with patch('ai_utilities.usage_tracker.date') as mock_date:
                mock_date.today.return_value = tomorrow
                mock_date.side_effect = lambda *args, **kw: date(*args, **kw)
    
                # Getting stats should reset daily counters
                stats = tracker.get_stats()
&gt;               assert stats.tokens_used_today == 0
E               AssertionError: assert 100 == 0
E                +  where 100 = UsageStats(tokens_used_today=100, requests_today=1, last_reset='2026-01-18', total_tokens=100, total_requests=1, client_id='client_775e17af_1768766033', process_id=None).tokens_used_today

tests/test_usage_tracker.py:478: AssertionError</failure></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_shared_locks_across_instances" time="0.004"><properties><property name="test_order" value="2308" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestThreadSafeUsageTracker" name="test_backward_compatibility_alias" time="0.010"><properties><property name="test_order" value="2309" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestCreateUsageTracker" name="test_create_usage_tracker_with_enum_scope" time="0.003"><properties><property name="test_order" value="2310" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestCreateUsageTracker" name="test_create_usage_tracker_with_string_scope" time="0.005"><properties><property name="test_order" value="2311" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestCreateUsageTracker" name="test_create_usage_tracker_with_custom_file" time="0.004"><properties><property name="test_order" value="2312" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestCreateUsageTracker" name="test_create_usage_tracker_default_scope" time="0.005"><properties><property name="test_order" value="2313" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestEdgeCases" name="test_tracker_with_none_stats_file" time="0.004"><properties><property name="test_order" value="2314" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestEdgeCases" name="test_record_negative_tokens" time="0.013"><properties><property name="test_order" value="2315" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestEdgeCases" name="test_large_token_numbers" time="0.019"><properties><property name="test_order" value="2316" /></properties></testcase><testcase classname="tests.test_usage_tracker.TestEdgeCases" name="test_concurrent_file_access_simulation" time="0.035"><properties><property name="test_order" value="2317" /></properties></testcase><testcase classname="tests.test_usage_tracking" name="test_usage_tracker_basic" time="0.008"><properties><property name="test_order" value="2318" /></properties></testcase><testcase classname="tests.test_usage_tracking" name="test_usage_tracker_persistence" time="0.007"><properties><property name="test_order" value="2319" /></properties></testcase><testcase classname="tests.test_usage_tracking" name="test_ai_client_with_usage_tracking" time="2.064"><properties><property name="test_order" value="2320" /></properties></testcase><testcase classname="tests.test_usage_tracking" name="test_ai_client_without_usage_tracking" time="1.054"><properties><property name="test_order" value="2321" /></properties></testcase><testcase classname="tests.test_usage_tracking" name="test_usage_tracker_daily_reset" time="0.008"><properties><property name="test_order" value="2322" /></properties></testcase><testcase classname="tests.test_usage_tracking" name="test_usage_tracker_print_summary" time="0.008"><properties><property name="test_order" value="2323" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestAiSettingsModelField" name="test_ai_model_populates_model_field" time="0.005"><properties><property name="test_order" value="2324" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestAiSettingsModelField" name="test_openai_model_fallback" time="0.005"><properties><property name="test_order" value="2325" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestAiSettingsModelField" name="test_ai_model_takes_priority_over_openai_model" time="0.005"><properties><property name="test_order" value="2326" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestAiSettingsModelField" name="test_no_model_env_vars_sets_default" time="0.006"><properties><property name="test_order" value="2327" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestAiSettingsModelField" name="test_empty_string_treated_as_default" time="0.005"><properties><property name="test_order" value="2328" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestAiSettingsModelField" name="test_whitespace_only_treated_as_default" time="0.012"><properties><property name="test_order" value="2329" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestAiSettingsModelField" name="test_whitespace_is_trimmed" time="0.005"><properties><property name="test_order" value="2330" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestAiSettingsModelField" name="test_explicit_model_overrides_env" time="0.006"><properties><property name="test_order" value="2331" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestAiSettingsModelField" name="test_complex_model_names" time="0.010"><properties><property name="test_order" value="2332" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestAiSettingsModelField" name="test_model_field_with_other_settings" time="0.005"><properties><property name="test_order" value="2333" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestAiSettingsModelField" name="test_model_field_type_annotation" time="0.003"><properties><property name="test_order" value="2334" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestModelFieldValidator" name="test_validator_handles_none" time="0.006"><properties><property name="test_order" value="2335" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestModelFieldValidator" name="test_validator_preserves_valid_strings" time="0.005"><properties><property name="test_order" value="2336" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestModelFieldValidator" name="test_validator_normalizes_whitespace" time="0.012"><properties><property name="test_order" value="2337" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestModelFieldValidator" name="test_validator_converts_empty_to_default" time="0.015"><properties><property name="test_order" value="2338" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestBackwardCompatibility" name="test_explicit_none_converts_to_default" time="0.006"><properties><property name="test_order" value="2339" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestBackwardCompatibility" name="test_explicit_model_still_works" time="0.005"><properties><property name="test_order" value="2340" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestBackwardCompatibility" name="test_mixed_explicit_and_env" time="0.005"><properties><property name="test_order" value="2341" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestIntegrationWithResolver" name="test_resolver_uses_settings_model" time="0.006"><properties><property name="test_order" value="2342" /></properties></testcase><testcase classname="tests.utils.test_ai_settings_model_field.TestIntegrationWithResolver" name="test_resolver_fallback_to_default" time="0.006"><properties><property name="test_order" value="2343" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestApiKeyResolution" name="test_explicit_api_key_overrides_env_var" time="0.003"><properties><property name="test_order" value="2344" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestApiKeyResolution" name="test_explicit_api_key_overrides_settings" time="0.003"><properties><property name="test_order" value="2345" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestApiKeyResolution" name="test_settings_api_key_overrides_env_var" time="0.003"><properties><property name="test_order" value="2346" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestApiKeyResolution" name="test_env_var_used_when_no_explicit_or_settings" time="0.004"><properties><property name="test_order" value="2347" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestApiKeyResolution" name="test_env_file_used_when_env_var_missing" time="0.006"><properties><property name="test_order" value="2348" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestApiKeyResolution" name="test_env_file_ignored_when_placeholder" time="0.005"><properties><property name="test_order" value="2349" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestApiKeyResolution" name="test_missing_api_key_raises_error" time="0.003"><properties><property name="test_order" value="2350" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestApiKeyResolution" name="test_whitespace_stripping" time="0.003"><properties><property name="test_order" value="2351" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestApiKeyResolution" name="test_empty_values_ignored" time="0.004"><properties><property name="test_order" value="2352" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestApiKeyResolution" name="test_env_file_read_error_silently_ignored" time="0.005"><properties><property name="test_order" value="2353" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestApiKeyResolution" name="test_precedence_order_complete" time="0.005"><properties><property name="test_order" value="2354" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestMissingApiKeyError" name="test_error_message_contains_required_elements" time="0.004"><properties><property name="test_order" value="2355" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestMissingApiKeyError" name="test_error_message_platform_specific" time="0.003"><properties><property name="test_order" value="2356" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestMissingApiKeyError" name="test_error_message_no_key_leakage" time="0.003"><properties><property name="test_order" value="2357" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestIntegrationWithClient" name="test_create_client_with_explicit_key" time="0.011"><properties><property name="test_order" value="2358" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestIntegrationWithClient" name="test_create_client_without_key_raises_error" time="0.007"><properties><property name="test_order" value="2359" /></properties></testcase><testcase classname="tests.utils.test_api_key_resolver.TestIntegrationWithClient" name="test_create_client_with_env_file" time="0.012"><properties><property name="test_order" value="2360" /></properties></testcase><testcase classname="tests.utils.test_caching.TestCachingBasics" name="test_null_cache_always_misses" time="0.003"><properties><property name="test_order" value="2361" /></properties></testcase><testcase classname="tests.utils.test_caching.TestCachingBasics" name="test_memory_cache_basic_operations" time="0.002"><properties><property name="test_order" value="2362" /></properties></testcase><testcase classname="tests.utils.test_caching.TestCachingBasics" name="test_memory_cache_ttl_expiration" time="0.003"><properties><property name="test_order" value="2363" /></properties></testcase><testcase classname="tests.utils.test_caching.TestCachingBasics" name="test_memory_cache_custom_ttl" time="0.003"><properties><property name="test_order" value="2364" /></properties></testcase><testcase classname="tests.utils.test_caching.TestCachingBasics" name="test_memory_cache_size" time="0.003"><properties><property name="test_order" value="2365" /></properties></testcase><testcase classname="tests.utils.test_caching.TestAiClientCaching" name="test_ask_caches_when_enabled_and_temp_low" time="2.024"><properties><property name="test_order" value="2366" /></properties></testcase><testcase classname="tests.utils.test_caching.TestAiClientCaching" name="test_ask_does_not_cache_when_disabled" time="2.031"><properties><property name="test_order" value="2367" /></properties></testcase><testcase classname="tests.utils.test_caching.TestAiClientCaching" name="test_ask_does_not_cache_when_temp_high" time="2.031"><properties><property name="test_order" value="2368" /></properties></testcase><testcase classname="tests.utils.test_caching.TestAiClientCaching" name="test_ask_cache_key_model_sensitive" time="3.036"><properties><property name="test_order" value="2369" /></properties></testcase><testcase classname="tests.utils.test_caching.TestAiClientCaching" name="test_ask_cache_key_parameter_sensitive" time="3.041"><properties><property name="test_order" value="2370" /></properties></testcase><testcase classname="tests.utils.test_caching.TestAiClientCaching" name="test_ask_does_not_cache_list_prompts" time="2.031"><properties><property name="test_order" value="2371" /></properties></testcase><testcase classname="tests.utils.test_caching.TestAiClientCaching" name="test_ask_json_caches_parsed_result" time="2.033"><properties><property name="test_order" value="2372" /></properties></testcase><testcase classname="tests.utils.test_caching.TestAiClientCaching" name="test_ask_json_does_not_cache_failure" time="2.031"><properties><property name="test_order" value="2373" /></properties></testcase><testcase classname="tests.utils.test_caching.TestAiClientCaching" name="test_ask_json_cache_key_includes_repairs" time="3.039"><properties><property name="test_order" value="2374" /></properties></testcase><testcase classname="tests.utils.test_caching.TestAiClientCaching" name="test_embeddings_caches" time="0.008"><properties><property name="test_order" value="2375" /></properties><failure message="AssertionError: assert 0 == 1&#10; +  where 0 = &lt;Mock name='OpenAI().embeddings.create' id='4553150912'&gt;.call_count&#10; +    where &lt;Mock name='OpenAI().embeddings.create' id='4553150912'&gt; = &lt;Mock name='OpenAI().embeddings' id='4553152448'&gt;.create&#10; +      where &lt;Mock name='OpenAI().embeddings' id='4553152448'&gt; = &lt;Mock name='OpenAI()' id='4553154080'&gt;.embeddings">self = &lt;test_caching.TestAiClientCaching object at 0x10d10aee0&gt;

    def test_embeddings_caches(self):
        """Test that get_embeddings() works correctly (note: doesn't use cache currently)."""
        settings = AiSettings(cache_enabled=True, cache_backend="memory", api_key="test-key")
        provider = FakeProvider(settings)
        client = AiClient(settings=settings, provider=provider)
    
        # Mock OpenAI embeddings
        mock_embeddings = Mock()
        mock_embeddings.data = [
            Mock(embedding=[0.1, 0.2, 0.3]),
            Mock(embedding=[0.4, 0.5, 0.6])
        ]
    
        with patch('openai.OpenAI') as mock_openai:
            mock_client = Mock()
            mock_client.embeddings.create.return_value = mock_embeddings
            mock_openai.return_value = mock_client
    
            # First call
            result1 = client.get_embeddings(["hello", "world"])
&gt;           assert mock_client.embeddings.create.call_count == 1
E           AssertionError: assert 0 == 1
E            +  where 0 = &lt;Mock name='OpenAI().embeddings.create' id='4553150912'&gt;.call_count
E            +    where &lt;Mock name='OpenAI().embeddings.create' id='4553150912'&gt; = &lt;Mock name='OpenAI().embeddings' id='4553152448'&gt;.create
E            +      where &lt;Mock name='OpenAI().embeddings' id='4553152448'&gt; = &lt;Mock name='OpenAI()' id='4553154080'&gt;.embeddings

tests/utils/test_caching.py:357: AssertionError</failure></testcase><testcase classname="tests.utils.test_caching.TestAiClientCaching" name="test_embeddings_cache_key_sensitive" time="0.007"><properties><property name="test_order" value="2376" /></properties><failure message="AssertionError: assert 0 == 1&#10; +  where 0 = &lt;Mock name='OpenAI().embeddings.create' id='4561052768'&gt;.call_count&#10; +    where &lt;Mock name='OpenAI().embeddings.create' id='4561052768'&gt; = &lt;Mock name='OpenAI().embeddings' id='4561052672'&gt;.create&#10; +      where &lt;Mock name='OpenAI().embeddings' id='4561052672'&gt; = &lt;Mock name='OpenAI()' id='4561052720'&gt;.embeddings">self = &lt;test_caching.TestAiClientCaching object at 0x10d14c3a0&gt;

    def test_embeddings_cache_key_sensitive(self):
        """Test that embeddings calls work correctly with different inputs (note: doesn't use cache currently)."""
        settings = AiSettings(cache_enabled=True, cache_backend="memory", api_key="test-key")
        provider = FakeProvider(settings)
        client = AiClient(settings=settings, provider=provider)
    
        mock_embeddings = Mock()
        mock_embeddings.data = [Mock(embedding=[0.1, 0.2, 0.3])]
    
        with patch('openai.OpenAI') as mock_openai:
            mock_client = Mock()
            mock_client.embeddings.create.return_value = mock_embeddings
            mock_openai.return_value = mock_client
    
            # Different texts should make different calls
            client.get_embeddings(["hello"])
&gt;           assert mock_client.embeddings.create.call_count == 1
E           AssertionError: assert 0 == 1
E            +  where 0 = &lt;Mock name='OpenAI().embeddings.create' id='4561052768'&gt;.call_count
E            +    where &lt;Mock name='OpenAI().embeddings.create' id='4561052768'&gt; = &lt;Mock name='OpenAI().embeddings' id='4561052672'&gt;.create
E            +      where &lt;Mock name='OpenAI().embeddings' id='4561052672'&gt; = &lt;Mock name='OpenAI()' id='4561052720'&gt;.embeddings

tests/utils/test_caching.py:382: AssertionError</failure></testcase><testcase classname="tests.utils.test_caching.TestAiClientCaching" name="test_explicit_cache_backend_overrides_settings" time="2.030"><properties><property name="test_order" value="2377" /></properties></testcase><testcase classname="tests.utils.test_caching.TestAiClientCaching" name="test_cache_usage_tracking" time="2.042"><properties><property name="test_order" value="2378" /></properties></testcase><testcase classname="tests.utils.test_caching.TestCacheHelpers" name="test_stable_hash_deterministic" time="0.004"><properties><property name="test_order" value="2379" /></properties></testcase><testcase classname="tests.utils.test_caching.TestCacheHelpers" name="test_stable_hash_order_independent" time="0.003"><properties><property name="test_order" value="2380" /></properties></testcase><testcase classname="tests.utils.test_caching.TestCacheHelpers" name="test_stable_hash_different_data" time="0.003"><properties><property name="test_order" value="2381" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationIntegrity" name="test_no_setup_py_exists" time="0.004"><properties><property name="test_order" value="2382" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationIntegrity" name="test_pytest_ini_exists" time="0.003"><properties><property name="test_order" value="2383" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationIntegrity" name="test_pyproject_toml_exists" time="0.003"><properties><property name="test_order" value="2384" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationIntegrity" name="test_pyproject_toml_valid_syntax" time="0.005"><properties><property name="test_order" value="2385" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationIntegrity" name="test_pyproject_toml_project_metadata" time="0.005"><properties><property name="test_order" value="2386" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationIntegrity" name="test_pyproject_toml_no_pytest_configuration" time="0.005"><properties><property name="test_order" value="2387" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationIntegrity" name="test_pyproject_toml_consistent_naming" time="0.005"><properties><property name="test_order" value="2388" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationIntegrity" name="test_no_legacy_configuration_files" time="0.003"><properties><property name="test_order" value="2389" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationIntegrity" name="test_pyproject_toml_modern_python_version" time="0.005"><properties><property name="test_order" value="2390" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationIntegrity" name="test_pyproject_toml_build_backend" time="0.004"><properties><property name="test_order" value="2391" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationIntegrity" name="test_directory_structure_clean" time="0.003"><properties><property name="test_order" value="2392" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationIntegrity" name="test_no_duplicate_test_files_outside_tests" time="0.004"><properties><property name="test_order" value="2393" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationBestPractices" name="test_pyproject_toml_well_structured" time="0.004"><properties><property name="test_order" value="2394" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationBestPractices" name="test_pytest_ini_well_structured" time="0.004"><properties><property name="test_order" value="2395" /></properties><failure message="AssertionError: Missing [tool:pytest] section in pytest.ini&#10;assert '[tool:pytest]' in '[pytest]\ntestpaths = tests\npythonpath = src\naddopts = \n    --cov=ai_utilities \n    --cov-report=html:coverage_re...ts that hang in full suite (should be run separately)\n    dashboard: marks tests related to dashboard functionality\n'">self = &lt;test_configuration_integrity.TestConfigurationBestPractices object at 0x10d17e0d0&gt;, project_root = PosixPath('/Users/steffenrasmussen/PycharmProjects/ai_utilities')

    def test_pytest_ini_well_structured(self, project_root: Path):
        """Ensure pytest.ini is well-structured and has proper configuration."""
        pytest_ini_path = project_root / "pytest.ini"
    
        with open(pytest_ini_path, 'r', encoding='utf-8') as f:
            content = f.read()
    
        # Check for essential pytest configuration
&gt;       assert '[tool:pytest]' in content, (
            "Missing [tool:pytest] section in pytest.ini"
        )
E       AssertionError: Missing [tool:pytest] section in pytest.ini
E       assert '[tool:pytest]' in '[pytest]\ntestpaths = tests\npythonpath = src\naddopts = \n    --cov=ai_utilities \n    --cov-report=html:coverage_re...ts that hang in full suite (should be run separately)\n    dashboard: marks tests related to dashboard functionality\n'

tests/utils/test_configuration_integrity.py:262: AssertionError</failure></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationBestPractices" name="test_gitignore_prevents_committing_bad_files" time="0.003"><properties><property name="test_order" value="2396" /></properties></testcase><testcase classname="tests.utils.test_configuration_integrity.TestConfigurationBestPractices" name="test_readme_mentions_configuration" time="0.004"><properties><property name="test_order" value="2397" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestExpandedProviderSupport" name="test_all_documented_providers_are_valid" time="0.083"><properties><property name="test_order" value="2398" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestExpandedProviderSupport" name="test_undocumented_provider_raises_error" time="0.003"><properties><property name="test_order" value="2399" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestExpandedProviderSupport" name="test_cloud_provider_base_urls" time="0.003"><properties><property name="test_order" value="2400" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestExpandedProviderSupport" name="test_local_provider_base_urls" time="0.002"><properties><property name="test_order" value="2401" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestExpandedProviderSupport" name="test_enterprise_provider_base_urls" time="0.003"><properties><property name="test_order" value="2402" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestExpandedProviderSupport" name="test_provider_api_key_mappings" time="0.002"><properties><property name="test_order" value="2403" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestExpandedProviderSupport" name="test_openai_compatible_requires_base_url" time="0.003"><properties><property name="test_order" value="2404" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestExpandedProviderSupport" name="test_custom_base_url_overrides_default" time="0.003"><properties><property name="test_order" value="2405" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestExpandedProviderSupport" name="test_settings_base_url_overrides_default" time="0.004"><properties><property name="test_order" value="2406" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestExpandedProviderSupport" name="test_provider_name_variations" time="0.003"><properties><property name="test_order" value="2407" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestDocumentationConsistency" name="test_all_documented_providers_have_defaults" time="0.003"><properties><property name="test_order" value="2408" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestDocumentationConsistency" name="test_all_documented_providers_have_api_key_mappings" time="0.003"><properties><property name="test_order" value="2409" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestDocumentationConsistency" name="test_local_providers_dont_require_api_keys" time="0.003"><properties><property name="test_order" value="2410" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestRealWorldScenarios" name="test_anyscale_setup" time="0.003"><properties><property name="test_order" value="2411" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestRealWorldScenarios" name="test_fireworks_setup" time="0.003"><properties><property name="test_order" value="2412" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestRealWorldScenarios" name="test_azure_setup" time="0.003"><properties><property name="test_order" value="2413" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestRealWorldScenarios" name="test_ollama_local_setup" time="0.003"><properties><property name="test_order" value="2414" /></properties></testcase><testcase classname="tests.utils.test_expanded_provider_support.TestRealWorldScenarios" name="test_openai_compatible_custom_endpoint" time="0.002"><properties><property name="test_order" value="2415" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_init_default_parameters" time="0.002"><properties><property name="test_order" value="2416" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_init_custom_parameters" time="0.002"><properties><property name="test_order" value="2417" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_is_supported_file" time="0.003"><properties><property name="test_order" value="2418" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_markdown_file" time="0.027"><properties><property name="test_order" value="2419" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_text_file" time="0.023"><properties><property name="test_order" value="2420" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_python_file" time="0.021"><properties><property name="test_order" value="2421" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_log_file" time="0.023"><properties><property name="test_order" value="2422" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_rst_file" time="0.027"><properties><property name="test_order" value="2423" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_yaml_file" time="0.024"><properties><property name="test_order" value="2424" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_json_file" time="0.023"><properties><property name="test_order" value="2425" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_file_not_exists" time="0.004"><properties><property name="test_order" value="2426" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_unsupported_file_type" time="0.005"><properties><property name="test_order" value="2427" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_file_too_large" time="0.004"><properties><property name="test_order" value="2428" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_empty_file" time="0.020"><properties><property name="test_order" value="2429" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_binary_file" time="0.022"><properties><property name="test_order" value="2430" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_unicode_content" time="0.021"><properties><property name="test_order" value="2431" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_special_characters" time="0.022"><properties><property name="test_order" value="2432" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_path_with_spaces" time="0.023"><properties><property name="test_order" value="2433" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_load_source_python_syntax_extraction" time="0.023"><properties><property name="test_order" value="2434" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_source_id_consistency" time="0.038"><properties><property name="test_order" value="2435" /></properties></testcase><testcase classname="tests.utils.test_knowledge_sources.TestFileSourceLoader" name="test_mime_type_detection" time="0.092"><properties><property name="test_order" value="2436" /></properties><failure message="AssertionError: Mime type mismatch for test.yaml&#10;assert 'text/x-yaml' == 'application/x-yaml'&#10;  &#10;  #x1B[0m#x1B[91m- application/x-yaml#x1B[39;49;00m#x1B[90m#x1B[39;49;00m&#10;  #x1B[92m+ text/x-yaml#x1B[39;49;00m#x1B[90m#x1B[39;49;00m">self = &lt;test_knowledge_sources.TestFileSourceLoader object at 0x10d1b7f10&gt;

    def test_mime_type_detection(self):
        """Test mime type detection for different file types."""
        loader = FileSourceLoader()
    
        with TemporaryDirectory() as tmp_dir:
            test_cases = [
                ("test.md", "text/markdown"),
                ("test.txt", "text/plain"),
                ("test.py", "text/x-python"),
                ("test.log", "text/plain"),
                ("test.rst", "text/x-rst"),
                ("test.yaml", "application/x-yaml"),
                ("test.yml", "application/x-yaml"),
                ("test.json", "application/json"),
            ]
    
            for filename, expected_mime in test_cases:
                test_file = Path(tmp_dir) / filename
                test_file.write_text("Test content")
    
                source = loader.load_source(test_file)
&gt;               assert source.mime_type == expected_mime, f"Mime type mismatch for {filename}"
E               AssertionError: Mime type mismatch for test.yaml
E               assert 'text/x-yaml' == 'application/x-yaml'
E                 
E                 #x1B[0m#x1B[91m- application/x-yaml#x1B[39;49;00m#x1B[90m#x1B[39;49;00m
E                 #x1B[92m+ text/x-yaml#x1B[39;49;00m#x1B[90m#x1B[39;49;00m

tests/utils/test_knowledge_sources.py:420: AssertionError</failure></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestProviderSpecificBaseUrls" name="test_infers_provider_from_text_generation_webui_base_url" time="0.003"><properties><property name="test_order" value="2437" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestProviderSpecificBaseUrls" name="test_infers_provider_from_fastchat_base_url" time="0.003"><properties><property name="test_order" value="2438" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestProviderSpecificBaseUrls" name="test_infers_provider_from_ollama_base_url" time="0.003"><properties><property name="test_order" value="2439" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestProviderSpecificBaseUrls" name="test_infers_provider_from_lmstudio_base_url" time="0.003"><properties><property name="test_order" value="2440" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestProviderSpecificBaseUrls" name="test_prioritizes_first_provider_base_url_found" time="0.003"><properties><property name="test_order" value="2441" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestProviderSpecificBaseUrls" name="test_explicit_provider_overrides_env_base_url" time="0.003"><properties><property name="test_order" value="2442" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestProviderSpecificBaseUrls" name="test_explicit_base_url_overrides_provider_specific" time="0.003"><properties><property name="test_order" value="2443" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestProviderSpecificBaseUrls" name="test_no_provider_base_urls_returns_default" time="0.003"><properties><property name="test_order" value="2444" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestBaseUrlResolution" name="test_resolves_text_generation_webui_base_url" time="0.003"><properties><property name="test_order" value="2445" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestBaseUrlResolution" name="test_resolves_fastchat_base_url" time="0.003"><properties><property name="test_order" value="2446" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestBaseUrlResolution" name="test_resolves_ollama_base_url" time="0.003"><properties><property name="test_order" value="2447" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestBaseUrlResolution" name="test_resolves_lmstudio_base_url" time="0.004"><properties><property name="test_order" value="2448" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestBaseUrlResolution" name="test_ai_base_url_takes_precedence" time="0.003"><properties><property name="test_order" value="2449" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestBaseUrlResolution" name="test_per_request_base_url_takes_precedence" time="0.003"><properties><property name="test_order" value="2450" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestBaseUrlResolution" name="test_unknown_provider_returns_none" time="0.003"><properties><property name="test_order" value="2451" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestClientIntegration" name="test_client_uses_text_generation_webui_base_url" time="0.007"><properties><property name="test_order" value="2452" /></properties><failure message="AssertionError: assert 'openai' == 'text-generation-webui'&#10;  &#10;  #x1B[0m#x1B[91m- text-generation-webui#x1B[39;49;00m#x1B[90m#x1B[39;49;00m&#10;  #x1B[92m+ openai#x1B[39;49;00m#x1B[90m#x1B[39;49;00m">self = &lt;test_provider_specific_base_urls.TestClientIntegration object at 0x10d1d8040&gt;

    @patch.dict(os.environ, {
        "TEXT_GENERATION_WEBUI_BASE_URL": "http://localhost:5000/v1",
        "AI_API_KEY": "test-key"
    })
    def test_client_uses_text_generation_webui_base_url(self):
        """Test that AiClient uses TEXT_GENERATION_WEBUI_BASE_URL."""
        settings = AiSettings()  # Create settings with patched environment
        client = AiClient(settings=settings)  # Pass explicit settings
        # Should infer text-generation-webui provider and use its base URL
&gt;       assert client.settings.provider == "text-generation-webui"
E       AssertionError: assert 'openai' == 'text-generation-webui'
E         
E         #x1B[0m#x1B[91m- text-generation-webui#x1B[39;49;00m#x1B[90m#x1B[39;49;00m
E         #x1B[92m+ openai#x1B[39;49;00m#x1B[90m#x1B[39;49;00m

tests/utils/test_provider_specific_base_urls.py:167: AssertionError</failure></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestClientIntegration" name="test_client_uses_fastchat_base_url" time="0.006"><properties><property name="test_order" value="2453" /></properties><failure message="AssertionError: assert 'openai' == 'fastchat'&#10;  &#10;  #x1B[0m#x1B[91m- fastchat#x1B[39;49;00m#x1B[90m#x1B[39;49;00m&#10;  #x1B[92m+ openai#x1B[39;49;00m#x1B[90m#x1B[39;49;00m">self = &lt;test_provider_specific_base_urls.TestClientIntegration object at 0x10d1d8340&gt;

    @patch.dict(os.environ, {
        "FASTCHAT_BASE_URL": "http://localhost:8000/v1",
        "AI_API_KEY": "test-key"
    })
    def test_client_uses_fastchat_base_url(self):
        """Test that AiClient uses FASTCHAT_BASE_URL."""
        settings = AiSettings()  # Create settings with patched environment
        client = AiClient(settings=settings)  # Pass explicit settings
&gt;       assert client.settings.provider == "fastchat"
E       AssertionError: assert 'openai' == 'fastchat'
E         
E         #x1B[0m#x1B[91m- fastchat#x1B[39;49;00m#x1B[90m#x1B[39;49;00m
E         #x1B[92m+ openai#x1B[39;49;00m#x1B[90m#x1B[39;49;00m

tests/utils/test_provider_specific_base_urls.py:178: AssertionError</failure></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestClientIntegration" name="test_explicit_provider_overrides_base_url_inference" time="0.006"><properties><property name="test_order" value="2454" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestClientIntegration" name="test_ai_base_url_overrides_provider_specific" time="0.006"><properties><property name="test_order" value="2455" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestClientIntegration" name="test_provider_base_url_without_api_key_works" time="0.006"><properties><property name="test_order" value="2456" /></properties><failure message="ai_utilities.providers.provider_exceptions.ProviderConfigurationError: Provider 'openai' configuration error: API key is required">settings = AiSettings(provider='openai', api_key=None, openai_api_key=None, groq_api_key=None, together_api_key=None, openrouter_..., cache_sqlite_busy_timeout_ms=3000, cache_sqlite_max_entries=None, cache_sqlite_prune_batch=200, cache_namespace=None)
provider = None

    def create_provider(settings: "AiSettings", provider: Optional[BaseProvider] = None) -&gt; BaseProvider:
        """Create an AI provider based on settings.
    
        Args:
            settings: AI settings containing provider configuration
            provider: Optional explicit provider to use (overrides settings)
    
        Returns:
            Configured AI provider instance
    
        Raises:
            ProviderConfigurationError: If provider configuration is invalid
        """
        # If explicit provider is provided, use it
        if provider is not None:
            return provider
    
        # Check if settings is None
        if settings is None:
            raise ProviderConfigurationError("Settings cannot be None", "unknown")
    
        try:
&gt;           config = resolve_request_config(settings)

src/ai_utilities/providers/provider_factory.py:62: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/config_resolver.py:497: in resolve_request_config
    resolved_api_key = resolve_api_key(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

provider = 'openai', api_key = None, settings_api_key = None
settings = AiSettings(provider='openai', api_key=None, openai_api_key=None, groq_api_key=None, together_api_key=None, openrouter_..., cache_sqlite_busy_timeout_ms=3000, cache_sqlite_max_entries=None, cache_sqlite_prune_batch=200, cache_namespace=None)
env_vars = {'COMMAND_MODE': 'unix2003', 'COV_CORE_CONFIG': '/Users/steffenrasmussen/PycharmProjects/ai_utilities/.coveragerc', 'C...RE_DATAFILE': '/Users/steffenrasmussen/PycharmProjects/ai_utilities/.coverage', 'COV_CORE_SOURCE': 'ai_utilities', ...}

    def resolve_api_key(
        provider: str,
        api_key: Optional[str] = None,
        settings_api_key: Optional[str] = None,
        settings: Optional[Any] = None,
        env_vars: Optional[Dict[str, str]] = None
    ) -&gt; str:
        """Resolve API key using precedence rules.
    
        Args:
            provider: Resolved provider name
            api_key: Per-request API key override
            settings_api_key: Settings API_KEY (from AI_API_KEY)
            settings: AiSettings instance with vendor-specific keys
            env_vars: Environment variables dict
    
        Returns:
            Resolved API key
    
        Raises:
            MissingApiKeyError: If no API key is available for cloud providers
        """
        if env_vars is None:
            env_vars = {}
    
        # 1) Per-request API key wins
        if api_key:
            return api_key
    
        # 2) Settings API_KEY (AI_API_KEY override)
        if settings_api_key:
            return settings_api_key
    
        # 3) Vendor-specific key from settings
        if settings:
            vendor_key = _get_vendor_key_from_settings(provider, settings)
            if vendor_key:
                return vendor_key
    
        # 4) Vendor-specific key from environment
        vendor_key = _get_vendor_key_for_provider(provider, env_vars)
        if vendor_key:
            return vendor_key
    
        # 5) For local providers, allow fallback tokens
        if provider == "openai_compatible":
            return "dummy-key"
        if provider in ["ollama", "lmstudio", "text-generation-webui", "fastchat"]:
            fallbacks = {
                "ollama": "ollama",
                "lmstudio": "lm-studio",
                "text-generation-webui": "webui",
                "fastchat": "fastchat"
            }
            return fallbacks.get(provider, "not-required")
    
        # 6) Cloud providers must have API keys
        if provider == "openai":
&gt;           raise MissingApiKeyError("API key is required")
E           ai_utilities.config_resolver.MissingApiKeyError: API key is required

src/ai_utilities/config_resolver.py:275: MissingApiKeyError

During handling of the above exception, another exception occurred:

self = &lt;test_provider_specific_base_urls.TestClientIntegration object at 0x10d1d8cd0&gt;

    @patch.dict(os.environ, {
        "TEXT_GENERATION_WEBUI_BASE_URL": "http://localhost:5000/v1"
    })
    def test_provider_base_url_without_api_key_works(self):
        """Test that provider-specific base URL works without API key."""
        settings = AiSettings()  # Create settings with patched environment
&gt;       client = AiClient(settings=settings)  # Pass explicit settings

tests/utils/test_provider_specific_base_urls.py:211: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src/ai_utilities/client.py:162: in __init__
    self.provider = create_provider(settings, provider)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

settings = AiSettings(provider='openai', api_key=None, openai_api_key=None, groq_api_key=None, together_api_key=None, openrouter_..., cache_sqlite_busy_timeout_ms=3000, cache_sqlite_max_entries=None, cache_sqlite_prune_batch=200, cache_namespace=None)
provider = None

    def create_provider(settings: "AiSettings", provider: Optional[BaseProvider] = None) -&gt; BaseProvider:
        """Create an AI provider based on settings.
    
        Args:
            settings: AI settings containing provider configuration
            provider: Optional explicit provider to use (overrides settings)
    
        Returns:
            Configured AI provider instance
    
        Raises:
            ProviderConfigurationError: If provider configuration is invalid
        """
        # If explicit provider is provided, use it
        if provider is not None:
            return provider
    
        # Check if settings is None
        if settings is None:
            raise ProviderConfigurationError("Settings cannot be None", "unknown")
    
        try:
            config = resolve_request_config(settings)
    
            # Create provider based on resolved provider
            if config.provider == "openai":
                # Lazy import to avoid dependency issues
                try:
                    from .openai_provider import OpenAIProvider
                except ImportError as e:
                    raise MissingOptionalDependencyError(
                        "OpenAI provider requires extra 'openai'. Install with: pip install ai-utilities[openai]"
                    ) from e
                return OpenAIProvider(settings)
    
            elif config.provider in ["groq", "together", "openrouter"]:
                # These are all OpenAI-compatible with different base URLs
                return OpenAICompatibleProvider(
                    api_key=config.api_key,
                    base_url=config.base_url,
                    timeout=int(config.timeout or 30),
                    extra_headers=settings.extra_headers,
                    model=getattr(settings, 'model', None),
                )
    
            elif config.provider in ["ollama", "lmstudio", "text-generation-webui", "fastchat", "openai_compatible"]:
                # Local providers
                return OpenAICompatibleProvider(
                    api_key=config.api_key,
                    base_url=config.base_url,
                    timeout=int(config.timeout or 30),
                    extra_headers=settings.extra_headers,
                    model=getattr(settings, 'model', None),
                )
    
            else:
                raise ProviderConfigurationError(
                    f"Unknown provider: {config.provider}",
                    config.provider
                )
    
        except MissingBaseUrlError as e:
            raise ProviderConfigurationError(str(e), getattr(settings, "provider", "unknown"))
        except MissingApiKeyError as e:
            provider_name = getattr(settings, "provider", "unknown") or "unknown"
            if provider_name == "openai":
&gt;               raise ProviderConfigurationError("API key is required", "openai")
E               ai_utilities.providers.provider_exceptions.ProviderConfigurationError: Provider 'openai' configuration error: API key is required

src/ai_utilities/providers/provider_factory.py:106: ProviderConfigurationError</failure></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestEnvironmentHelperFunctions" name="test_get_provider_specific_base_url" time="0.003"><properties><property name="test_order" value="2457" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestEnvironmentHelperFunctions" name="test_infer_provider_from_env_base_urls" time="0.003"><properties><property name="test_order" value="2458" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestEnvironmentHelperFunctions" name="test_provider_name_variations" time="0.003"><properties><property name="test_order" value="2459" /></properties></testcase><testcase classname="tests.utils.test_provider_specific_base_urls.TestPrecedenceOrder" name="test_base_url_precedence_order" time="0.004"><properties><property name="test_order" value="2460" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_webui_helper_initialization" time="0.006"><properties><property name="test_order" value="2461" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_webui_helper_with_config" time="0.008"><properties><property name="test_order" value="2462" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_detect_webui_on_port_success" time="0.005"><properties><property name="test_order" value="2463" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_detect_webui_on_port_failure" time="0.005"><properties><property name="test_order" value="2464" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_scan_for_webuis" time="0.003"><properties><property name="test_order" value="2465" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_identify_webui_type_by_response" time="0.004"><properties><property name="test_order" value="2466" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_generate_ai_utilities_config" time="0.004"><properties><property name="test_order" value="2467" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_generate_env_file_content" time="0.004"><properties><property name="test_order" value="2468" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_auto_detect_and_configure" time="0.004"><properties><property name="test_order" value="2469" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_test_webui_connection" time="0.004"><properties><property name="test_order" value="2470" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_test_webui_connection_failure" time="0.004"><properties><property name="test_order" value="2471" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_save_configuration_files" time="0.007"><properties><property name="test_order" value="2472" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_run_full_discovery_process" time="0.004"><properties><property name="test_order" value="2473" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_get_supported_webuis_info" time="0.004"><properties><property name="test_order" value="2474" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_validate_webui_config" time="0.004"><properties><property name="test_order" value="2475" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_continuous_monitoring" time="0.329"><properties><property name="test_order" value="2476" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelper" name="test_get_webui_status_summary" time="0.004"><properties><property name="test_order" value="2477" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelperCLI" name="test_cli_discover_command" time="0.005"><properties><property name="test_order" value="2478" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelperCLI" name="test_cli_scan_command" time="0.003"><properties><property name="test_order" value="2479" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelperCLI" name="test_cli_test_command" time="0.005"><properties><property name="test_order" value="2480" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelperCLI" name="test_cli_list_supported" time="0.004"><properties><property name="test_order" value="2481" /></properties></testcase><testcase classname="tests.utils.test_webui_api_helper.TestWebUIAPIHelperCLI" name="test_cli_help_output" time="0.005"><properties><property name="test_order" value="2482" /></properties></testcase></testsuite></testsuites>